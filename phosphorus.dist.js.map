{"version":3,"file":"phosphorus.dist.js","sourceRoot":"","sources":["phosphorus/phosphorus.ts","phosphorus/config.ts","phosphorus/audio.ts","phosphorus/matrix.ts","phosphorus/renderer.ts","phosphorus/core.ts","phosphorus/utils.ts","phosphorus/fonts.ts","phosphorus/io.ts","phosphorus/sb2.ts","phosphorus/runtime.ts","phosphorus/sb3.ts"],"names":[],"mappings":"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GAAG,CAAC,CAAC,CAAC,CAAC;YAClB,MAAM,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;YAClB,MAAM,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;YAClB,MAAM,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;YAClB,MAAM,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;YAClB,MAAM,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;YAClB,MAAM,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;YAClB,MAAM,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;YAClB,MAAM,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;YAClB,MAAM,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;YACpB,MAAM,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;YACpB,MAAM,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;YACpB,MAAM,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;YACpB,MAAM,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;YACpB,MAAM,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;YACpB,MAAM,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;YACpB,MAAM,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;YACpB,MAAM,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;YACpB,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;YACrC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;YACrC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;YACrC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC;YACrC,GAAG,CAAC,CAAC,CAAC,GAA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","sourcesContent":["/*!\r\nForkphorus: A JavaScript compiler for Scratch 2 and 3 projects.\r\n(A fork of phosphorus)\r\n\r\nNote: phosphorus.dist.js is automatically generated from the `phosphorus` folder.\r\nSee the README for more information.\r\n\r\nThe MIT License (MIT)\r\n\r\nCopyright (c) 2013-2017 Nathan Dinsmore\r\nCopyright (c) 2019 Thomas Weber\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a copy of\r\nthis software and associated documentation files (the \"Software\"), to deal in\r\nthe Software without restriction, including without limitation the rights to\r\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\r\nthe Software, and to permit persons to whom the Software is furnished to do so,\r\nsubject to the following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included in all\r\ncopies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\r\nFOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\r\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\r\nIN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\r\nCONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n*/\r\n\r\ninterface ObjectMap<V> {\r\n  [key: string]: V;\r\n}\r\n\r\nif (!('Promise' in window)) {\r\n  throw new Error('Browser does not support Promise');\r\n}\r\n","/// <reference path=\"phosphorus.ts\" />\r\n\r\nnamespace P.config {\r\n  const features = location.search.replace('?', '').split('&');\r\n  export const debug = features.indexOf('debug') > -1;\r\n  export const useWebGL = features.indexOf('webgl') > -1;\r\n  export const preciseTimers = features.indexOf('preciseTimers') > -1;\r\n\r\n  export const scale = window.devicePixelRatio || 1;\r\n  export const hasTouchEvents = 'ontouchstart' in document;\r\n  export const PROJECT_API: string = 'https://projects.scratch.mit.edu/$id';\r\n}\r\n","/// <reference path=\"phosphorus.ts\" />\r\n/// <reference path=\"config.ts\" />\r\n\r\nnamespace P.audio {\r\n  // Create an audio context involves a little bit of logic, so an IIFE is used.\r\n  export const context = (function(): AudioContext | null {\r\n    if ((window as any).AudioContext) {\r\n      return new AudioContext();\r\n    } else if ((window as any).webkitAudioContext) {\r\n      return new (window as any).webkitAudioContext();\r\n    } else {\r\n      return null;\r\n    }\r\n  })();\r\n\r\n  if (context) {\r\n    // TODO: customizable volume\r\n    var volume = 0.3;\r\n    var volumeNode = context.createGain();\r\n    volumeNode.gain.value = volume;\r\n    volumeNode.connect(context.destination);\r\n  }\r\n\r\n  // Most things relating to Span are old things I don't understand and don't want to touch.\r\n  interface Span {\r\n    name: string;\r\n    loop: boolean;\r\n    loopStart: number | null;\r\n    loopEnd: number | null;\r\n    baseRatio: number;\r\n    attackEnd: number;\r\n    holdEnd: number;\r\n    decayEnd: number;\r\n    decayTime?: number;\r\n    top?: number;\r\n  }\r\n\r\n  /*\r\n    copy(JSON.stringify(drums.map(function(d) {\r\n      var decayTime = d[4] || 0;\r\n      var baseRatio = Math.pow(2, (60 - d[1] - 69) / 12);\r\n      if (d[2]) {\r\n        var length = d[3] - d[2];\r\n        baseRatio = 22050 * Math.round(length * 440 * baseRatio / 22050) / length / 440;\r\n      }\r\n      return {\r\n        name: d[0],\r\n        baseRatio: baseRatio,\r\n        loop: !!d[2],\r\n        loopStart: d[2] / 22050,\r\n        loopEnd: d[3] / 22050,\r\n        attackEnd: 0,\r\n        holdEnd: 0,\r\n        decayEnd: decayTime\r\n      }\r\n    }))\r\n  */\r\n  export const drums: Span[] = [\r\n    {name:'SnareDrum',baseRatio:0.5946035575013605,loop:false,loopStart:null,loopEnd:null,attackEnd:0,holdEnd:0,decayEnd:0},\r\n    {name:'Tom',baseRatio:0.5946035575013605,loop:false,loopStart:null,loopEnd:null,attackEnd:0,holdEnd:0,decayEnd:0},\r\n    {name:'SideStick',baseRatio:0.5946035575013605,loop:false,loopStart:null,loopEnd:null,attackEnd:0,holdEnd:0,decayEnd:0},\r\n    {name:'Crash',baseRatio:0.8908987181403393,loop:false,loopStart:null,loopEnd:null,attackEnd:0,holdEnd:0,decayEnd:0},\r\n    {name:'HiHatOpen',baseRatio:0.9438743126816935,loop:false,loopStart:null,loopEnd:null,attackEnd:0,holdEnd:0,decayEnd:0},\r\n    {name:'HiHatClosed',baseRatio:0.5946035575013605,loop:false,loopStart:null,loopEnd:null,attackEnd:0,holdEnd:0,decayEnd:0},\r\n    {name:'Tambourine',baseRatio:0.5946035575013605,loop:false,loopStart:null,loopEnd:null,attackEnd:0,holdEnd:0,decayEnd:0},\r\n    {name:'Clap',baseRatio:0.5946035575013605,loop:false,loopStart:null,loopEnd:null,attackEnd:0,holdEnd:0,decayEnd:0},\r\n    {name:'Claves',baseRatio:0.5946035575013605,loop:false,loopStart:null,loopEnd:null,attackEnd:0,holdEnd:0,decayEnd:0},\r\n    {name:'WoodBlock',baseRatio:0.7491535384383408,loop:false,loopStart:null,loopEnd:null,attackEnd:0,holdEnd:0,decayEnd:0},\r\n    {name:'Cowbell',baseRatio:0.5946035575013605,loop:false,loopStart:null,loopEnd:null,attackEnd:0,holdEnd:0,decayEnd:0},\r\n    {name:'Triangle',baseRatio:0.8514452780229479,loop:true,loopStart:0.7638548752834468,loopEnd:0.7825396825396825,attackEnd:0,holdEnd:0,decayEnd:2},\r\n    {name:'Bongo',baseRatio:0.5297315471796477,loop:false,loopStart:null,loopEnd:null,attackEnd:0,holdEnd:0,decayEnd:0},\r\n    {name:'Conga',baseRatio:0.7954545454545454,loop:true,loopStart:0.1926077097505669,loopEnd:0.20403628117913833,attackEnd:0,holdEnd:0,decayEnd:2},\r\n    {name:'Cabasa',baseRatio:0.5946035575013605,loop:false,loopStart:null,loopEnd:null,attackEnd:0,holdEnd:0,decayEnd:0},\r\n    {name:'GuiroLong',baseRatio:0.5946035575013605,loop:false,loopStart:null,loopEnd:null,attackEnd:0,holdEnd:0,decayEnd:0},\r\n    {name:'Vibraslap',baseRatio:0.8408964152537145,loop:false,loopStart:null,loopEnd:null,attackEnd:0,holdEnd:0,decayEnd:0},\r\n    {name:'Cuica',baseRatio:0.7937005259840998,loop:false,loopStart:null,loopEnd:null,attackEnd:0,holdEnd:0,decayEnd:0}\r\n  ];\r\n\r\n  /*\r\n    copy(JSON.stringify(instruments.map(function(g) {\r\n      return g.map(function(r) {\r\n        var attackTime = r[5] ? r[5][0] * 0.001 : 0;\r\n        var holdTime = r[5] ? r[5][1] * 0.001 : 0;\r\n        var decayTime = r[5] ? r[5][2] : 0;\r\n        var baseRatio = Math.pow(2, (r[2] - 69) / 12);\r\n        if (r[3] !== -1) {\r\n          var length = r[4] - r[3];\r\n          baseRatio = 22050 * Math.round(length * 440 * baseRatio / 22050) / length / 440;\r\n        }\r\n        return {\r\n          top: r[0],\r\n          name: r[1],\r\n          baseRatio: baseRatio,\r\n          loop: r[3] !== -1,\r\n          loopStart: r[3] / 22050,\r\n          loopEnd: r[4] / 22050,\r\n          attackEnd: attackTime,\r\n          holdEnd: attackTime + holdTime,\r\n          decayEnd: attackTime + holdTime + decayTime\r\n        }\r\n      })\r\n    }))\r\n  */\r\n  export const instruments: Span[][] = [\r\n    [\r\n      {top:38,name:'AcousticPiano_As3',baseRatio:0.5316313272700484,loop:true,loopStart:0.465578231292517,loopEnd:0.7733786848072562,attackEnd:0,holdEnd:0.1,decayEnd:22.1},\r\n      {top:44,name:'AcousticPiano_C4',baseRatio:0.5905141892259927,loop:true,loopStart:0.6334693877551021,loopEnd:0.8605442176870748,attackEnd:0,holdEnd:0.1,decayEnd:20.1},\r\n      {top:51,name:'AcousticPiano_G4',baseRatio:0.8843582887700535,loop:true,loopStart:0.5532879818594104,loopEnd:0.5609977324263039,attackEnd:0,holdEnd:0.08,decayEnd:18.08},\r\n      {top:62,name:'AcousticPiano_C6',baseRatio:2.3557692307692304,loop:true,loopStart:0.5914739229024943,loopEnd:0.6020861678004535,attackEnd:0,holdEnd:0.08,decayEnd:16.08},\r\n      {top:70,name:'AcousticPiano_F5',baseRatio:1.5776515151515151,loop:true,loopStart:0.5634920634920635,loopEnd:0.5879818594104308,attackEnd:0,holdEnd:0.04,decayEnd:14.04},\r\n      {top:77,name:'AcousticPiano_Ds6',baseRatio:2.800762112139358,loop:true,loopStart:0.560907029478458,loopEnd:0.5836281179138322,attackEnd:0,holdEnd:0.02,decayEnd:10.02},\r\n      {top:85,name:'AcousticPiano_Ds6',baseRatio:2.800762112139358,loop:true,loopStart:0.560907029478458,loopEnd:0.5836281179138322,attackEnd:0,holdEnd:0,decayEnd:8},\r\n      {top:90,name:'AcousticPiano_Ds6',baseRatio:2.800762112139358,loop:true,loopStart:0.560907029478458,loopEnd:0.5836281179138322,attackEnd:0,holdEnd:0,decayEnd:6},\r\n      {top:96,name:'AcousticPiano_D7',baseRatio:5.275119617224881,loop:true,loopStart:0.3380498866213152,loopEnd:0.34494331065759637,attackEnd:0,holdEnd:0,decayEnd:3},\r\n      {top:128,name:'AcousticPiano_D7',baseRatio:5.275119617224881,loop:true,loopStart:0.3380498866213152,loopEnd:0.34494331065759637,attackEnd:0,holdEnd:0,decayEnd:2}\r\n    ], [\r\n      {top:48,name:'ElectricPiano_C2',baseRatio:0.14870515241435123,loop:true,loopStart:0.6956009070294784,loopEnd:0.7873015873015873,attackEnd:0,holdEnd:0.08,decayEnd:10.08},\r\n      {top:74,name:'ElectricPiano_C4',baseRatio:0.5945685670261941,loop:true,loopStart:0.5181859410430839,loopEnd:0.5449433106575964,attackEnd:0,holdEnd:0.04,decayEnd:8.04},\r\n      {top:128,name:'ElectricPiano_C4',baseRatio:0.5945685670261941,loop:true,loopStart:0.5181859410430839,loopEnd:0.5449433106575964,attackEnd:0,holdEnd:0,decayEnd:6}\r\n    ], [\r\n      {top:128,name:'Organ_G2',baseRatio:0.22283731584620914,loop:true,loopStart:0.05922902494331066,loopEnd:0.1510204081632653,attackEnd:0,holdEnd:0,decayEnd:0}\r\n    ],[{top:40,name:'AcousticGuitar_F3',baseRatio:0.3977272727272727,loop:true,loopStart:1.6628117913832199,loopEnd:1.6685260770975057,attackEnd:0,holdEnd:0,decayEnd:15},\r\n      {top:56,name:'AcousticGuitar_F3',baseRatio:0.3977272727272727,loop:true,loopStart:1.6628117913832199,loopEnd:1.6685260770975057,attackEnd:0,holdEnd:0,decayEnd:13.5},\r\n      {top:60,name:'AcousticGuitar_F3',baseRatio:0.3977272727272727,loop:true,loopStart:1.6628117913832199,loopEnd:1.6685260770975057,attackEnd:0,holdEnd:0,decayEnd:12},\r\n      {top:67,name:'AcousticGuitar_F3',baseRatio:0.3977272727272727,loop:true,loopStart:1.6628117913832199,loopEnd:1.6685260770975057,attackEnd:0,holdEnd:0,decayEnd:8.5},\r\n      {top:72,name:'AcousticGuitar_F3',baseRatio:0.3977272727272727,loop:true,loopStart:1.6628117913832199,loopEnd:1.6685260770975057,attackEnd:0,holdEnd:0,decayEnd:7},\r\n      {top:83,name:'AcousticGuitar_F3',baseRatio:0.3977272727272727,loop:true,loopStart:1.6628117913832199,loopEnd:1.6685260770975057,attackEnd:0,holdEnd:0,decayEnd:5.5},\r\n      {top:128,name:'AcousticGuitar_F3',baseRatio:0.3977272727272727,loop:true,loopStart:1.6628117913832199,loopEnd:1.6685260770975057,attackEnd:0,holdEnd:0,decayEnd:4.5}\r\n    ], [\r\n      {top:40,name:'ElectricGuitar_F3',baseRatio:0.39615522817103843,loop:true,loopStart:1.5733333333333333,loopEnd:1.5848072562358,attackEnd:0,holdEnd:0,decayEnd:15},\r\n      {top:56,name:'ElectricGuitar_F3',baseRatio:0.39615522817103843,loop:true,loopStart:1.5733333333333333,loopEnd:1.5848072562358277,attackEnd:0,holdEnd:0,decayEnd:13.5},\r\n      {top:60,name:'ElectricGuitar_F3',baseRatio:0.39615522817103843,loop:true,loopStart:1.5733333333333333,loopEnd:1.5848072562358277,attackEnd:0,holdEnd:0,decayEnd:12},\r\n      {top:67,name:'ElectricGuitar_F3',baseRatio:0.39615522817103843,loop:true,loopStart:1.5733333333333333,loopEnd:1.5848072562358277,attackEnd:0,holdEnd:0,decayEnd:8.5},\r\n      {top:72,name:'ElectricGuitar_F3',baseRatio:0.39615522817103843,loop:true,loopStart:1.5733333333333333,loopEnd:1.5848072562358277,attackEnd:0,holdEnd:0,decayEnd:7},\r\n      {top:83,name:'ElectricGuitar_F3',baseRatio:0.39615522817103843,loop:true,loopStart:1.5733333333333333,loopEnd:1.5848072562358277,attackEnd:0,holdEnd:0,decayEnd:5.5},\r\n      {top:128,name:'ElectricGuitar_F3',baseRatio:0.39615522817103843,loop:true,loopStart:1.5733333333333333,loopEnd:1.5848072562358277,attackEnd:0,holdEnd:0,decayEnd:4.5}\r\n    ], [\r\n      {top:34,name:'ElectricBass_G1',baseRatio:0.11111671034065712,loop:true,loopStart:1.9007709750566892,loopEnd:1.9212244897959183,attackEnd:0,holdEnd:0,decayEnd:17},\r\n      {top:48,name:'ElectricBass_G1',baseRatio:0.11111671034065712,loop:true,loopStart:1.9007709750566892,loopEnd:1.9212244897959183,attackEnd:0,holdEnd:0,decayEnd:14},\r\n      {top:64,name:'ElectricBass_G1',baseRatio:0.11111671034065712,loop:true,loopStart:1.9007709750566892,loopEnd:1.9212244897959183,attackEnd:0,holdEnd:0,decayEnd:12},\r\n      {top:128,name:'ElectricBass_G1',baseRatio:0.11111671034065712,loop:true,loopStart:1.9007709750566892,loopEnd:1.9212244897959183,attackEnd:0,holdEnd:0,decayEnd:10}\r\n    ], [\r\n      {top:38,name:'Pizz_G2',baseRatio:0.21979665071770335,loop:true,loopStart:0.3879365079365079,loopEnd:0.3982766439909297,attackEnd:0,holdEnd:0,decayEnd:5},\r\n      {top:45,name:'Pizz_G2',baseRatio:0.21979665071770335,loop:true,loopStart:0.3879365079365079,loopEnd:0.3982766439909297,attackEnd:0,holdEnd:0.012,decayEnd:4.012},\r\n      {top:56,name:'Pizz_A3',baseRatio:0.503654636820466,loop:true,loopStart:0.5197278911564626,loopEnd:0.5287528344671202,attackEnd:0,holdEnd:0,decayEnd:4},\r\n      {top:64,name:'Pizz_A3',baseRatio:0.503654636820466,loop:true,loopStart:0.5197278911564626,loopEnd:0.5287528344671202,attackEnd:0,holdEnd:0,decayEnd:3.2},\r\n      {top:72,name:'Pizz_E4',baseRatio:0.7479647218453188,loop:true,loopStart:0.7947845804988662,loopEnd:0.7978231292517007,attackEnd:0,holdEnd:0,decayEnd:2.8},\r\n      {top:80,name:'Pizz_E4',baseRatio:0.7479647218453188,loop:true,loopStart:0.7947845804988662,loopEnd:0.7978231292517007,attackEnd:0,holdEnd:0,decayEnd:2.2},\r\n      {top:128,name:'Pizz_E4',baseRatio:0.7479647218453188,loop:true,loopStart:0.7947845804988662,loopEnd:0.7978231292517007,attackEnd:0,holdEnd:0,decayEnd:1.5}\r\n    ], [\r\n      {top:41,name:'Cello_C2',baseRatio:0.14870515241435123,loop:true,loopStart:0.3876643990929705,loopEnd:0.40294784580498866,attackEnd:0,holdEnd:0,decayEnd:0},\r\n      {top:52,name:'Cello_As2',baseRatio:0.263755980861244,loop:true,loopStart:0.3385487528344671,loopEnd:0.35578231292517004,attackEnd:0,holdEnd:0,decayEnd:0},\r\n      {top:62,name:'Violin_D4',baseRatio:0.6664047388781432,loop:true,loopStart:0.48108843537414964,loopEnd:0.5151927437641723,attackEnd:0,holdEnd:0,decayEnd:0},\r\n      {top:75,name:'Violin_A4',baseRatio:0.987460815047022,loop:true,loopStart:0.14108843537414967,loopEnd:0.15029478458049886,attackEnd:0.07,holdEnd:0.07,decayEnd:0.07},\r\n      {top:128,name:'Violin_E5',baseRatio:1.4885238523852387,loop:true,loopStart:0.10807256235827664,loopEnd:0.1126530612244898,attackEnd:0,holdEnd:0,decayEnd:0}\r\n    ], [\r\n      {top:30,name:'BassTrombone_A2_3',baseRatio:0.24981872564125807,loop:true,loopStart:0.061541950113378686,loopEnd:0.10702947845804989,attackEnd:0,holdEnd:0,decayEnd:0},\r\n      {top:40,name:'BassTrombone_A2_2',baseRatio:0.24981872564125807,loop:true,loopStart:0.08585034013605441,loopEnd:0.13133786848072562,attackEnd:0,holdEnd:0,decayEnd:0},\r\n      {top:55,name:'Trombone_B3',baseRatio:0.5608240680183126,loop:true,loopStart:0.12,loopEnd:0.17673469387755103,attackEnd:0,holdEnd:0,decayEnd:0},\r\n      {top:88,name:'Trombone_B3',baseRatio:0.5608240680183126,loop:true,loopStart:0.12,loopEnd:0.17673469387755103,attackEnd:0.05,holdEnd:0.05,decayEnd:0.05},\r\n      {top:128,name:'Trumpet_E5',baseRatio:1.4959294436906376,loop:true,loopStart:0.1307936507936508,loopEnd:0.14294784580498865,attackEnd:0,holdEnd:0,decayEnd:0}\r\n    ], [\r\n      {top:128,name:'Clarinet_C4',baseRatio:0.5940193965517241,loop:true,loopStart:0.6594104308390023,loopEnd:0.7014965986394558,attackEnd:0,holdEnd:0,decayEnd:0}\r\n    ], [\r\n      {top:40,name:'TenorSax_C3',baseRatio:0.2971698113207547,loop:true,loopStart:0.4053968253968254,loopEnd:0.4895238095238095,attackEnd:0,holdEnd:0,decayEnd:0},\r\n      {top:50,name:'TenorSax_C3',baseRatio:0.2971698113207547,loop:true,loopStart:0.4053968253968254,loopEnd:0.4895238095238095,attackEnd:0.02,holdEnd:0.02,decayEnd:0.02},\r\n      {top:59,name:'TenorSax_C3',baseRatio:0.2971698113207547,loop:true,loopStart:0.4053968253968254,loopEnd:0.4895238095238095,attackEnd:0.04,holdEnd:0.04,decayEnd:0.04},\r\n      {top:67,name:'AltoSax_A3',baseRatio:0.49814747876378096,loop:true,loopStart:0.3875736961451247,loopEnd:0.4103854875283447,attackEnd:0,holdEnd:0,decayEnd:0},\r\n      {top:75,name:'AltoSax_A3',baseRatio:0.49814747876378096,loop:true,loopStart:0.3875736961451247,loopEnd:0.4103854875283447,attackEnd:0.02,holdEnd:0.02,decayEnd:0.02},\r\n      {top:80,name:'AltoSax_A3',baseRatio:0.49814747876378096,loop:true,loopStart:0.3875736961451247,loopEnd:0.4103854875283447,attackEnd:0.02,holdEnd:0.02,decayEnd:0.02},\r\n      {top:128,name:'AltoSax_C6',baseRatio:2.3782742681047764,loop:true,loopStart:0.05705215419501134,loopEnd:0.0838095238095238,attackEnd:0,holdEnd:0,decayEnd:0}\r\n    ], [\r\n      {top:61,name:'Flute_B5_2',baseRatio:2.255113636363636,loop:true,loopStart:0.08430839002267573,loopEnd:0.10244897959183673,attackEnd:0,holdEnd:0,decayEnd:0},\r\n      {top:128,name:'Flute_B5_1',baseRatio:2.255113636363636,loop:true,loopStart:0.10965986394557824,loopEnd:0.12780045351473923,attackEnd:0,holdEnd:0,decayEnd:0}\r\n    ], [\r\n      {top:128,name:'WoodenFlute_C5',baseRatio:1.1892952324548416,loop:true,loopStart:0.5181859410430839,loopEnd:0.7131065759637188,attackEnd:0,holdEnd:0,decayEnd:0}\r\n    ], [\r\n      {top:57,name:'Bassoon_C3',baseRatio:0.29700969827586204,loop:true,loopStart:0.11011337868480725,loopEnd:0.19428571428571428,attackEnd:0,holdEnd:0,decayEnd:0},\r\n      {top:67,name:'Bassoon_C3',baseRatio:0.29700969827586204,loop:true,loopStart:0.11011337868480725,loopEnd:0.19428571428571428,attackEnd:0.04,holdEnd:0.04,decayEnd:0.04},\r\n      {top:76,name:'Bassoon_C3',baseRatio:0.29700969827586204,loop:true,loopStart:0.11011337868480725,loopEnd:0.19428571428571428,attackEnd:0.08,holdEnd:0.08,decayEnd:0.08},\r\n      {top:84,name:'EnglishHorn_F3',baseRatio:0.39601293103448276,loop:true,loopStart:0.341859410430839,loopEnd:0.4049886621315193,attackEnd:0.04,holdEnd:0.04,decayEnd:0.04},\r\n      {top:128,name:'EnglishHorn_D4',baseRatio:0.6699684005833739,loop:true,loopStart:0.22027210884353743,loopEnd:0.23723356009070296,attackEnd:0,holdEnd:0,decayEnd:0}\r\n    ], [\r\n      {top:39,name:'Choir_F3',baseRatio:0.3968814788643197,loop:true,loopStart:0.6352380952380953,loopEnd:1.8721541950113378,attackEnd:0,holdEnd:0,decayEnd:0},\r\n      {top:50,name:'Choir_F3',baseRatio:0.3968814788643197,loop:true,loopStart:0.6352380952380953,loopEnd:1.8721541950113378,attackEnd:0.04,holdEnd:0.04,decayEnd:0.04},\r\n      {top:61,name:'Choir_F3',baseRatio:0.3968814788643197,loop:true,loopStart:0.6352380952380953,loopEnd:1.8721541950113378,attackEnd:0.06,holdEnd:0.06,decayEnd:0.06},\r\n      {top:72,name:'Choir_F4',baseRatio:0.7928898424161845,loop:true,loopStart:0.7415419501133786,loopEnd:2.1059410430839,attackEnd:0,holdEnd:0,decayEnd:0},\r\n      {top:128,name:'Choir_F5',baseRatio:1.5879576065654504,loop:true,loopStart:0.836281179138322,loopEnd:2.0585487528344673,attackEnd:0,holdEnd:0,decayEnd:0}\r\n    ], [\r\n      {top:38,name:'Vibraphone_C3',baseRatio:0.29829545454545453,loop:true,loopStart:0.2812698412698413,loopEnd:0.28888888888888886,attackEnd:0,holdEnd:0.1,decayEnd:8.1},\r\n      {top:48,name:'Vibraphone_C3',baseRatio:0.29829545454545453,loop:true,loopStart:0.2812698412698413,loopEnd:0.28888888888888886,attackEnd:0,holdEnd:0.1,decayEnd:7.6},\r\n      {top:59,name:'Vibraphone_C3',baseRatio:0.29829545454545453,loop:true,loopStart:0.2812698412698413,loopEnd:0.28888888888888886,attackEnd:0,holdEnd:0.06,decayEnd:7.06},\r\n      {top:70,name:'Vibraphone_C3',baseRatio:0.29829545454545453,loop:true,loopStart:0.2812698412698413,loopEnd:0.28888888888888886,attackEnd:0,holdEnd:0.04,decayEnd:6.04},\r\n      {top:78,name:'Vibraphone_C3',baseRatio:0.29829545454545453,loop:true,loopStart:0.2812698412698413,loopEnd:0.28888888888888886,attackEnd:0,holdEnd:0.02,decayEnd:5.02},\r\n      {top:86,name:'Vibraphone_C3',baseRatio:0.29829545454545453,loop:true,loopStart:0.2812698412698413,loopEnd:0.28888888888888886,attackEnd:0,holdEnd:0,decayEnd:4},\r\n      {top:128,name:'Vibraphone_C3',baseRatio:0.29829545454545453,loop:true,loopStart:0.2812698412698413,loopEnd:0.28888888888888886,attackEnd:0,holdEnd:0,decayEnd:3}\r\n    ], [\r\n      {top:128,name:'MusicBox_C4',baseRatio:0.5937634640241276,loop:true,loopStart:0.6475283446712018,loopEnd:0.6666666666666666,attackEnd:0,holdEnd:0,decayEnd:2}\r\n    ], [\r\n      {top:128,name:'SteelDrum_D5',baseRatio:1.3660402567543959,loop:false,loopStart:-0.000045351473922902495,loopEnd:-0.000045351473922902495,attackEnd:0,holdEnd:0,decayEnd:2}\r\n    ],[\r\n      {top:128,name:'Marimba_C4',baseRatio:0.5946035575013605,loop:false,loopStart:-0.000045351473922902495,loopEnd:-0.000045351473922902495,attackEnd:0,holdEnd:0,decayEnd:0}\r\n    ], [\r\n      {top:80,name:'SynthLead_C4',baseRatio:0.5942328422565577,loop:true,loopStart:0.006122448979591836,loopEnd:0.06349206349206349,attackEnd:0,holdEnd:0,decayEnd:0},\r\n      {top:128,name:'SynthLead_C6',baseRatio:2.3760775862068964,loop:true,loopStart:0.005623582766439909,loopEnd:0.01614512471655329,attackEnd:0,holdEnd:0,decayEnd:0}\r\n    ], [\r\n      {top:38,name:'SynthPad_A3',baseRatio:0.4999105065330231,loop:true,loopStart:0.1910204081632653,loopEnd:3.9917006802721087,attackEnd:0.05,holdEnd:0.05,decayEnd:0.05},\r\n      {top:50,name:'SynthPad_A3',baseRatio:0.4999105065330231,loop:true,loopStart:0.1910204081632653,loopEnd:3.9917006802721087,attackEnd:0.08,holdEnd:0.08,decayEnd:0.08},\r\n      {top:62,name:'SynthPad_A3',baseRatio:0.4999105065330231,loop:true,loopStart:0.1910204081632653,loopEnd:3.9917006802721087,attackEnd:0.11,holdEnd:0.11,decayEnd:0.11},\r\n      {top:74,name:'SynthPad_A3',baseRatio:0.4999105065330231,loop:true,loopStart:0.1910204081632653,loopEnd:3.9917006802721087,attackEnd:0.15,holdEnd:0.15,decayEnd:0.15},\r\n      {top:86,name:'SynthPad_A3',baseRatio:0.4999105065330231,loop:true,loopStart:0.1910204081632653,loopEnd:3.9917006802721087,attackEnd:0.2,holdEnd:0.2,decayEnd:0.2},\r\n      {top:128,name:'SynthPad_C6',baseRatio:2.3820424708835755,loop:true,loopStart:0.11678004535147392,loopEnd:0.41732426303854875,attackEnd:0,holdEnd:0,decayEnd:0}\r\n    ]\r\n  ];\r\n\r\n  const SOUNDBANK_URL = '/soundbank/';\r\n  const SOUNDBANK_FILES = {\r\n    'AcousticGuitar_F3': 'instruments/AcousticGuitar_F3_22k.wav',\r\n    'AcousticPiano_As3': 'instruments/AcousticPiano(5)_A%233_22k.wav',\r\n    'AcousticPiano_C4': 'instruments/AcousticPiano(5)_C4_22k.wav',\r\n    'AcousticPiano_G4': 'instruments/AcousticPiano(5)_G4_22k.wav',\r\n    'AcousticPiano_F5': 'instruments/AcousticPiano(5)_F5_22k.wav',\r\n    'AcousticPiano_C6': 'instruments/AcousticPiano(5)_C6_22k.wav',\r\n    'AcousticPiano_Ds6': 'instruments/AcousticPiano(5)_D%236_22k.wav',\r\n    'AcousticPiano_D7': 'instruments/AcousticPiano(5)_D7_22k.wav',\r\n    'AltoSax_A3': 'instruments/AltoSax_A3_22K.wav',\r\n    'AltoSax_C6': 'instruments/AltoSax(3)_C6_22k.wav',\r\n    'Bassoon_C3': 'instruments/Bassoon_C3_22k.wav',\r\n    'BassTrombone_A2_2': 'instruments/BassTrombone_A2(2)_22k.wav',\r\n    'BassTrombone_A2_3': 'instruments/BassTrombone_A2(3)_22k.wav',\r\n    'Cello_C2': 'instruments/Cello(3b)_C2_22k.wav',\r\n    'Cello_As2': 'instruments/Cello(3)_A%232_22k.wav',\r\n    'Choir_F3': 'instruments/Choir(4)_F3_22k.wav',\r\n    'Choir_F4': 'instruments/Choir(4)_F4_22k.wav',\r\n    'Choir_F5': 'instruments/Choir(4)_F5_22k.wav',\r\n    'Clarinet_C4': 'instruments/Clarinet_C4_22k.wav',\r\n    'ElectricBass_G1': 'instruments/ElectricBass(2)_G1_22k.wav',\r\n    'ElectricGuitar_F3': 'instruments/ElectricGuitar(2)_F3(1)_22k.wav',\r\n    'ElectricPiano_C2': 'instruments/ElectricPiano_C2_22k.wav',\r\n    'ElectricPiano_C4': 'instruments/ElectricPiano_C4_22k.wav',\r\n    'EnglishHorn_D4': 'instruments/EnglishHorn(1)_D4_22k.wav',\r\n    'EnglishHorn_F3': 'instruments/EnglishHorn(1)_F3_22k.wav',\r\n    'Flute_B5_1': 'instruments/Flute(3)_B5(1)_22k.wav',\r\n    'Flute_B5_2': 'instruments/Flute(3)_B5(2)_22k.wav',\r\n    'Marimba_C4': 'instruments/Marimba_C4_22k.wav',\r\n    'MusicBox_C4': 'instruments/MusicBox_C4_22k.wav',\r\n    'Organ_G2': 'instruments/Organ(2)_G2_22k.wav',\r\n    'Pizz_A3': 'instruments/Pizz(2)_A3_22k.wav',\r\n    'Pizz_E4': 'instruments/Pizz(2)_E4_22k.wav',\r\n    'Pizz_G2': 'instruments/Pizz(2)_G2_22k.wav',\r\n    'SteelDrum_D5': 'instruments/SteelDrum_D5_22k.wav',\r\n    'SynthLead_C4': 'instruments/SynthLead(6)_C4_22k.wav',\r\n    'SynthLead_C6': 'instruments/SynthLead(6)_C6_22k.wav',\r\n    'SynthPad_A3': 'instruments/SynthPad(2)_A3_22k.wav',\r\n    'SynthPad_C6': 'instruments/SynthPad(2)_C6_22k.wav',\r\n    'TenorSax_C3': 'instruments/TenorSax(1)_C3_22k.wav',\r\n    'Trombone_B3': 'instruments/Trombone_B3_22k.wav',\r\n    'Trumpet_E5': 'instruments/Trumpet_E5_22k.wav',\r\n    'Vibraphone_C3': 'instruments/Vibraphone_C3_22k.wav',\r\n    'Violin_D4': 'instruments/Violin(2)_D4_22K.wav',\r\n    'Violin_A4': 'instruments/Violin(3)_A4_22k.wav',\r\n    'Violin_E5': 'instruments/Violin(3b)_E5_22k.wav',\r\n    'WoodenFlute_C5': 'instruments/WoodenFlute_C5_22k.wav',\r\n    'BassDrum': 'drums/BassDrum(1b)_22k.wav',\r\n    'Bongo': 'drums/Bongo_22k.wav',\r\n    'Cabasa': 'drums/Cabasa(1)_22k.wav',\r\n    'Clap': 'drums/Clap(1)_22k.wav',\r\n    'Claves': 'drums/Claves(1)_22k.wav',\r\n    'Conga': 'drums/Conga(1)_22k.wav',\r\n    'Cowbell': 'drums/Cowbell(3)_22k.wav',\r\n    'Crash': 'drums/Crash(2)_22k.wav',\r\n    'Cuica': 'drums/Cuica(2)_22k.wav',\r\n    'GuiroLong': 'drums/GuiroLong(1)_22k.wav',\r\n    'GuiroShort': 'drums/GuiroShort(1)_22k.wav',\r\n    'HiHatClosed': 'drums/HiHatClosed(1)_22k.wav',\r\n    'HiHatOpen': 'drums/HiHatOpen(2)_22k.wav',\r\n    'HiHatPedal': 'drums/HiHatPedal(1)_22k.wav',\r\n    'Maracas': 'drums/Maracas(1)_22k.wav',\r\n    'SideStick': 'drums/SideStick(1)_22k.wav',\r\n    'SnareDrum': 'drums/SnareDrum(1)_22k.wav',\r\n    'Tambourine': 'drums/Tambourine(3)_22k.wav',\r\n    'Tom': 'drums/Tom(1)_22k.wav',\r\n    'Triangle': 'drums/Triangle(1)_22k.wav',\r\n    'Vibraslap': 'drums/Vibraslap(1)_22k.wav',\r\n    'WoodBlock': 'drums/WoodBlock(1)_22k.wav'\r\n  };\r\n  const soundbank: {[s: string]: AudioBuffer} = {};\r\n\r\n  /**\r\n   * Loads missing soundbank files, if any.\r\n   */\r\n  export function loadSoundbank(): Promise<any> {\r\n    if (!context) return Promise.resolve();\r\n\r\n    const promises: any[] = [];\r\n    for (const name in SOUNDBANK_FILES) {\r\n      if (!soundbank[name]) {\r\n        promises.push(loadSoundbankBuffer(name));\r\n      }\r\n    }\r\n\r\n    return Promise.all(promises);\r\n  }\r\n\r\n  /**\r\n   * Loads a soundbank file\r\n   */\r\n  function loadSoundbankBuffer(name): Promise<AudioBuffer> {\r\n    return P.IO.fetchLocal(SOUNDBANK_URL + SOUNDBANK_FILES[name])\r\n      .then((request) => request.arrayBuffer())\r\n      .then((buffer) => P.audio.decodeAudio(buffer))\r\n      .then((sound) => soundbank[name] = sound);\r\n  }\r\n\r\n  export function playSound(sound: core.Sound) {\r\n    if (!context) {\r\n      return;\r\n    }\r\n    if (!sound.buffer) {\r\n      return;\r\n    }\r\n\r\n    if (sound.source) {\r\n      sound.source.disconnect();\r\n    }\r\n    sound.source = context.createBufferSource();\r\n    sound.source.buffer = sound.buffer;\r\n    sound.source.connect(sound.node!);\r\n\r\n    sound.source.start(context.currentTime);\r\n  }\r\n\r\n  export function playSpan(span: Span, key: number, duration: number, connection: AudioNode) {\r\n    if (!context) {\r\n      return;\r\n    }\r\n\r\n    const buffer = soundbank[span.name];\r\n    if (!buffer) {\r\n      return;\r\n    }\r\n\r\n    const source = context.createBufferSource();\r\n    const note = context.createGain();\r\n\r\n    source.buffer = buffer;\r\n    if (source.loop = span.loop) {\r\n      source.loopStart = span.loopStart as number;\r\n      source.loopEnd = span.loopEnd as number;\r\n    }\r\n\r\n    source.connect(note);\r\n    note.connect(connection);\r\n\r\n    const time = context.currentTime;\r\n    source.playbackRate.value = Math.pow(2, (key - 69) / 12) / span.baseRatio;\r\n\r\n    const gain = note.gain;\r\n    gain.value = 0;\r\n    gain.setValueAtTime(0, time);\r\n    if (span.attackEnd < duration) {\r\n      gain.linearRampToValueAtTime(1, time + span.attackEnd);\r\n      if ((span.decayTime as any) > 0 && span.holdEnd < duration) {\r\n        gain.linearRampToValueAtTime(1, time + span.holdEnd);\r\n        if (span.decayEnd < duration) {\r\n          gain.linearRampToValueAtTime(0, time + span.decayEnd);\r\n        } else {\r\n          gain.linearRampToValueAtTime(1 - (duration - span.holdEnd) / span.decayTime!, time + duration);\r\n        }\r\n      } else {\r\n        gain.linearRampToValueAtTime(1, time + duration);\r\n      }\r\n    } else {\r\n      gain.linearRampToValueAtTime(1, time + duration);\r\n    }\r\n    gain.linearRampToValueAtTime(0, time + duration + 0.02267573696);\r\n\r\n    source.start(time);\r\n    source.stop(time + duration + 0.02267573696);\r\n  }\r\n\r\n  /**\r\n   * Connect an audio node\r\n   */\r\n  export function connect(node: AudioNode) {\r\n    node.connect(volumeNode);\r\n  }\r\n\r\n  const ADPCM_STEPS = [\r\n    7, 8, 9, 10, 11, 12, 13, 14, 16, 17,\r\n    19, 21, 23, 25, 28, 31, 34, 37, 41, 45,\r\n    50, 55, 60, 66, 73, 80, 88, 97, 107, 118,\r\n    130, 143, 157, 173, 190, 209, 230, 253, 279, 307,\r\n    337, 371, 408, 449, 494, 544, 598, 658, 724, 796,\r\n    876, 963, 1060, 1166, 1282, 1411, 1552, 1707, 1878, 2066,\r\n    2272, 2499, 2749, 3024, 3327, 3660, 4026, 4428, 4871, 5358,\r\n    5894, 6484, 7132, 7845, 8630, 9493, 10442, 11487, 12635, 13899,\r\n    15289, 16818, 18500, 20350, 22385, 24623, 27086, 29794, 32767,\r\n  ];\r\n  const ADPCM_INDEX = [-1, -1, -1, -1, 2, 4, 6, 8, -1, -1, -1, -1, 2, 4, 6, 8];\r\n\r\n  function decodeADPCMAudio(ab: ArrayBuffer, cb) {\r\n    var dv = new DataView(ab);\r\n    if (dv.getUint32(0) !== 0x52494646 || dv.getUint32(8) !== 0x57415645) {\r\n      return cb(new Error('Unrecognized audio format'));\r\n    }\r\n\r\n    var blocks: ObjectMap<number> = {};\r\n    var i = 12, l = dv.byteLength - 8;\r\n    while (i < l) {\r\n      blocks[String.fromCharCode(\r\n        dv.getUint8(i),\r\n        dv.getUint8(i + 1),\r\n        dv.getUint8(i + 2),\r\n        dv.getUint8(i + 3))] = i;\r\n      i += 8 + dv.getUint32(i + 4, true);\r\n    }\r\n\r\n    var format        = dv.getUint16(20, true);\r\n    var channels      = dv.getUint16(22, true);\r\n    var sampleRate    = dv.getUint32(24, true);\r\n    var byteRate      = dv.getUint32(28, true);\r\n    var blockAlign    = dv.getUint16(32, true);\r\n    var bitsPerSample = dv.getUint16(34, true);\r\n\r\n    if (format === 17) {\r\n      var samplesPerBlock = dv.getUint16(38, true);\r\n      var blockSize = ((samplesPerBlock - 1) / 2) + 4;\r\n\r\n      var frameCount = dv.getUint32(blocks.fact + 8, true);\r\n\r\n      var buffer = context!.createBuffer(1, frameCount, sampleRate);\r\n      var channel = buffer.getChannelData(0);\r\n\r\n      var sample, index = 0;\r\n      var step, code, delta;\r\n      var lastByte = -1;\r\n\r\n      var offset = blocks.data + 8;\r\n      i = offset;\r\n      var j = 0;\r\n      while (true) {\r\n        if ((((i - offset) % blockSize) == 0) && (lastByte < 0)) {\r\n          if (i >= dv.byteLength) break;\r\n          sample = dv.getInt16(i, true); i += 2;\r\n          index = dv.getUint8(i); i += 1;\r\n          i++;\r\n          if (index > 88) index = 88;\r\n          channel[j++] = sample / 32767;\r\n        } else {\r\n          if (lastByte < 0) {\r\n            if (i >= dv.byteLength) break;\r\n            lastByte = dv.getUint8(i); i += 1;\r\n            code = lastByte & 0xf;\r\n          } else {\r\n            code = (lastByte >> 4) & 0xf;\r\n            lastByte = -1;\r\n          }\r\n          step = ADPCM_STEPS[index];\r\n          delta = 0;\r\n          if (code & 4) delta += step;\r\n          if (code & 2) delta += step >> 1;\r\n          if (code & 1) delta += step >> 2;\r\n          delta += step >> 3;\r\n          index += ADPCM_INDEX[code];\r\n          if (index > 88) index = 88;\r\n          if (index < 0) index = 0;\r\n          sample += (code & 8) ? -delta : delta;\r\n          if (sample > 32767) sample = 32767;\r\n          if (sample < -32768) sample = -32768;\r\n          channel[j++] = sample / 32768;\r\n        }\r\n      }\r\n      return cb(null, buffer);\r\n    }\r\n    cb(new Error('Unrecognized WAV format ' + format));\r\n  }\r\n\r\n  export function decodeAudio(ab: ArrayBuffer): Promise<AudioBuffer> {\r\n    if (!context) {\r\n      return Promise.reject('No audio context');\r\n    }\r\n\r\n    // TODO: does not work for some audio file\r\n\r\n    return new Promise((resolve, reject) => {\r\n      decodeADPCMAudio(ab, function(err1: any, buffer: AudioBuffer) {\r\n        if (buffer) {\r\n          resolve(buffer);\r\n          return;\r\n        }\r\n\r\n        // Hope that the audio context will know what to do\r\n        audio.context!.decodeAudioData(ab)\r\n          .then((buffer) => resolve(buffer))\r\n          .catch((err2) => reject(`Could not decode audio: ${err1} | ${err2}`));\r\n      });\r\n    });\r\n  }\r\n}\r\n","/// <reference path=\"phosphorus.ts\" />\r\n\r\nnamespace P.m3 {\r\n  // Most of this is heavily based on:\r\n  // https://webglfundamentals.org/webgl/lessons/webgl-2d-matrices.html\r\n  // Eventually I want to move this to the shader itself.\r\n\r\n  export type Matrix3 = [\r\n    number, number, number,\r\n    number, number, number,\r\n    number, number, number\r\n  ];\r\n\r\n  /**\r\n   * Multiplies two 3x3 matrices together\r\n   * @param out The first matrix. The result will be stored here.\r\n   * @param other The second matrix.\r\n   */\r\n  export function multiply(out: Matrix3, other: Matrix3) {\r\n    const a0 = out[0];\r\n    const a1 = out[1];\r\n    const a2 = out[2];\r\n    const a3 = out[3];\r\n    const a4 = out[4];\r\n    const a5 = out[5];\r\n    const a6 = out[6];\r\n    const a7 = out[7];\r\n    const a8 = out[8];\r\n    const b0 = other[0];\r\n    const b1 = other[1];\r\n    const b2 = other[2];\r\n    const b3 = other[3];\r\n    const b4 = other[4];\r\n    const b5 = other[5];\r\n    const b6 = other[6];\r\n    const b7 = other[7];\r\n    const b8 = other[8];\r\n    out[0] = b0 * a0 + b1 * a3 + b2 * a6;\r\n    out[1] = b0 * a1 + b1 * a4 + b2 * a7;\r\n    out[2] = b0 * a2 + b1 * a5 + b2 * a8;\r\n    out[3] = b3 * a0 + b4 * a3 + b5 * a6;\r\n    out[4] = b3 * a1 + b4 * a4 + b5 * a7;\r\n    out[5] = b3 * a2 + b4 * a5 + b5 * a8;\r\n    out[6] = b6 * a0 + b7 * a3 + b8 * a6;\r\n    out[7] = b6 * a1 + b7 * a4 + b8 * a7;\r\n    out[8] = b6 * a2 + b7 * a5 + b8 * a8;\r\n  }\r\n\r\n  export function translation(x: number, y: number): Matrix3 {\r\n    return [\r\n      1, 0, 0,\r\n      0, 1, 0,\r\n      x, y, 1,\r\n    ];\r\n  }\r\n\r\n  export function rotation(degrees: number): Matrix3 {\r\n    const radians = degrees * Math.PI / 180;\r\n    const cos = Math.cos(radians);\r\n    const sin = Math.sin(radians);\r\n    return [\r\n      cos, -sin, 0,\r\n      sin, cos, 0,\r\n      0, 0, 1,\r\n    ];\r\n  }\r\n\r\n  export function scaling(x: number, y: number): Matrix3 {\r\n    return [\r\n      x, 0, 0,\r\n      0, y, 0,\r\n      0, 0, 1,\r\n    ];\r\n  }\r\n\r\n  export function projection(width: number, height: number): Matrix3 {\r\n    return [\r\n      2 / width, 0, 0,\r\n      0, -2 / height, 0,\r\n      -1, 1, 1,\r\n    ];\r\n  }\r\n}\r\n","/// <reference path=\"phosphorus.ts\" />\r\n/// <reference path=\"matrix.ts\" />\r\n\r\nnamespace P.renderer {\r\n  // Import aliases\r\n  import RotationStyle = P.core.RotationStyle;\r\n\r\n  export interface SpriteRenderer {\r\n    canvas: HTMLCanvasElement;\r\n    /**\r\n     * Resets and resizes the renderer\r\n     */\r\n    reset(scale: number): void;\r\n    /**\r\n     * Draws a Sprite or Stage on this renderer\r\n     */\r\n    drawChild(child: P.core.Base): void;\r\n    /**\r\n     * Draws a canvas covering the full dimensions of this renderer\r\n     */\r\n    drawLayer(canvas: HTMLCanvasElement): void;\r\n  }\r\n\r\n  export interface ProjectRenderer extends SpriteRenderer {\r\n    /**\r\n     * The canvas where pen things are drawn\r\n     */\r\n    penLayer: HTMLCanvasElement;\r\n    /**\r\n     * The canvas where the stage is drawn\r\n     */\r\n    stageLayer: HTMLCanvasElement;\r\n    /**\r\n     * Draws a line on the pen canvas\r\n     * @param color Color of the line\r\n     * @param size Width of the line\r\n     * @param x Starting X coordinate in the Scratch coordinate grid\r\n     * @param y Starting Y coordinate in the Scratch coordinate grid\r\n     * @param x2 Ending X coordinate in the Scratch coordinate grid\r\n     * @param y2 Starting Y coordinate in the Scratch coordinate grid\r\n     */\r\n    penLine(color: string, size: number, x: number, y: number, x2: number, y2: number): void;\r\n    /**\r\n     * Draws a circular dot on the pen canvas\r\n     * @param color Color of the dot\r\n     * @param size Diameter of the circle\r\n     * @param x Central X coordinate in the Scratch coordinate grid\r\n     * @param y Central Y coordinate in the Scratch coordinate grid\r\n     */\r\n    penDot(color: string, size: number, x: number, y: number): void;\r\n    /**\r\n     * Stamp a Sprite on the pen layer\r\n     */\r\n    penStamp(sprite: P.core.Sprite): void;\r\n    /**\r\n     * Clear the pen canvas\r\n     */\r\n    penClear(): void;\r\n    /**\r\n     * Resizes the pen canvas without losing the existing drawing.\r\n     */\r\n    penResize(scale: number): void;\r\n    /**\r\n     * Updates & resize the Stage layer. Implicitly calls updateStageFilters()\r\n     */\r\n    updateStage(scale: number): void;\r\n    /**\r\n     * Updates the filters applied to the Stage layer.\r\n     */\r\n    updateStageFilters(): void;\r\n    /**\r\n     * Determines if a Sprite is intersecting a point\r\n     * @param sprite The sprite\r\n     * @param x X coordinate in the Scratch coordinate grid\r\n     * @param y Y coordinate in the Scratch coordinate grid\r\n     */\r\n    spriteTouchesPoint(sprite: P.core.Sprite, x: number, y: number): boolean;\r\n    /**\r\n     * Determines if a Sprite is touching another Sprite\r\n     * @param spriteA The first sprite\r\n     * @param spriteB Other sprites to test for collision\r\n     */\r\n    spritesIntersect(spriteA: P.core.Base, otherSprites: P.core.Base[]): boolean;\r\n    /**\r\n     * Determines if a Sprite is touching a color\r\n     * @param sprite The sprite\r\n     * @param color The RGB color, in number form.\r\n     */\r\n    spriteTouchesColor(sprite: P.core.Base, color: number): boolean;\r\n    /**\r\n     * Determines if one Sprite's color touches another Sprite's color\r\n     * @param sprite The sprite\r\n     * @param spriteColor The color on the Sprite\r\n     * @param otherColor The color on the rest of the stage\r\n     */\r\n    spriteColorTouchesColor(sprite: P.core.Base, spriteColor: number, otherColor: number): boolean;\r\n  }\r\n\r\n  // HELPERS\r\n\r\n  /**\r\n   * Create an HTML canvas.\r\n   */\r\n  function createCanvas() {\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = 480;\r\n    canvas.height = 360;\r\n    return canvas;\r\n  }\r\n\r\n  /**\r\n   * Determines if a Sprite's filters will change its shape.\r\n   * @param filters The Sprite's filters\r\n   */\r\n  function filtersAffectShape(filters: P.core.Filters): boolean {\r\n    return filters.fisheye !== 0 ||\r\n      filters.mosaic !== 0 ||\r\n      filters.pixelate !== 0 ||\r\n      filters.whirl !== 0;\r\n  }\r\n\r\n  // WEBGL\r\n\r\n  // Used in the WebGL renderer for inverting sprites.\r\n  const horizontalInvertMatrix = P.m3.scaling(-1, 1);\r\n\r\n  // Extension of Costume to store the webgl textures\r\n  interface WebGLCostume extends P.core.Costume {\r\n    _glTexture: WebGLTexture;\r\n  }\r\n\r\n  class ShaderVariant {\r\n    protected uniformLocations: {[name: string]: WebGLUniformLocation} = {};\r\n    protected attributeLocations: {[name: string]: number} = {};\r\n\r\n    constructor(public gl: WebGLRenderingContext, public program: WebGLProgram) {\r\n      // When loaded we'll lookup all of our attributes and uniforms, and store\r\n      // their locations locally.\r\n      // WebGL can tell us how many there are, so we can do lookups.\r\n\r\n      const activeUniforms: number = gl.getProgramParameter(program, this.gl.ACTIVE_UNIFORMS);\r\n      for (let index = 0; index < activeUniforms; index++) {\r\n        const info = gl.getActiveUniform(program, index);\r\n        if (!info) {\r\n          throw new Error('uniform at index ' + index + ' does not exist');\r\n        }\r\n        const name = info.name;\r\n        const location = gl.getUniformLocation(program, name);\r\n        if (!location) {\r\n          throw new Error('uniform named ' + name + ' does not exist');\r\n        }\r\n        this.uniformLocations[name] = location;\r\n      }\r\n\r\n      const activeAttributes: number = gl.getProgramParameter(program, this.gl.ACTIVE_ATTRIBUTES);\r\n      for (let index = 0; index < activeAttributes; index++) {\r\n        const info = gl.getActiveAttrib(program, index);\r\n        if (!info) {\r\n          throw new Error('attribute at index ' + index + ' does not exist');\r\n        }\r\n        // Attribute index is location, I believe.\r\n        this.attributeLocations[info.name] = index;\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Sets a uniform to a float\r\n     * @param name The name of the uniform\r\n     * @param value A float\r\n     */\r\n    uniform1f(name: string, value: number) {\r\n      const location = this.getUniform(name);\r\n      this.gl.uniform1f(location, value);\r\n    }\r\n\r\n    /**\r\n     * Sets a uniform to a vec2\r\n     * @param name The name of the uniform\r\n     * @param a The first value\r\n     * @param b The second value\r\n     */\r\n    uniform2f(name: string, a: number, b: number) {\r\n      const location = this.getUniform(name);\r\n      this.gl.uniform2f(location, a, b);\r\n    }\r\n\r\n    /**\r\n     * Sets a uniform to a 3x3 matrix\r\n     * @param name The name of the uniform\r\n     * @param value The 3x3 matrix\r\n     */\r\n    uniformMatrix3(name: string, value: P.m3.Matrix3) {\r\n      const location = this.getUniform(name);\r\n      this.gl.uniformMatrix3fv(location, false, value);\r\n    }\r\n\r\n    /**\r\n     * Determines if this shader variant contains a uniform.\r\n     * @param name The name of the uniform\r\n     */\r\n    hasUniform(name: string) {\r\n      return this.uniformLocations.hasOwnProperty(name);\r\n    }\r\n\r\n    /**\r\n     * Determines the location of a uniform, or errors if it does not exist.\r\n     * @param name The name of the uniform\r\n     */\r\n    getUniform(name: string): WebGLUniformLocation {\r\n      if (!this.hasUniform(name)) {\r\n        throw new Error('uniform of name ' + name + ' does not exist');\r\n      }\r\n      return this.uniformLocations[name];\r\n    }\r\n\r\n    /**\r\n     * Binds a buffer to an attribute\r\n     * @param name The name of the attribute\r\n     * @param value The WebGL buffer to bind\r\n     */\r\n    attributeBuffer(name: string, value: WebGLBuffer) {\r\n      if (!this.hasAttribute(name)) {\r\n        throw new Error('attribute of name ' + name + ' does not exist');\r\n      }\r\n      const location = this.attributeLocations[name];\r\n      this.gl.enableVertexAttribArray(location);\r\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, value);\r\n      this.gl.vertexAttribPointer(location, 2, this.gl.FLOAT, false, 0, 0);\r\n    }\r\n\r\n    /**\r\n     * Determines if this shader contains an attribute\r\n     * @param name The name of the attribute\r\n     */\r\n    hasAttribute(name: string) {\r\n      return this.attributeLocations.hasOwnProperty(name);\r\n    }\r\n\r\n    /**\r\n     * Determines the location of an attribute, and errors if it does not exist.\r\n     * @param name The name of the attribute\r\n     */\r\n    getAttribute(name: string) {\r\n      if (!this.hasAttribute(name)) {\r\n        throw new Error('attribute of name ' + name + ' does not exist');\r\n      }\r\n      return this.attributeLocations[name];\r\n    }\r\n  }\r\n\r\n  export class WebGLSpriteRenderer implements SpriteRenderer {\r\n    public static vertexShader: string = `\r\n    attribute vec2 a_position;\r\n    attribute vec2 a_texcoord;\r\n\r\n    uniform mat3 u_matrix;\r\n\r\n    varying vec2 v_texcoord;\r\n\r\n    void main() {\r\n      gl_Position = vec4((u_matrix * vec3(a_position, 1)).xy, 0, 1);\r\n      v_texcoord = a_texcoord;\r\n    }\r\n    `;\r\n\r\n    public static fragmentShader: string = `\r\n    precision mediump float;\r\n\r\n    varying vec2 v_texcoord;\r\n\r\n    uniform sampler2D u_texture;\r\n    #ifndef ONLY_SHAPE_FILTERS\r\n      uniform float u_brightness;\r\n      uniform float u_color;\r\n    #endif\r\n    uniform float u_opacity;\r\n    uniform float u_mosaic;\r\n    uniform float u_whirl;\r\n    uniform float u_fisheye;\r\n    uniform float u_pixelate;\r\n    uniform vec2 u_size;\r\n\r\n    const float minimumAlpha = 1.0 / 250.0;\r\n    const vec2 vecCenter = vec2(0.5, 0.5);\r\n\r\n    // http://lolengine.net/blog/2013/07/27/rgb-to-hsv-in-glsl\r\n    vec3 rgb2hsv(vec3 c) {\r\n      vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\r\n      vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\r\n      vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\r\n      float d = q.x - min(q.w, q.y);\r\n      float e = 1.0e-10;\r\n      return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\r\n    }\r\n    vec3 hsv2rgb(vec3 c) {\r\n      vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\r\n      vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\r\n      return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\r\n    }\r\n\r\n    void main() {\r\n      // varyings cannot be modified\r\n      vec2 texcoord = v_texcoord;\r\n\r\n      // apply mosaic\r\n      {\r\n        texcoord = fract(u_mosaic * v_texcoord);\r\n      }\r\n\r\n      // apply pixelate\r\n      if (u_pixelate != 0.0) {\r\n        vec2 texelSize = u_size / u_pixelate;\r\n        texcoord = (floor(texcoord * texelSize) + vecCenter) / texelSize;\r\n      }\r\n\r\n      // apply whirl\r\n      {\r\n        const float radius = 0.5;\r\n        vec2 offset = texcoord - vecCenter;\r\n        float offsetMagnitude = length(offset);\r\n        float whirlFactor = max(1.0 - (offsetMagnitude / radius), 0.0);\r\n        float whirlActual = u_whirl * whirlFactor * whirlFactor;\r\n        float sinWhirl = sin(whirlActual);\r\n        float cosWhirl = cos(whirlActual);\r\n        mat2 rotationMatrix = mat2(\r\n          cosWhirl, -sinWhirl,\r\n          sinWhirl, cosWhirl\r\n        );\r\n        texcoord = rotationMatrix * offset + vecCenter;\r\n      }\r\n\r\n      // apply fisheye\r\n      {\r\n        vec2 vec = (texcoord - vecCenter) / vecCenter;\r\n        float vecLength = length(vec);\r\n        float r = pow(min(vecLength, 1.0), u_fisheye) * max(1.0, vecLength);\r\n        vec2 unit = vec / vecLength;\r\n        texcoord = vecCenter + r * unit * vecCenter;\r\n      }\r\n\r\n      vec4 color = texture2D(u_texture, texcoord);\r\n      if (color.a < minimumAlpha) {\r\n        discard;\r\n      }\r\n\r\n      // apply ghost effect\r\n      color.a *= u_opacity;\r\n      // handle premultiplied alpha\r\n      color.rgb *= u_opacity;\r\n\r\n      // apply brightness effect\r\n      #ifndef ONLY_SHAPE_FILTERS\r\n        color.rgb = clamp(color.rgb + vec3(u_brightness), 0.0, 1.0);\r\n      #endif\r\n\r\n      // The color effect is rather complicated. See:\r\n      // https://github.com/LLK/scratch-render/blob/008dc5b15b30961301e6b9a08628a063b967a001/src/shaders/sprite.frag#L175-L189\r\n      #ifndef ONLY_SHAPE_FILTERS\r\n      if (u_color != 0.0) {\r\n        vec3 hsv = rgb2hsv(color.rgb);\r\n        // hsv.x = hue\r\n        // hsv.y = saturation\r\n        // hsv.z = value\r\n\r\n        // scratch forces all colors to have some minimal amount saturation so there is a visual change\r\n        const float minValue = 0.11 / 2.0;\r\n        const float minSaturation = 0.09;\r\n        if (hsv.z < minValue) hsv = vec3(0.0, 1.0, minValue);\r\n        else if (hsv.y < minSaturation) hsv = vec3(0.0, minSaturation, hsv.z);\r\n\r\n        hsv.x = mod(hsv.x + u_color, 1.0);\r\n        if (hsv.x < 0.0) hsv.x += 1.0;\r\n        color = vec4(hsv2rgb(hsv), color.a);  \r\n      }\r\n      #endif\r\n\r\n      gl_FragColor = color;\r\n    }\r\n    `;\r\n\r\n    public canvas: HTMLCanvasElement;\r\n    public gl: WebGLRenderingContext;\r\n\r\n    protected quadBuffer: WebGLBuffer;\r\n    protected globalScaleMatrix: P.m3.Matrix3;\r\n    protected renderingShader: ShaderVariant;\r\n\r\n    constructor() {\r\n      this.canvas = createCanvas();\r\n      const gl = this.canvas.getContext('webgl');\r\n      if (!gl) {\r\n        throw new Error('cannot get webgl rendering context');\r\n      }\r\n      this.gl = gl;\r\n\r\n      this.renderingShader = this.compileVariant([]);\r\n\r\n      // Enable transparency blending.\r\n      this.gl.enable(this.gl.BLEND);\r\n      // TODO: investigate other blending modes\r\n      this.gl.blendFunc(this.gl.SRC_ALPHA, this.gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n      // Create the quad buffer that we'll use for positioning and texture coordinates later.\r\n      this.quadBuffer = this.gl.createBuffer()!;\r\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.quadBuffer);\r\n      this.gl.bufferData(this.gl.ARRAY_BUFFER, new Float32Array([\r\n        0, 0,\r\n        0, 1,\r\n        1, 0,\r\n        1, 0,\r\n        0, 1,\r\n        1, 1,\r\n      ]), this.gl.STATIC_DRAW);\r\n    }\r\n\r\n    /**\r\n     * Compile a single shader\r\n     * @param type The type of the shader. Use this.gl.VERTEX_SHADER or FRAGMENT_SHADER\r\n     * @param source The string source of the shader.\r\n     * @param definitions Flags to define in the shader source.\r\n     */\r\n    compileShader(type: number, source: string, definitions?: string[]): WebGLShader {\r\n      const addDefinition = (def: string) => {\r\n        source = '#define ' + def + '\\n' + source;\r\n      }\r\n      if (definitions) {\r\n        for (const def of definitions) {\r\n          addDefinition(def);\r\n        }\r\n      }\r\n\r\n      const shader = this.gl.createShader(type);\r\n      if (!shader) {\r\n        throw new Error('Cannot create shader');\r\n      }\r\n\r\n      this.gl.shaderSource(shader, source);\r\n      this.gl.compileShader(shader);\r\n\r\n      if (!this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS)) {\r\n        const error = this.gl.getShaderInfoLog(shader);\r\n        this.gl.deleteShader(shader);\r\n        throw new Error('Shader compilation error: ' + error);\r\n      }\r\n\r\n      return shader;\r\n    }\r\n\r\n    /**\r\n     * Compiles a vertex shader and fragment shader into a program.\r\n     * @param vs Vertex shader source.\r\n     * @param fs Fragment shader source.\r\n     * @param definitions Things to define in the source of both shaders.\r\n     */\r\n    compileProgram(vs: string, fs: string, definitions?: string[]): WebGLProgram {\r\n      const vertexShader = this.compileShader(this.gl.VERTEX_SHADER, vs, definitions);\r\n      const fragmentShader = this.compileShader(this.gl.FRAGMENT_SHADER, fs, definitions);\r\n\r\n      const program = this.gl.createProgram();\r\n      if (!program) {\r\n        throw new Error('Cannot create program');\r\n      }\r\n      this.gl.attachShader(program, vertexShader);\r\n      this.gl.attachShader(program, fragmentShader);\r\n      this.gl.linkProgram(program);\r\n\r\n      if (!this.gl.getProgramParameter(program, this.gl.LINK_STATUS)) {\r\n        const error = this.gl.getProgramInfoLog(program);\r\n        this.gl.deleteProgram(program);\r\n        throw new Error('Program compilation error: ' + error);\r\n      }\r\n\r\n      return program;\r\n    }\r\n\r\n    /**\r\n     * Compiles a variant of the default shader.\r\n     * @param definitions Things to define in the shader\r\n     */\r\n    compileVariant(definitions: string[]): ShaderVariant {\r\n      const program = this.compileProgram(WebGLSpriteRenderer.vertexShader, WebGLSpriteRenderer.fragmentShader, definitions);\r\n      return new ShaderVariant(this.gl, program);\r\n    }\r\n\r\n    /**\r\n     * Creates a new texture without inserting data.\r\n     * Texture will be bound to TEXTURE_2D, so you can texImage2D() on it\r\n     * Mipmapping will be disabled to allow for any size texture.\r\n     */\r\n    createTexture(): WebGLTexture {\r\n      const texture = this.gl.createTexture();\r\n      if (!texture) {\r\n        throw new Error('Cannot create texture');\r\n      }\r\n      this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n\r\n      this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_S, this.gl.CLAMP_TO_EDGE);\r\n      this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_T, this.gl.CLAMP_TO_EDGE);\r\n      this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.gl.LINEAR);\r\n\r\n      return texture;\r\n    }\r\n\r\n    /**\r\n     * Converts a canvas to a WebGL texture\r\n     * @param canvas The source canvas. Dimensions do not matter.\r\n     */\r\n    convertToTexture(canvas: HTMLImageElement | HTMLCanvasElement): WebGLTexture {\r\n      const texture = this.createTexture();\r\n      this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, this.gl.RGBA, this.gl.UNSIGNED_BYTE, canvas);\r\n      return texture;\r\n    }\r\n\r\n    /**\r\n     * Creates a new framebuffer\r\n     */\r\n    createFramebuffer(): WebGLFramebuffer {\r\n      const frameBuffer = this.gl.createFramebuffer();\r\n      if (!frameBuffer) {\r\n        throw new Error('cannot create frame buffer');\r\n      }\r\n      return frameBuffer;\r\n    }\r\n\r\n    reset(scale: number) {\r\n      // Scale the actual canvas\r\n      this.canvas.width = scale * P.config.scale * 480;\r\n      this.canvas.height = scale * P.config.scale * 360;\r\n      this.resetFramebuffer(scale);\r\n    }\r\n\r\n    /**\r\n     * Resizes and resets the current framebuffer\r\n     * @param scale Scale\r\n     */\r\n    resetFramebuffer(scale: number) {\r\n      this.gl.viewport(0, 0, this.canvas.width, this.canvas.height);\r\n      this.globalScaleMatrix = P.m3.scaling(scale, scale);\r\n\r\n      // Clear the canvas\r\n      this.gl.clearColor(0, 0, 0, 0);\r\n      this.gl.clear(this.gl.COLOR_BUFFER_BIT);\r\n    }\r\n\r\n    drawChild(child: P.core.Base) {\r\n      this._drawChild(child, this.renderingShader);\r\n    }\r\n\r\n    /**\r\n     * Real implementation of drawChild()\r\n     * Shader must be set before calling (allows for using a different shader)\r\n     * @param child The child to draw\r\n     */\r\n    _drawChild(child: P.core.Base, shader: ShaderVariant) {\r\n      this.gl.useProgram(shader.program);\r\n\r\n      // Create the texture if it doesn't already exist.\r\n      // We'll create a texture only once for performance.\r\n      const costume = child.costumes[child.currentCostumeIndex] as WebGLCostume;\r\n      if (!costume._glTexture) {\r\n        const texture = this.convertToTexture(costume.image);\r\n        costume._glTexture = texture;\r\n      }\r\n      this.gl.bindTexture(this.gl.TEXTURE_2D, costume._glTexture);\r\n\r\n      shader.attributeBuffer('a_texcoord', this.quadBuffer);\r\n      shader.attributeBuffer('a_position', this.quadBuffer);\r\n\r\n      // TODO: do this in the shader if its possible/faster\r\n      const matrix = P.m3.projection(this.canvas.width, this.canvas.height);\r\n      P.m3.multiply(matrix, this.globalScaleMatrix);\r\n      P.m3.multiply(matrix, P.m3.translation(240 + child.scratchX | 0, 180 - child.scratchY | 0));\r\n      if (P.core.isSprite(child)) {\r\n        if (child.rotationStyle === RotationStyle.Normal && child.direction !== 90) {\r\n          P.m3.multiply(matrix, P.m3.rotation(90 - child.direction));\r\n        } else if (child.rotationStyle === RotationStyle.LeftRight && child.direction < 0) {\r\n          P.m3.multiply(matrix, horizontalInvertMatrix);\r\n        }\r\n        if (child.scale !== 1) {\r\n          P.m3.multiply(matrix, P.m3.scaling(child.scale, child.scale));\r\n        }\r\n      }\r\n      if (costume.scale !== 1) {\r\n        P.m3.multiply(matrix, P.m3.scaling(costume.scale, costume.scale));\r\n      }\r\n      P.m3.multiply(matrix, P.m3.translation(-costume.rotationCenterX, -costume.rotationCenterY));\r\n      P.m3.multiply(matrix, P.m3.scaling(costume.image.width, costume.image.height));\r\n\r\n      shader.uniformMatrix3('u_matrix', matrix);\r\n\r\n      // Effects\r\n      if (shader.hasUniform('u_opacity')) {\r\n        shader.uniform1f('u_opacity', 1 - child.filters.ghost / 100);\r\n      }\r\n      if (shader.hasUniform('u_brightness')) {\r\n        shader.uniform1f('u_brightness', child.filters.brightness / 100);\r\n      }\r\n      if (shader.hasUniform('u_color')) {\r\n        shader.uniform1f('u_color', child.filters.color / 200);\r\n      }\r\n      if (shader.hasUniform('u_mosaic')) {\r\n        const mosaic = Math.round((Math.abs(child.filters.mosaic) + 10) / 10);\r\n        shader.uniform1f('u_mosaic', P.utils.clamp(mosaic, 1, 512));\r\n      }\r\n      if (shader.hasUniform('u_whirl')) {\r\n        shader.uniform1f('u_whirl', child.filters.whirl * Math.PI / -180);\r\n      }\r\n      if (shader.hasUniform('u_fisheye')) {\r\n        shader.uniform1f('u_fisheye', Math.max(0, (child.filters.fisheye + 100) / 100));\r\n      }\r\n      if (shader.hasUniform('u_pixelate')) {\r\n        shader.uniform1f('u_pixelate', Math.abs(child.filters.pixelate) / 10);\r\n      }\r\n      if (shader.hasUniform('u_size')) {\r\n        shader.uniform2f('u_size', costume.image.width, costume.image.height);\r\n      }\r\n\r\n      this.gl.drawArrays(this.gl.TRIANGLES, 0, 6);\r\n    }\r\n\r\n    drawLayer(canvas: HTMLCanvasElement) {\r\n      const shader = this.renderingShader;\r\n      this.gl.useProgram(shader.program);\r\n\r\n      const texture = this.convertToTexture(canvas);\r\n      this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n\r\n      shader.attributeBuffer('a_texcoord', this.quadBuffer);\r\n      shader.attributeBuffer('a_position', this.quadBuffer);\r\n\r\n      const matrix = P.m3.projection(this.canvas.width, this.canvas.height);\r\n      P.m3.multiply(matrix, this.globalScaleMatrix);\r\n\r\n      shader.uniformMatrix3('u_matrix', matrix);\r\n      shader.uniform1f('u_opacity', 1);\r\n\r\n      // TODO: is it necessary to delete textures?\r\n      this.gl.deleteTexture(texture);\r\n    }\r\n  }\r\n\r\n  export class WebGLProjectRenderer extends WebGLSpriteRenderer implements ProjectRenderer {\r\n    public penLayer: HTMLCanvasElement;\r\n    public stageLayer: HTMLCanvasElement;\r\n    protected fallbackRenderer: ProjectRenderer;\r\n    protected shaderOnlyShapeFilters = this.compileVariant(['ONLY_SHAPE_FILTERS']);\r\n\r\n    constructor(public stage: P.core.Stage) {\r\n      super();\r\n      this.fallbackRenderer = new ProjectRenderer2D(stage);\r\n      this.penLayer = this.fallbackRenderer.penLayer;\r\n      this.stageLayer = this.fallbackRenderer.stageLayer;\r\n    }\r\n\r\n    /**\r\n     * Sets this renderer to render to a framebuffer.\r\n     * Initializes, binds, attaches, and clears the texture and framebuffer.\r\n     * Framebuffer must be reset later.\r\n     * @param framebuffer The framebuffer\r\n     * @param texture The texture\r\n     */\r\n    setRenderToFramebuffer(framebuffer: WebGLFramebuffer, texture: WebGLTexture) {\r\n      // setup framebuffer\r\n      this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, framebuffer);\r\n      // setup texture\r\n      this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\r\n      this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, 480, 360, 0, this.gl.RGBA, this.gl.UNSIGNED_BYTE, null);\r\n      this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER, this.gl.COLOR_ATTACHMENT0, this.gl.TEXTURE_2D, texture, 0);\r\n      // fix viewport/clear\r\n      // always use a scale of 1 for now\r\n      this.resetFramebuffer(1);\r\n    }\r\n\r\n    /**\r\n     * Sets this renderer to render to the canvas instead of a framebuffer\r\n     */\r\n    resetRenderFramebuffer() {\r\n      this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, null);\r\n    }\r\n\r\n    penLine(color: string, size: number, x: number, y: number, x2: number, y2: number): void {\r\n      this.fallbackRenderer.penLine(color, size, x, y, x2, y2);\r\n    }\r\n\r\n    penDot(color: string, size: number, x: number, y: number): void {\r\n      this.fallbackRenderer.penDot(color, size, x, y);\r\n    }\r\n\r\n    penStamp(sprite: P.core.Sprite): void {\r\n      this.fallbackRenderer.penStamp(sprite);\r\n    }\r\n\r\n    penClear(): void {\r\n      this.fallbackRenderer.penClear();\r\n    }\r\n\r\n    penResize(scale: number): void {\r\n      this.fallbackRenderer.penResize(scale);\r\n    }\r\n\r\n    updateStage(scale: number): void {\r\n      this.fallbackRenderer.updateStage(scale);\r\n    }\r\n\r\n    updateStageFilters(): void {\r\n      this.fallbackRenderer.updateStageFilters();\r\n    }\r\n\r\n    spriteTouchesPoint(sprite: core.Sprite, x: number, y: number): boolean {\r\n      // If filters will not change the shape of the sprite, it would be faster\r\n      // to avoid going to the GPU\r\n      if (!filtersAffectShape(sprite.filters)) {\r\n        return this.fallbackRenderer.spriteTouchesPoint(sprite, x, y);\r\n      }\r\n\r\n      const texture = this.createTexture();\r\n      const framebuffer = this.createFramebuffer();\r\n      this.setRenderToFramebuffer(framebuffer, texture);\r\n\r\n      this._drawChild(sprite, this.shaderOnlyShapeFilters);\r\n\r\n      // Allocate 4 bytes to store 1 RGBA pixel\r\n      const result = new Uint8Array(4);\r\n      // Coordinates are in pixels from the lower left corner\r\n      // We only care about 1 pixel, the pixel at the mouse cursor.\r\n      this.gl.readPixels(240 + x | 0, 180 + y | 0, 1, 1, this.gl.RGBA, this.gl.UNSIGNED_BYTE, result);\r\n\r\n      this.resetRenderFramebuffer();\r\n\r\n      // I don't know if it's necessary to delete these\r\n      this.gl.deleteTexture(texture);\r\n      this.gl.deleteFramebuffer(framebuffer);\r\n\r\n      // Just look for a non-zero alpha channel\r\n      return result[3] !== 0;\r\n    }\r\n\r\n    spritesIntersect(spriteA: core.Sprite, otherSprites: core.Base[]): boolean {\r\n      // Render the original Sprite into a buffer just once\r\n      const baseResult = new Uint8Array(480 * 360 * 4);\r\n      const baseTexture = this.createTexture();\r\n      const baseBuffer = this.createFramebuffer();\r\n      this.setRenderToFramebuffer(baseBuffer, baseTexture);\r\n      this._drawChild(spriteA, this.shaderOnlyShapeFilters);\r\n      this.gl.readPixels(0, 0, 480, 360, this.gl.RGBA, this.gl.UNSIGNED_BYTE, baseResult);\r\n\r\n      // Setup the rendering for the other sprite just once for performance\r\n      const otherResult = new Uint8Array(480 * 360 * 4);\r\n      const textureB = this.createTexture();\r\n      const framebufferB = this.createFramebuffer();\r\n      this.setRenderToFramebuffer(framebufferB, textureB);\r\n\r\n      for (var i = 0; i < otherSprites.length; i++) {\r\n        const otherSprite = otherSprites[i];\r\n        if (!otherSprite.visible) continue;\r\n\r\n        // Does the rendering of the sprite\r\n        this._drawChild(otherSprite, this.shaderOnlyShapeFilters);\r\n        this.gl.readPixels(0, 0, 480, 360, this.gl.RGBA, this.gl.UNSIGNED_BYTE, otherResult)\r\n\r\n        const length = 480 * 360 * 4;\r\n        for (var i = 0; i < length; i += 4) {\r\n          if (baseResult[i + 3] && otherResult[i + 3]) {\r\n            this.resetRenderFramebuffer();\r\n            return true;\r\n          }\r\n        }\r\n      }\r\n\r\n      this.resetRenderFramebuffer();\r\n      return false;\r\n    }\r\n\r\n    spriteTouchesColor(sprite: core.Base, color: number): boolean {\r\n      return this.fallbackRenderer.spriteTouchesColor(sprite, color);\r\n    }\r\n\r\n    spriteColorTouchesColor(sprite: core.Base, spriteColor: number, otherColor: number): boolean {\r\n      return this.spriteColorTouchesColor(sprite, spriteColor, otherColor);\r\n    }\r\n  }\r\n\r\n  // 2D\r\n\r\n  /**\r\n   * Creates the CSS filter for a Filter object.\r\n   * The filter is generally an estimation of the actual effect.\r\n   * Includes brightness and color. (does not include ghost)\r\n   */\r\n  function cssFilter(filters: P.core.Filters) {\r\n    let filter = '';\r\n    if (filters.brightness) {\r\n      filter += 'brightness(' + (100 + filters.brightness) + '%) ';\r\n    }\r\n    if (filters.color) {\r\n      filter += 'hue-rotate(' + (filters.color / 200 * 360) + 'deg) ';\r\n    }\r\n    return filter;\r\n  }\r\n\r\n  export class SpriteRenderer2D implements SpriteRenderer {\r\n    public ctx: CanvasRenderingContext2D;\r\n    public canvas: HTMLCanvasElement;\r\n    public noEffects: boolean = false;\r\n\r\n    constructor() {\r\n      this.canvas = createCanvas();\r\n      this.ctx = this.canvas.getContext('2d')!;\r\n    }\r\n\r\n    reset(scale: number) {\r\n      this._reset(this.ctx, scale);\r\n    }\r\n\r\n    drawImage(image: CanvasImageSource, x: number, y: number) {\r\n      this.ctx.drawImage(image, x, y);\r\n    }\r\n\r\n    drawChild(c: P.core.Base) {\r\n      this._drawChild(c, this.ctx);\r\n    }\r\n\r\n    drawLayer(canvas: HTMLCanvasElement) {\r\n      this.ctx.drawImage(canvas, 0, 0, 480, 360);\r\n    }\r\n\r\n    protected _reset(ctx: CanvasRenderingContext2D, scale: number) {\r\n      const effectiveScale = scale * P.config.scale;\r\n      ctx.canvas.width = 480 * effectiveScale;\r\n      ctx.canvas.height = 360 * effectiveScale;\r\n      ctx.scale(effectiveScale, effectiveScale);\r\n    }\r\n\r\n    protected _drawChild(c: P.core.Base, ctx: CanvasRenderingContext2D) {\r\n      const costume = c.costumes[c.currentCostumeIndex];\r\n      if (!costume) {\r\n        return;\r\n      }\r\n\r\n      ctx.save();\r\n\r\n      const scale = c.stage.zoom * P.config.scale;\r\n      ctx.translate(((c.scratchX + 240) * scale | 0) / scale, ((180 - c.scratchY) * scale | 0) / scale);\r\n\r\n      // Direction transforms are only applied to Sprites because Stages cannot be rotated.\r\n      if (P.core.isSprite(c)) {\r\n        if (c.rotationStyle === RotationStyle.Normal) {\r\n          ctx.rotate((c.direction - 90) * Math.PI / 180);\r\n        } else if (c.rotationStyle === RotationStyle.LeftRight && c.direction < 0) {\r\n          ctx.scale(-1, 1);\r\n        }\r\n        ctx.scale(c.scale, c.scale);\r\n      }\r\n\r\n      ctx.scale(costume.scale, costume.scale);\r\n      ctx.translate(-costume.rotationCenterX, -costume.rotationCenterY);\r\n\r\n      if (!this.noEffects) {\r\n        ctx.globalAlpha = Math.max(0, Math.min(1, 1 - c.filters.ghost / 100));\r\n\r\n        const filter = cssFilter(c.filters);\r\n        // Only apply a filter if necessary, otherwise Firefox performance\r\n        // nosedives.\r\n        if (filter !== '') {\r\n          ctx.filter = filter;\r\n        }\r\n      }\r\n\r\n      ctx.drawImage(costume.image, 0, 0);\r\n      ctx.restore();\r\n    }\r\n  }\r\n\r\n  // Renderers used for some features such as collision detection\r\n  const workingRenderer = new SpriteRenderer2D();\r\n  const workingRenderer2 = new SpriteRenderer2D();\r\n\r\n  export class ProjectRenderer2D extends SpriteRenderer2D implements ProjectRenderer {\r\n    public stageLayer: HTMLCanvasElement;\r\n    public stageContext: CanvasRenderingContext2D;\r\n    public penLayer: HTMLCanvasElement;\r\n    public penContext: CanvasRenderingContext2D;\r\n\r\n    constructor(public stage: P.core.Stage) {\r\n      super();\r\n      this.stageLayer = createCanvas();\r\n      this.stageContext = this.stageLayer.getContext('2d')!;\r\n      this.penLayer = createCanvas();\r\n      this.penContext = this.penLayer.getContext('2d')!;\r\n    }\r\n\r\n    updateStage(scale: number) {\r\n      this._reset(this.stageContext, scale);\r\n      this.noEffects = true;\r\n      this._drawChild(this.stage, this.stageContext);\r\n      this.noEffects = false;\r\n      this.updateStageFilters();\r\n    }\r\n\r\n    updateStageFilters() {\r\n      const filter = cssFilter(this.stage.filters);\r\n      // Only reapply a CSS filter if it has changed for performance.\r\n      // Might not be necessary here.\r\n      if (this.stageLayer.style.filter !== filter) {\r\n        this.stageLayer.style.filter = filter;\r\n      }\r\n\r\n      // cssFilter does not include ghost\r\n      this.stageLayer.style.opacity = '' + Math.max(0, Math.min(1, 1 - this.stage.filters.ghost / 100));\r\n    }\r\n\r\n    penClear() {\r\n      this.penContext.clearRect(0, 0, this.penLayer.width, this.penLayer.height);\r\n    }\r\n\r\n    penResize(scale: number) {\r\n      const cachedCanvas = document.createElement('canvas');\r\n      cachedCanvas.width = this.penLayer.width;\r\n      cachedCanvas.height = this.penLayer.height;\r\n      cachedCanvas.getContext('2d')!.drawImage(this.penLayer, 0, 0);\r\n      this._reset(this.penContext, scale);\r\n      this.penContext.drawImage(cachedCanvas, 0, 0, 480, 360);\r\n    }\r\n\r\n    penDot(color: string, size: number, x: number, y: number) {\r\n      this.penContext.fillStyle = color;\r\n      this.penContext.beginPath();\r\n      this.penContext.arc(240 + x, 180 - y, size / 2, 0, 2 * Math.PI, false);\r\n      this.penContext.fill();\r\n    }\r\n\r\n    penLine(color: string, size: number, x1: number, y1: number, x2: number, y2: number) {\r\n      this.penContext.lineCap = 'round';\r\n      if (size % 2 > .5 && size % 2 < 1.5) {\r\n        x1 -= .5;\r\n        y1 -= .5;\r\n        x2 -= .5;\r\n        y2 -= .5;\r\n      }\r\n      this.penContext.strokeStyle = color;\r\n      this.penContext.lineWidth = size;\r\n      this.penContext.beginPath();\r\n      this.penContext.moveTo(240 + x1, 180 - y1);\r\n      this.penContext.lineTo(240 + x2, 180 - y2);\r\n      this.penContext.stroke();\r\n    }\r\n\r\n    penStamp(sprite: P.core.Sprite) {\r\n      this._drawChild(sprite, this.penContext);\r\n    }\r\n\r\n    spriteTouchesPoint(sprite: P.core.Sprite, x: number, y: number) {\r\n      const costume = sprite.costumes[sprite.currentCostumeIndex];\r\n      const bounds = sprite.rotatedBounds();\r\n      if (x < bounds.left || y < bounds.bottom || x > bounds.right || y > bounds.top) {\r\n        return false;\r\n      }\r\n\r\n      var cx = (x - sprite.scratchX) / sprite.scale;\r\n      var cy = (sprite.scratchY - y) / sprite.scale;\r\n      if (sprite.rotationStyle === RotationStyle.Normal && sprite.direction !== 90) {\r\n        const d = (90 - sprite.direction) * Math.PI / 180;\r\n        const ox = cx;\r\n        const s = Math.sin(d), c = Math.cos(d);\r\n        cx = c * ox - s * cy;\r\n        cy = s * ox + c * cy;\r\n      } else if (sprite.rotationStyle === RotationStyle.LeftRight && sprite.direction < 0) {\r\n        cx = -cx;\r\n      }\r\n\r\n      const positionX = Math.round(cx * costume.bitmapResolution + costume.rotationCenterX);\r\n      const positionY = Math.round(cy * costume.bitmapResolution + costume.rotationCenterY);\r\n      const data = costume.context().getImageData(positionX, positionY, 1, 1).data;\r\n      return data[3] !== 0;\r\n    }\r\n\r\n    spritesIntersect(spriteA: core.Base, otherSprites: core.Base[]) {\r\n      for (var i = 0; i < otherSprites.length; i++) {\r\n        const spriteB = otherSprites[i];\r\n        if (!spriteB.visible) continue;\r\n  \r\n        const mb = spriteA.rotatedBounds();\r\n        const ob = spriteB.rotatedBounds();\r\n  \r\n        if (mb.bottom >= ob.top || ob.bottom >= mb.top || mb.left >= ob.right || ob.left >= mb.right) {\r\n          continue;\r\n        }\r\n  \r\n        const left = Math.max(mb.left, ob.left);\r\n        const top = Math.min(mb.top, ob.top);\r\n        const right = Math.min(mb.right, ob.right);\r\n        const bottom = Math.max(mb.bottom, ob.bottom);\r\n  \r\n        const width = right - left;\r\n        const height = top - bottom;\r\n  \r\n        if (width < 1 || height < 1) {\r\n          return false;\r\n        }\r\n  \r\n        workingRenderer.canvas.width = width;\r\n        workingRenderer.canvas.height = height;\r\n  \r\n        workingRenderer.ctx.save();\r\n        workingRenderer.noEffects = true;\r\n  \r\n        workingRenderer.ctx.translate(-(left + 240), -(180 - top));\r\n        workingRenderer.drawChild(spriteA);\r\n        workingRenderer.ctx.globalCompositeOperation = 'source-in';\r\n        workingRenderer.drawChild(spriteB);\r\n  \r\n        workingRenderer.noEffects = false;\r\n        workingRenderer.ctx.restore();\r\n  \r\n        const data = workingRenderer.ctx.getImageData(0, 0, width, height).data;\r\n        const length = data.length;\r\n  \r\n        for (var j = 0; j < length; j += 4) {\r\n          // check for the opacity byte being a non-zero number\r\n          if (data[j + 3]) {\r\n            return true;\r\n          }\r\n        }\r\n      }\r\n      return false;\r\n    }\r\n\r\n    spriteTouchesColor(sprite: P.core.Base, color: number) {\r\n      const b = sprite.rotatedBounds();\r\n\r\n      workingRenderer.canvas.width = b.right - b.left;\r\n      workingRenderer.canvas.height = b.top - b.bottom;\r\n\r\n      workingRenderer.ctx.save();\r\n      workingRenderer.ctx.translate(-(240 + b.left), -(180 - b.top));\r\n\r\n      sprite.stage.drawAll(workingRenderer, sprite);\r\n      workingRenderer.ctx.globalCompositeOperation = 'destination-in';\r\n      workingRenderer.drawChild(sprite);\r\n\r\n      workingRenderer.ctx.restore();\r\n\r\n      const data = workingRenderer.ctx.getImageData(0, 0, b.right - b.left, b.top - b.bottom).data;\r\n\r\n      color = color & 0xffffff;\r\n      const length = (b.right - b.left) * (b.top - b.bottom) * 4;\r\n      for (var i = 0; i < length; i += 4) {\r\n        if ((data[i] << 16 | data[i + 1] << 8 | data[i + 2]) === color && data[i + 3]) {\r\n          return true;\r\n        }\r\n      }\r\n\r\n      return false;\r\n    }\r\n\r\n    spriteColorTouchesColor(sprite: P.core.Base, spriteColor: number, otherColor: number) {\r\n      var rb = sprite.rotatedBounds();\r\n\r\n      workingRenderer.canvas.width = workingRenderer2.canvas.width = rb.right - rb.left;\r\n      workingRenderer.canvas.height = workingRenderer2.canvas.height = rb.top - rb.bottom;\r\n\r\n      workingRenderer.ctx.save();\r\n      workingRenderer2.ctx.save();\r\n      workingRenderer.ctx.translate(-(240 + rb.left), -(180 - rb.top));\r\n      workingRenderer2.ctx.translate(-(240 + rb.left), -(180 - rb.top));\r\n\r\n      sprite.stage.drawAll(workingRenderer, sprite);\r\n      workingRenderer.drawChild(sprite);\r\n\r\n      workingRenderer.ctx.restore();\r\n\r\n      var dataA = workingRenderer.ctx.getImageData(0, 0, rb.right - rb.left, rb.top - rb.bottom).data;\r\n      var dataB = workingRenderer.ctx.getImageData(0, 0, rb.right - rb.left, rb.top - rb.bottom).data;\r\n\r\n      spriteColor = spriteColor & 0xffffff;\r\n      otherColor = otherColor & 0xffffff;\r\n\r\n      var length = dataA.length;\r\n      for (var i = 0; i < length; i += 4) {\r\n        var touchesSource = (dataB[i] << 16 | dataB[i + 1] << 8 | dataB[i + 2]) === spriteColor && dataB[i + 3];\r\n        var touchesOther = (dataA[i] << 16 | dataA[i + 1] << 8 | dataA[i + 2]) === otherColor && dataA[i + 3];\r\n        if (touchesSource && touchesOther) {\r\n          return true;\r\n        }\r\n      }\r\n\r\n      return false;\r\n    }\r\n  }\r\n}\r\n","/// <reference path=\"phosphorus.ts\" />\r\n/// <reference path=\"config.ts\" />\r\n/// <reference path=\"renderer.ts\" />\r\n\r\n// Phosphorus base classes\r\n// Implements most functionality while leaving some specifics to implementations (P.sb2, P.sb3)\r\nnamespace P.core {\r\n  interface RotatedBounds {\r\n    // A----------+\r\n    // |          |\r\n    // |          |\r\n    // +----------B\r\n    // Where top is the scratchY of A,\r\n    // bottom is the scratchY of B,\r\n    // left is the scratchX of A,\r\n    // and right is the scratchX of B\r\n\r\n    top: number;\r\n    bottom: number;\r\n    left: number;\r\n    right: number;\r\n  }\r\n\r\n  interface Listeners {\r\n    whenClicked: P.runtime.Fn[];\r\n    whenCloned: P.runtime.Fn[];\r\n    whenGreenFlag: P.runtime.Fn[];\r\n    whenIReceive: ObjectMap<P.runtime.Fn[]>;\r\n    whenKeyPressed: P.runtime.Fn[][];\r\n    whenBackdropChanges: ObjectMap<P.runtime.Fn[]>;\r\n    whenSceneStarts: P.runtime.Fn[];\r\n    // whenSensorGreaterThan: P.runtime.Fn[]\r\n  }\r\n\r\n  export interface Filters {\r\n    color: number;\r\n    fisheye: number;\r\n    whirl: number;\r\n    pixelate: number;\r\n    mosaic: number;\r\n    brightness: number;\r\n    ghost: number;\r\n  }\r\n\r\n  export const enum RotationStyle {\r\n    /**\r\n     * Indicates this sprite may rotate in any direction.\r\n     */\r\n    Normal,\r\n    /**\r\n     * Indicates this sprite can only rotate left or right.\r\n     */\r\n    LeftRight,\r\n    /**\r\n     * Indicates this sprite cannot rotate.\r\n     */\r\n    None,\r\n  }\r\n\r\n  export const enum SpecialObjects {\r\n    Mouse = '_mouse_',\r\n    Stage = '_stage_',\r\n    Random = '_random_',\r\n    Edge = '_edge_',\r\n  }\r\n\r\n  export abstract class Base {\r\n    /**\r\n     * The stage this object belongs to.\r\n     */\r\n    public stage: Stage;\r\n    /**\r\n     * Is this a stage?\r\n     */\r\n    public isStage: boolean = false;\r\n    /**\r\n     * Is this a sprite?\r\n     */\r\n    public isSprite: boolean = false;\r\n    /**\r\n     * Was this Sprite created as a clone of another?\r\n     */\r\n    public isClone: boolean = false;\r\n    /**\r\n     * Is this object visible?\r\n     */\r\n    public visible: boolean = true;\r\n    /**\r\n     * The sprite's X coordinate on the Scratch grid.\r\n     */\r\n    public scratchX: number = 0;\r\n    /**\r\n     * The sprite's Y coordinate on the Scratch grid.\r\n     */\r\n    public scratchY: number = 0;\r\n    /**\r\n     * The name of this object.\r\n     */\r\n    public name: string = '';\r\n    /**\r\n     * Costumes that belong to this object.\r\n     */\r\n    public costumes: Costume[] = [];\r\n    /**\r\n     * The index of the currently selected costume in its costume list.\r\n     */\r\n    public currentCostumeIndex: number = 0;\r\n    /**\r\n     * Sounds that belong to this object.\r\n     */\r\n    public sounds: Sound[] = [];\r\n    /**\r\n     * Maps the names of sounds to the corresponding Sound\r\n     */\r\n    public soundRefs: ObjectMap<Sound> = {};\r\n    /**\r\n     * Currently selected instrument\r\n     */\r\n    public instrument: number = 0;\r\n    /**\r\n     * The volume of this object, with 1 being 100%\r\n     */\r\n    public volume: number = 1;\r\n    /**\r\n     * The audio node that this object outputs to.\r\n     */\r\n    public node: GainNode | null = null;\r\n    /**\r\n     * Maps names (or ids) of variables or lists to their Watcher, if any.\r\n     */\r\n    public watchers: ObjectMap<Watcher> = {};\r\n    /**\r\n     * Variables of this object.\r\n     * Maps variable names (or ids) to their value.\r\n     * Values can be of any type and should likely be converted first.\r\n     */\r\n    public vars: ObjectMap<any> = {};\r\n    /**\r\n     * Lists of this object.\r\n     * Maps list names (or ids) to their list.\r\n     * Each list can contain objects of any type, and should be converted first.\r\n     */\r\n    public lists: ObjectMap<Array<any>> = {};\r\n    /**\r\n     * Is this object saying something?\r\n     */\r\n    public saying: boolean = false;\r\n    /**\r\n     * Should this object's speech bubble be a thinking bubble instead?\r\n     */\r\n    public thinking: boolean = false;\r\n    /**\r\n     * The ID of the last thing said.\r\n     */\r\n    public sayId: number = 0;\r\n    public bubbleContainer: HTMLElement;\r\n    public bubblePointer: HTMLElement;\r\n    public bubbleText: Text;\r\n    /**\r\n     * Maps procedure names (usually includes parameters) to the Procedure object\r\n     */\r\n    public procedures: ObjectMap<Procedure> = {};\r\n    public listeners: Listeners = {\r\n      whenClicked: [],\r\n      whenCloned: [],\r\n      whenGreenFlag: [],\r\n      whenIReceive: {},\r\n      whenKeyPressed: [],\r\n      whenBackdropChanges: {},\r\n      whenSceneStarts: [],\r\n    };\r\n    public fns: P.runtime.Fn[] = [];\r\n    public filters: Filters = {\r\n      color: 0,\r\n      fisheye: 0,\r\n      whirl: 0,\r\n      pixelate: 0,\r\n      mosaic: 0,\r\n      brightness: 0,\r\n      ghost: 0,\r\n    };\r\n\r\n    constructor() {\r\n      for (var i = 0; i < 128; i++) {\r\n        this.listeners.whenKeyPressed.push([]);\r\n      }\r\n    }\r\n\r\n    // Data/Loading methods\r\n\r\n    addSound(sound: Sound) {\r\n      this.soundRefs[sound.name] = sound;\r\n      this.sounds.push(sound);\r\n    }\r\n\r\n    // Implementations of Scratch blocks\r\n\r\n    showVariable(name: string, visible: boolean) {\r\n      let watcher = this.watchers[name];\r\n\r\n      // Create watchers that might not exist\r\n      if (!watcher) {\r\n        const newWatcher = this.createVariableWatcher(this, name);\r\n        if (!newWatcher) {\r\n          return;\r\n        }\r\n        newWatcher.init();\r\n        this.watchers[name] = watcher = newWatcher;\r\n        this.stage.allWatchers.push(watcher);\r\n      }\r\n\r\n      watcher.setVisible(visible);\r\n    }\r\n\r\n    showNextCostume() {\r\n      this.currentCostumeIndex = (this.currentCostumeIndex + 1) % this.costumes.length;\r\n      if (this.saying && isSprite(this)) this.updateBubble();\r\n    }\r\n\r\n    showPreviousCostume() {\r\n      var length = this.costumes.length;\r\n      this.currentCostumeIndex = (this.currentCostumeIndex + length - 1) % length;\r\n      if (this.saying && isSprite(this)) this.updateBubble();\r\n    }\r\n\r\n    getCostumeName() {\r\n      return this.costumes[this.currentCostumeIndex] ? this.costumes[this.currentCostumeIndex].name : '';\r\n    }\r\n\r\n    setCostume(costume) {\r\n      if (typeof costume !== 'number') {\r\n        costume = '' + costume;\r\n        for (var i = 0; i < this.costumes.length; i++) {\r\n          if (this.costumes[i].name === costume) {\r\n            this.currentCostumeIndex = i;\r\n            if (this.saying && isSprite(this)) this.updateBubble();\r\n            return;\r\n          }\r\n        }\r\n        if (costume === (this.isSprite ? 'next costume' : 'next backdrop')) {\r\n          this.showNextCostume();\r\n          return;\r\n        }\r\n        if (costume === (this.isSprite ? 'previous costume' : 'previous backdrop')) {\r\n          this.showPreviousCostume();\r\n          return;\r\n        }\r\n        if (!isFinite(costume)) {\r\n          return;\r\n        }\r\n      }\r\n      var i = (Math.floor(costume) - 1 || 0) % this.costumes.length;\r\n      if (i < 0) i += this.costumes.length;\r\n      this.currentCostumeIndex = i;\r\n      if (isSprite(this) && this.saying) this.updateBubble();\r\n    }\r\n\r\n    setFilter(name: string, value: number) {\r\n      switch (name) {\r\n        case 'ghost':\r\n          if (value < 0) value = 0;\r\n          if (value > 100) value = 100;\r\n          break;\r\n        case 'brightness':\r\n          if (value < -100) value = -100;\r\n          if (value > 100) value = 100;\r\n          break;\r\n        case 'color':\r\n          value = value % 200;\r\n          if (value < 0) value += 200;\r\n          break;\r\n      }\r\n      this.filters[name] = value;\r\n    }\r\n\r\n    changeFilter(name: string, value: number) {\r\n      this.setFilter(name, this.filters[name] + value);\r\n    }\r\n\r\n    resetFilters() {\r\n      this.filters = {\r\n        color: 0,\r\n        fisheye: 0,\r\n        whirl: 0,\r\n        pixelate: 0,\r\n        mosaic: 0,\r\n        brightness: 0,\r\n        ghost: 0\r\n      };\r\n    }\r\n\r\n    getSound(name) {\r\n      if (typeof name === 'string') {\r\n        var s = this.soundRefs[name];\r\n        if (s) return s;\r\n        name = +name;\r\n      }\r\n      var l = this.sounds.length;\r\n      if (l && typeof name === 'number' && name === name) {\r\n        var i = Math.round(name - 1) % l;\r\n        if (i < 0) i += l;\r\n        return this.sounds[i];\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Stops all sounds in this object. Does not include children.\r\n     */\r\n    stopSounds() {\r\n      if (this.node) {\r\n        this.node.disconnect();\r\n        this.node = null;\r\n      }\r\n      for (var i = this.sounds.length; i--;) {\r\n        var s = this.sounds[i];\r\n        if (s.node) {\r\n          s.node.disconnect();\r\n          s.node = null;\r\n        }\r\n      }\r\n    }\r\n\r\n    ask(question: string) {\r\n      var stage = this.stage;\r\n      if (question) {\r\n        if (this.visible && isSprite(this)) {\r\n          this.say(question);\r\n          stage.promptTitle.style.display = 'none';\r\n        } else {\r\n          stage.promptTitle.style.display = 'block';\r\n          stage.promptTitle.textContent = question;\r\n        }\r\n      } else {\r\n        stage.promptTitle.style.display = 'none';\r\n      }\r\n      stage.hidePrompt = false;\r\n      stage.prompter.style.display = 'block';\r\n      stage.prompt.value = '';\r\n      stage.prompt.focus();\r\n    }\r\n\r\n    /**\r\n     * Makes this object say some text.\r\n     * @param text The text to say\r\n     * @param thinking If the text box should be in the thinking style or just speaking\r\n     * @returns A unique ID for this bubble\r\n     */\r\n    say(text: string, thinking: boolean = false): number {\r\n      text = text.toString();\r\n\r\n      // Empty strings disable saying anything.\r\n      if (text.length === 0) {\r\n        this.saying = false;\r\n        if (this.bubbleContainer) this.bubbleContainer.style.display = 'none';\r\n        return ++this.sayId;\r\n      }\r\n\r\n      this.saying = true;\r\n      this.thinking = thinking;\r\n      if (!this.bubbleContainer) {\r\n        this.bubbleContainer = document.createElement('div');\r\n        this.bubbleContainer.style.maxWidth = (127/14)+'em';\r\n        this.bubbleContainer.style.minWidth = (48/14)+'em';\r\n        this.bubbleContainer.style.padding = (8/14)+'em '+(10/14)+'em';\r\n        this.bubbleContainer.style.border = (3/14)+'em solid rgb(160, 160, 160)';\r\n        this.bubbleContainer.style.borderRadius = (10/14)+'em';\r\n        this.bubbleContainer.style.background = '#fff';\r\n        this.bubbleContainer.style.position = 'absolute';\r\n        this.bubbleContainer.style.font = 'bold 1.4em sans-serif';\r\n        this.bubbleContainer.style.whiteSpace = 'pre-wrap';\r\n        this.bubbleContainer.style.wordWrap = 'break-word';\r\n        this.bubbleContainer.style.textAlign = 'center';\r\n        this.bubbleContainer.style.cursor = 'default';\r\n        this.bubbleContainer.style.pointerEvents = 'auto';\r\n        this.bubbleContainer.appendChild(this.bubbleText = document.createTextNode(''));\r\n        this.bubbleContainer.appendChild(this.bubblePointer = document.createElement('div'));\r\n        this.bubblePointer.style.position = 'absolute';\r\n        this.bubblePointer.style.height = (21 / 14) + 'em';\r\n        this.bubblePointer.style.width = (44 / 14) + 'em';\r\n        this.bubblePointer.style.background = 'url(\"icons.svg\")';\r\n        this.bubblePointer.style.backgroundSize = (384/14) + 'em ' + (64/14) + 'em';\r\n        this.bubblePointer.style.backgroundPositionY = (-4/14) + 'em';\r\n        this.stage.ui.appendChild(this.bubbleContainer);\r\n      }\r\n      this.bubblePointer.style.backgroundPositionX = (thinking ? -323 : -259) / 14 + 'em';\r\n      this.bubbleContainer.style.display = 'block';\r\n      this.bubbleText.nodeValue = text;\r\n      this.updateBubble();\r\n      return ++this.sayId;\r\n    }\r\n\r\n    /**\r\n     * Updates the position of the speech bubble, or hides it.\r\n     */\r\n    updateBubble() {\r\n      if (!this.visible || !this.saying) {\r\n        this.bubbleContainer.style.display = 'none';\r\n        return;\r\n      }\r\n\r\n      const b = this.rotatedBounds();\r\n      const left = 240 + b.right;\r\n      var bottom = 180 + b.top;\r\n      const width = this.bubbleContainer.offsetWidth / this.stage.zoom;\r\n      const height = this.bubbleContainer.offsetHeight / this.stage.zoom;\r\n      this.bubblePointer.style.top = ((height - 6) / 14) + 'em';\r\n      if (left + width + 2 > 480) {\r\n        this.bubbleContainer.style.right = ((240 - b.left) / 14) + 'em';\r\n        this.bubbleContainer.style.left = 'auto';\r\n        this.bubblePointer.style.right = (3/14)+'em';\r\n        this.bubblePointer.style.left = 'auto';\r\n        this.bubblePointer.style.backgroundPositionY = (-36/14)+'em';\r\n      } else {\r\n        this.bubbleContainer.style.left = (left / 14) + 'em';\r\n        this.bubbleContainer.style.right = 'auto';\r\n        this.bubblePointer.style.left = (3/14)+'em';\r\n        this.bubblePointer.style.right = 'auto';\r\n        this.bubblePointer.style.backgroundPositionY = (-4/14)+'em';\r\n      }\r\n      if (bottom + height + 2 > 360) {\r\n        bottom = 360 - height - 2;\r\n      }\r\n      if (bottom < 19) {\r\n        bottom = 19;\r\n      }\r\n      this.bubbleContainer.style.bottom = (bottom / 14) + 'em';\r\n    }\r\n\r\n    /**\r\n     * Tells this object to cleanup some of the things it may have created.\r\n     */\r\n    remove() {\r\n      if (this.bubbleContainer) {\r\n        this.stage.ui.removeChild(this.bubbleContainer);\r\n        // I don't think doing this is necessary.\r\n        delete this.bubbleContainer;\r\n      }\r\n      if (this.node) {\r\n        this.node.disconnect();\r\n        this.node = null;\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Determines the value of a variable from its name.\r\n     * Please use .vars instead for most use cases.\r\n     * @param name The name of the variable, as displayed in the Scratch interface.\r\n     */\r\n    abstract lookupVariable(name: string): any;\r\n\r\n    /**\r\n     * Gets the rectangular bounds that contain this sprite in its entirety.\r\n     */\r\n    abstract rotatedBounds(): RotatedBounds;\r\n\r\n    /**\r\n     * Create a Watcher for a variable.\r\n     * @param target The sprite that will own the watcher\r\n     * @param variableName The name (or id) of the variable to monitor\r\n     */\r\n    abstract createVariableWatcher(target: Base, variableName: string): Watcher | null;\r\n  }\r\n\r\n  type KeyList = Array<boolean | undefined> & { any: number; };\r\n\r\n  // A stage object\r\n  export abstract class Stage extends Base {\r\n    public stage = this;\r\n    public isStage = true;\r\n\r\n    /**\r\n     * Sprites inside of this stage.\r\n     */\r\n    public children: Sprite[] = [];\r\n\r\n    /**\r\n     * All variable watchers in this stage.\r\n     */\r\n    public allWatchers: Watcher[] = [];\r\n\r\n    public answer: string = '';\r\n    public promptId: number = 0;\r\n    public nextPromptId: number = 0;\r\n    public hidePrompt: boolean = false;\r\n\r\n    public tempoBPM: number = 60;\r\n\r\n    public zoom: number = 1;\r\n    public maxZoom: number = P.config.scale;\r\n\r\n    public keys: KeyList;\r\n\r\n    public rawMouseX: number = 0;\r\n    public rawMouseY: number = 0;\r\n    public mouseX: number = 0;\r\n    public mouseY: number = 0;\r\n    public mousePressed: boolean = false;\r\n\r\n    public username: string = '';\r\n\r\n    public runtime: P.runtime.Runtime;\r\n\r\n    public counter: number = 0;\r\n\r\n    public root: HTMLElement;\r\n    public ui: HTMLElement;\r\n\r\n    public canvas: HTMLCanvasElement;\r\n    public renderer: P.renderer.ProjectRenderer;\r\n\r\n    public prompt: HTMLInputElement;\r\n    public prompter: HTMLElement;\r\n    public promptTitle: HTMLElement;\r\n    public promptButton: HTMLElement;\r\n    public mouseSprite: Sprite | undefined;\r\n\r\n    private _currentCostumeIndex: number = this.currentCostumeIndex;\r\n\r\n    constructor() {\r\n      super();\r\n\r\n      this.runtime = new P.runtime.Runtime(this);\r\n\r\n      this.keys = [] as any;\r\n      this.keys.any = 0;\r\n\r\n      this.root = document.createElement('div');\r\n      this.root.classList.add('forkphorus-root');\r\n      this.root.style.position = 'absolute';\r\n      this.root.style.overflow = 'hidden';\r\n      this.root.style.userSelect = 'none';\r\n\r\n      const scale = P.config.scale;\r\n\r\n      if (P.config.useWebGL) {\r\n        this.renderer = new P.renderer.WebGLProjectRenderer(this);\r\n      } else {\r\n        this.renderer = new P.renderer.ProjectRenderer2D(this);\r\n      }\r\n      this.renderer.reset(scale);\r\n      this.renderer.penResize(1);\r\n\r\n      this.canvas = this.renderer.canvas;\r\n      this.root.appendChild(this.renderer.stageLayer);\r\n      this.root.appendChild(this.renderer.penLayer);\r\n      this.root.appendChild(this.canvas);\r\n\r\n      this.ui = document.createElement('div');\r\n      this.root.appendChild(this.ui);\r\n      this.ui.style.pointerEvents = 'none';\r\n\r\n      this.canvas.tabIndex = 0;\r\n      this.canvas.style.outline = 'none';\r\n\r\n      this.root.addEventListener('keydown', (e) => {\r\n        var c = e.keyCode;\r\n        if (!this.keys[c]) this.keys.any++;\r\n        this.keys[c] = true;\r\n        if (e.ctrlKey || e.altKey || e.metaKey || c === 27) return;\r\n        e.stopPropagation();\r\n        if (e.target === this.canvas) {\r\n          e.preventDefault();\r\n          this.runtime.trigger('whenKeyPressed', c);\r\n        }\r\n      });\r\n\r\n      this.root.addEventListener('keyup', (e) => {\r\n        var c = e.keyCode;\r\n        if (this.keys[c]) this.keys.any--;\r\n        this.keys[c] = false;\r\n        e.stopPropagation();\r\n        if (e.target === this.canvas) {\r\n          e.preventDefault();\r\n        }\r\n      });\r\n\r\n      this.root.addEventListener('wheel', (e) => {\r\n        // Scroll up/down triggers key listeners for up/down arrows, but without affecting \"is key pressed?\" blocks\r\n        if (e.deltaY > 0) {\r\n          // 40 = down arrow\r\n          this.runtime.trigger('whenKeyPressed', 40);\r\n        } else if (e.deltaY < 0) {\r\n          // 38 = up arrow\r\n          this.runtime.trigger('whenKeyPressed', 38);\r\n        }\r\n      }, { passive: true });\r\n\r\n      if (P.config.hasTouchEvents) {\r\n        document.addEventListener('touchstart', (e: TouchEvent) => {\r\n          if (!this.runtime.isRunning) return;\r\n\r\n          this.mousePressed = true;\r\n          const target = e.target as HTMLElement;\r\n\r\n          for (var i = 0; i < e.changedTouches.length; i++) {\r\n            const t = e.changedTouches[i];\r\n            this.updateMousePosition(t);\r\n            if (e.target === this.canvas) {\r\n              this.clickMouse();\r\n            }\r\n            this.ontouch(e, t);\r\n          }\r\n\r\n          if (e.target === this.canvas) e.preventDefault();\r\n        });\r\n\r\n        document.addEventListener('touchmove', (e: TouchEvent) => {\r\n          if (!this.runtime.isRunning) return;\r\n\r\n          this.updateMousePosition(e.changedTouches[0]);\r\n          for (var i = 0; i < e.changedTouches.length; i++) {\r\n            const t = e.changedTouches[i];\r\n            this.ontouch(e, t);\r\n          }\r\n        });\r\n\r\n        document.addEventListener('touchend', (e: TouchEvent) => {\r\n          if (!this.runtime.isRunning) return;\r\n\r\n          this.releaseMouse();\r\n          for (var i = 0; i < e.changedTouches.length; i++) {\r\n            const t = e.changedTouches[i];\r\n            this.ontouch(e, t);\r\n          }\r\n        });\r\n      } else {\r\n        document.addEventListener('mousedown', (e: MouseEvent) => {\r\n          if (!this.runtime.isRunning) return;\r\n\r\n          this.mousePressed = true;\r\n          this.updateMousePosition(e);\r\n\r\n          if (e.target === this.canvas) {\r\n            this.clickMouse();\r\n            e.preventDefault();\r\n            this.canvas.focus();\r\n          }\r\n\r\n          this.onmousedown(e);\r\n        });\r\n\r\n        document.addEventListener('mousemove', (e: MouseEvent) => {\r\n          if (!this.runtime.isRunning) return;\r\n          this.updateMousePosition(e);\r\n          this.onmousemove(e);\r\n        });\r\n\r\n        document.addEventListener('mouseup', (e: MouseEvent) => {\r\n          if (!this.runtime.isRunning) return;\r\n          this.updateMousePosition(e);\r\n          this.releaseMouse();\r\n          this.onmouseup(e);\r\n        });\r\n      }\r\n\r\n      this.prompter = document.createElement('div');\r\n      this.ui.appendChild(this.prompter);\r\n      this.prompter.style.zIndex = '1';\r\n      this.prompter.style.pointerEvents = 'auto';\r\n      this.prompter.style.position = 'absolute';\r\n      this.prompter.style.left =\r\n      this.prompter.style.right = '1.4em';\r\n      this.prompter.style.bottom = '.6em';\r\n      this.prompter.style.padding = '.5em 3.0em .5em .5em';\r\n      this.prompter.style.border = '.3em solid rgb(46, 174, 223)';\r\n      this.prompter.style.borderRadius = '.8em';\r\n      this.prompter.style.background = '#fff';\r\n      this.prompter.style.display = 'none';\r\n\r\n      this.promptTitle = document.createElement('div');\r\n      this.prompter.appendChild(this.promptTitle);\r\n      this.promptTitle.textContent = '';\r\n      this.promptTitle.style.cursor = 'default';\r\n      this.promptTitle.style.font = 'bold 1.3em sans-serif';\r\n      this.promptTitle.style.margin = '0 '+(-25/13)+'em '+(5/13)+'em 0';\r\n      this.promptTitle.style.whiteSpace = 'pre';\r\n      this.promptTitle.style.overflow = 'hidden';\r\n      this.promptTitle.style.textOverflow = 'ellipsis';\r\n\r\n      this.prompt = document.createElement('input');\r\n      this.prompter.appendChild(this.prompt);\r\n      this.prompt.style.border = '0';\r\n      this.prompt.style.background = '#eee';\r\n      this.prompt.style.boxSizing = 'border-box';\r\n      this.prompt.style.font = '1.3em sans-serif';\r\n      this.prompt.style.padding = '0 '+(3/13)+'em';\r\n      this.prompt.style.outline = '0';\r\n      this.prompt.style.margin = '0';\r\n      this.prompt.style.width = '100%';\r\n      this.prompt.style.height = ''+(20/13)+'em';\r\n      this.prompt.style.display = 'block';\r\n      this.prompt.style.borderRadius = '0';\r\n      this.prompt.style.boxShadow = 'inset '+(1/13)+'em '+(1/13)+'em '+(2/13)+'em rgba(0, 0, 0, .2), inset '+(-1/13)+'em '+(-1/13)+'em '+(1/13)+'em rgba(255, 255, 255, .2)';\r\n      this.prompt.style.webkitAppearance = 'none';\r\n\r\n      this.promptButton = document.createElement('div');\r\n      this.prompter.appendChild(this.promptButton);\r\n      this.promptButton.style.width = '2.2em';\r\n      this.promptButton.style.height = '2.2em';\r\n      this.promptButton.style.position = 'absolute';\r\n      this.promptButton.style.right = '.4em';\r\n      this.promptButton.style.bottom = '.4em';\r\n      this.promptButton.style.background = 'url(icons.svg) -22.8em -0.4em';\r\n      this.promptButton.style.backgroundSize = '38.4em 6.4em';\r\n\r\n      this.prompt.addEventListener('keydown', (e) => {\r\n        if (e.keyCode === 13) {\r\n          this.submitPrompt();\r\n        }\r\n      });\r\n\r\n      this.promptButton.addEventListener(P.config.hasTouchEvents ? 'touchstart' : 'mousedown', this.submitPrompt.bind(this));\r\n    }\r\n\r\n    // Event hooks for implementing stages to optionally use\r\n    ontouch(e: TouchEvent, t: Touch) {\r\n\r\n    }\r\n    onmousedown(e: MouseEvent) {\r\n\r\n    }\r\n    onmouseup(e: MouseEvent) {\r\n\r\n    }\r\n    onmousemove(e: MouseEvent) {\r\n\r\n    }\r\n\r\n    /**\r\n     * Delete the stage.\r\n     */\r\n    destroy() {\r\n      this.runtime.stopAll();\r\n      this.runtime.pause();\r\n      this.stopAllSounds();\r\n    }\r\n\r\n    /**\r\n     * Give browser focus to the Stage.\r\n     */\r\n    focus() {\r\n      if (this.promptId < this.nextPromptId) {\r\n        this.prompt.focus();\r\n      } else {\r\n        this.canvas.focus();\r\n      }\r\n    }\r\n\r\n    updateMousePosition(e) {\r\n      var rect = this.canvas.getBoundingClientRect();\r\n      var x = (e.clientX - rect.left) / this.zoom - 240;\r\n      var y = 180 - (e.clientY - rect.top) / this.zoom;\r\n      this.rawMouseX = x;\r\n      this.rawMouseY = y;\r\n      if (x < -240) x = -240;\r\n      if (x > 240) x = 240;\r\n      if (y < -180) y = -180;\r\n      if (y > 180) y = 180;\r\n      this.mouseX = x;\r\n      this.mouseY = y;\r\n    }\r\n\r\n    /**\r\n     * Updates the backdrop canvas to match the current backdrop.\r\n     */\r\n    updateBackdrop() {\r\n      if (!this.renderer) return;\r\n      this.renderer.updateStage(this.zoom * P.config.scale);\r\n    }\r\n\r\n    /**\r\n     * Changes the zoom level and resizes DOM elements.\r\n     */\r\n    setZoom(zoom: number) {\r\n      if (this.zoom === zoom) return;\r\n      if (this.maxZoom < zoom * P.config.scale) {\r\n        this.maxZoom = zoom * P.config.scale;\r\n        this.renderer.penResize(this.maxZoom);\r\n      }\r\n      this.root.style.width = (480 * zoom | 0) + 'px';\r\n      this.root.style.height = (360 * zoom | 0) + 'px';\r\n      this.root.style.fontSize = (zoom*10) + 'px';\r\n      this.zoom = zoom;\r\n      this.updateBackdrop();\r\n    }\r\n\r\n    clickMouse() {\r\n      this.mouseSprite = undefined;\r\n      for (var i = this.children.length; i--;) {\r\n        var c = this.children[i];\r\n        if (c.visible && c.filters.ghost < 100 && c.touching(SpecialObjects.Mouse)) {\r\n          if (c.isDraggable) {\r\n            this.mouseSprite = c;\r\n            c.mouseDown();\r\n          } else {\r\n            this.runtime.triggerFor(c, 'whenClicked');\r\n          }\r\n          return;\r\n        }\r\n      }\r\n      this.runtime.triggerFor(this, 'whenClicked');\r\n    }\r\n\r\n    releaseMouse() {\r\n      this.mousePressed = false;\r\n      if (this.mouseSprite) {\r\n        this.mouseSprite.mouseUp();\r\n        this.mouseSprite = undefined;\r\n      }\r\n    }\r\n\r\n    setFilter(name: string, value: number) {\r\n      // Override setFilter() to update the filters on the real stage.\r\n      super.setFilter(name, value);\r\n      this.renderer.updateStageFilters();\r\n    }\r\n\r\n    /**\r\n     * Gets an object with its name, ignoring clones.\r\n     * SpecialObjects.Stage will point to the stage.\r\n     */\r\n    getObject(name: string): Base | null {\r\n      for (var i = 0; i < this.children.length; i++) {\r\n        var c = this.children[i];\r\n        if (c.name === name && !c.isClone) {\r\n          return c;\r\n        }\r\n      }\r\n      if (name === SpecialObjects.Stage || name === this.name) {\r\n        return this;\r\n      }\r\n      return null;\r\n    }\r\n\r\n    /**\r\n     * Gets all the objects with a name, including clones.\r\n     * Special values are not supported.\r\n     */\r\n    getObjects(name: string): P.core.Base[] {\r\n      const result: P.core.Base[] = [];\r\n      for (var i = 0; i < this.children.length; i++) {\r\n        if (this.children[i].name === name) {\r\n          result.push(this.children[i]);\r\n        }\r\n      }\r\n      return result;\r\n    }\r\n\r\n    /**\r\n     * Determines the position of an object, with support for special values.\r\n     */\r\n    getPosition(name: string): {x: number, y: number} | null {\r\n      switch (name) {\r\n        case SpecialObjects.Mouse: return {\r\n          x: this.mouseX,\r\n          y: this.mouseY,\r\n        };\r\n        case SpecialObjects.Random: return {\r\n          x: Math.round(480 * Math.random() - 240),\r\n          y: Math.round(360 * Math.random() - 180),\r\n        };\r\n      }\r\n\r\n      const sprite = this.getObject(name);\r\n      if (!sprite) return null;\r\n      return {\r\n        x: sprite.scratchX,\r\n        y: sprite.scratchY,\r\n      };\r\n    }\r\n\r\n    /**\r\n     * Draws this stage on it's renderer.\r\n     */\r\n    draw() {\r\n      this.renderer.reset(this.zoom);\r\n\r\n      this.drawChildren(this.renderer);\r\n\r\n      for (var i = this.allWatchers.length; i--;) {\r\n        var w = this.allWatchers[i];\r\n        if (w.visible) {\r\n          w.update();\r\n        }\r\n      }\r\n\r\n      if (this.hidePrompt) {\r\n        this.hidePrompt = false;\r\n        this.prompter.style.display = 'none';\r\n        this.canvas.focus();\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Draws all the children (not including the Stage itself or pen layers) of this Stage on a renderer\r\n     * @param skip Optionally skip rendering of a single Sprite.\r\n     */\r\n    drawChildren(renderer: P.renderer.SpriteRenderer, skip?: Base) {\r\n      for (var i = 0; i < this.children.length; i++) {\r\n        const c = this.children[i];\r\n        if (c.isDragging) {\r\n          // TODO: move\r\n          c.moveTo(c.dragOffsetX + c.stage.mouseX, c.dragOffsetY + c.stage.mouseY);\r\n        }\r\n        if (c.visible && c !== skip) {\r\n          renderer.drawChild(c);\r\n        }\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Draws all parts of the Stage (including the stage itself and pen layers) on a renderer.\r\n     * @param skip Optionally skip rendering of a single Sprite.\r\n     */\r\n    drawAll(renderer: P.renderer.SpriteRenderer, skip?: Base) {\r\n      renderer.drawChild(this);\r\n      renderer.drawLayer(this.renderer.penLayer);\r\n      this.drawChildren(renderer, skip);\r\n    }\r\n\r\n    // Implement rotatedBounds() to return something.\r\n    rotatedBounds() {\r\n      return {\r\n        top: 0,\r\n        bottom: 0,\r\n        left: 0,\r\n        right: 0,\r\n      };\r\n    }\r\n\r\n    // Override currentCostumeIndex to automatically update the backdrop when a change is made.\r\n    get currentCostumeIndex() {\r\n      return this._currentCostumeIndex;\r\n    }\r\n    set currentCostumeIndex(index: number) {\r\n      this._currentCostumeIndex = index;\r\n      this.updateBackdrop();\r\n    }\r\n\r\n    // Implementing Scratch blocks\r\n\r\n    stopAllSounds() {\r\n      for (var children = this.children, i = children.length; i--;) {\r\n        children[i].stopSounds();\r\n      }\r\n      this.stopSounds();\r\n    }\r\n\r\n    removeAllClones() {\r\n      var i = this.children.length;\r\n      while (i--) {\r\n        if (this.children[i].isClone) {\r\n          this.children[i].remove();\r\n          this.children.splice(i, 1);\r\n        }\r\n      }\r\n    }\r\n\r\n    moveTo() {\r\n      // do nothing -- stage cannot be moved\r\n    }\r\n\r\n    submitPrompt() {\r\n      if (this.promptId < this.nextPromptId) {\r\n        this.answer = this.prompt.value;\r\n        this.promptId += 1;\r\n        if (this.promptId >= this.nextPromptId) {\r\n          this.hidePrompt = true;\r\n        }\r\n      }\r\n    }\r\n\r\n    clearPen() {\r\n      this.renderer.penClear();\r\n    }\r\n  }\r\n\r\n  // A sprite object\r\n  export abstract class Sprite extends Base {\r\n    public isSprite = true;\r\n    /**\r\n     * Is this Sprite a clone of another Sprite?\r\n     */\r\n    public isClone = false;\r\n    /**\r\n     * The direction this Sprite is facing.\r\n     * 0 is directly up, and 90 is directly right.\r\n     */\r\n    public direction: number = 90;\r\n    /**\r\n     * How this object rotates.\r\n     */\r\n    public rotationStyle: RotationStyle = RotationStyle.Normal;\r\n    /**\r\n     * Can this Sprite be dragged?\r\n     */\r\n    public isDraggable: boolean = false;\r\n    /**\r\n     * Is this Sprite currently being dragged?\r\n     */\r\n    public isDragging: boolean = false;\r\n    /**\r\n     * This sprite's size, with 1 being 100% (normal size)\r\n     * Sprites are scaled from their costume's center\r\n     */\r\n    public scale: number = 1;\r\n\r\n    // Pen data\r\n    public penHue: number = 240;\r\n    public penSaturation: number = 100;\r\n    public penLightness: number = 50;\r\n    public penAlpha: number = 1;\r\n    public penCSS: string = '';\r\n    public penSize: number = 1;\r\n    public penColor: number = 0x000000;\r\n    public isPenDown: boolean = false;\r\n\r\n    // It's related to dragging sprites.\r\n    public dragStartX: number = 0;\r\n    public dragStartY: number = 0;\r\n    public dragOffsetX: number = 0;\r\n    public dragOffsetY: number = 0;\r\n\r\n    constructor(stage: Stage) {\r\n      super();\r\n      this.stage = stage;\r\n    }\r\n\r\n    mouseDown() {\r\n      this.dragStartX = this.scratchX;\r\n      this.dragStartY = this.scratchY;\r\n      this.dragOffsetX = this.scratchX - this.stage.mouseX;\r\n      this.dragOffsetY = this.scratchY - this.stage.mouseY;\r\n      this.isDragging = true;\r\n    }\r\n\r\n    mouseUp() {\r\n      // We consider a sprite to be clicked if it has been dragged to the same start & end points\r\n      if (this.isDragging && this.scratchX === this.dragStartX && this.scratchY === this.dragStartY) {\r\n        this.stage.runtime.triggerFor(this, 'whenClicked');\r\n      }\r\n      this.isDragging = false;\r\n    }\r\n\r\n    // Determines the rotated bounds of the sprite.\r\n    rotatedBounds() {\r\n      const costume = this.costumes[this.currentCostumeIndex];\r\n\r\n      const scale = costume.scale * this.scale;\r\n      var left = -costume.rotationCenterX * scale;\r\n      var top = costume.rotationCenterY * scale;\r\n      var right = left + costume.image.width * scale;\r\n      var bottom = top - costume.image.height * scale;\r\n\r\n      if (this.rotationStyle !== RotationStyle.Normal) {\r\n        if (this.rotationStyle === RotationStyle.LeftRight && this.direction < 0) {\r\n          right = -left;\r\n          left = right - costume.image.width * costume.scale * this.scale;\r\n        }\r\n        return {\r\n          left: this.scratchX + left,\r\n          right: this.scratchX + right,\r\n          top: this.scratchY + top,\r\n          bottom: this.scratchY + bottom\r\n        };\r\n      }\r\n\r\n      const mSin = Math.sin(this.direction * Math.PI / 180);\r\n      const mCos = Math.cos(this.direction * Math.PI / 180);\r\n\r\n      // Top left\r\n      const tlX = mSin * left - mCos * top;\r\n      const tlY = mCos * left + mSin * top;\r\n\r\n      // Top right\r\n      const trX = mSin * right - mCos * top;\r\n      const trY = mCos * right + mSin * top;\r\n\r\n      // Bottom left\r\n      const blX = mSin * left - mCos * bottom;\r\n      const blY = mCos * left + mSin * bottom;\r\n\r\n      // Bottom right\r\n      const brX = mSin * right - mCos * bottom;\r\n      const brY = mCos * right + mSin * bottom;\r\n\r\n      return {\r\n        left: this.scratchX + Math.min(tlX, trX, blX, brX),\r\n        right: this.scratchX + Math.max(tlX, trX, blX, brX),\r\n        top: this.scratchY + Math.max(tlY, trY, blY, brY),\r\n        bottom: this.scratchY + Math.min(tlY, trY, blY, brY)\r\n      };\r\n    }\r\n\r\n    // Shows the rotated bounds of the sprite. For debugging.\r\n    showRotatedBounds() {\r\n      var bounds = this.rotatedBounds();\r\n      var div = document.createElement('div');\r\n      div.style.outline = '1px solid red';\r\n      div.style.position = 'absolute';\r\n      div.style.left = (240 + bounds.left) + 'px';\r\n      div.style.top = (180 - bounds.top) + 'px';\r\n      div.style.width = (bounds.right - bounds.left) + 'px';\r\n      div.style.height = (bounds.top - bounds.bottom) + 'px';\r\n      this.stage.canvas.parentNode!.appendChild(div);\r\n    }\r\n\r\n    // Implementing Scratch blocks\r\n\r\n    createVariableWatcher(target: P.core.Base, variableName: string) {\r\n      // Asking our parent to handle it is easier.\r\n      return this.stage.createVariableWatcher(target, variableName);\r\n    }\r\n\r\n    // Moves forward some number of steps in the current direction.\r\n    forward(steps: number) {\r\n      const d = (90 - this.direction) * Math.PI / 180;\r\n      this.moveTo(this.scratchX + steps * Math.cos(d), this.scratchY + steps * Math.sin(d));\r\n    }\r\n\r\n    // Moves the sprite to a coordinate\r\n    // Draws a line if the pen is currently down.\r\n    moveTo(x: number, y: number) {\r\n      var ox = this.scratchX;\r\n      var oy = this.scratchY;\r\n      if (ox === x && oy === y && !this.isPenDown) {\r\n        return;\r\n      }\r\n      this.scratchX = x;\r\n      this.scratchY = y;\r\n\r\n      if (this.isPenDown && !this.isDragging) {\r\n        this.stage.renderer.penLine(this.getPenCSS(), this.penSize, ox, oy, x, y);\r\n      }\r\n\r\n      if (this.saying) {\r\n        this.updateBubble();\r\n      }\r\n    }\r\n\r\n    // Makes a pen dot at the current location.\r\n    dotPen() {\r\n      this.stage.renderer.penDot(this.getPenCSS(), this.penSize, this.scratchX, this.scratchY);\r\n    }\r\n\r\n    // Stamps the sprite onto the pen layer.\r\n    stamp() {\r\n      this.stage.renderer.penStamp(this);\r\n    }\r\n\r\n    getPenCSS() {\r\n      // This is only temporary\r\n      return this.penCSS || 'hsla(' + this.penHue + 'deg,' + this.penSaturation + '%,' + (this.penLightness > 100 ? 200 - this.penLightness : this.penLightness) + '%, ' + this.penAlpha + ')';\r\n    }\r\n\r\n    // Faces in a direction.\r\n    setDirection(degrees: number) {\r\n      var d = degrees % 360;\r\n      if (d > 180) d -= 360;\r\n      if (d <= -180) d += 360;\r\n      this.direction = d;\r\n      if (this.saying) this.updateBubble();\r\n    }\r\n\r\n    // Clones this sprite.\r\n    clone() {\r\n      const clone = this._clone();\r\n      clone.isClone = true;\r\n\r\n      // Copy variables and lists without passing reference\r\n      for (const key of Object.keys(this.vars)) {\r\n        clone.vars[key] = this.vars[key];\r\n      }\r\n      for (const key of Object.keys(this.lists)) {\r\n        clone.lists[key] = this.lists[key].slice(0);\r\n      }\r\n\r\n      clone.filters = {\r\n        color: this.filters.color,\r\n        fisheye: this.filters.fisheye,\r\n        whirl: this.filters.whirl,\r\n        pixelate: this.filters.pixelate,\r\n        mosaic: this.filters.mosaic,\r\n        brightness: this.filters.brightness,\r\n        ghost: this.filters.ghost\r\n      };\r\n\r\n      // Copy scripts\r\n      clone.procedures = this.procedures;\r\n      clone.listeners = this.listeners;\r\n      clone.fns = this.fns;\r\n\r\n      // Copy Data\r\n      clone.name = this.name;\r\n      clone.costumes = this.costumes;\r\n      clone.currentCostumeIndex = this.currentCostumeIndex;\r\n      clone.sounds = this.sounds;\r\n      clone.soundRefs = this.soundRefs;\r\n      clone.direction = this.direction;\r\n      clone.instrument = this.instrument;\r\n      clone.isDraggable = this.isDraggable;\r\n      clone.rotationStyle = this.rotationStyle;\r\n      clone.scale = this.scale;\r\n      clone.volume = this.volume;\r\n      clone.scratchX = this.scratchX;\r\n      clone.scratchY = this.scratchY;\r\n      clone.visible = this.visible;\r\n      clone.penColor = this.penColor;\r\n      clone.penCSS = this.penCSS;\r\n      clone.penHue = this.penHue;\r\n      clone.penSaturation = this.penSaturation;\r\n      clone.penLightness = this.penLightness;\r\n      clone.penSize = this.penSize;\r\n      clone.isPenDown = this.isPenDown;\r\n\r\n      return clone;\r\n    }\r\n\r\n    // Must return a new instance of this Sprite's constructor. Data copying will be handled in clone()\r\n    protected abstract _clone(): P.core.Sprite;\r\n\r\n    /**\r\n     * Determines if this sprite is touching another object.\r\n     * @param thing The name of the other object(s)\r\n     */\r\n    touching(thing: string) {\r\n      if (thing === SpecialObjects.Mouse) {\r\n        const x = this.stage.rawMouseX;\r\n        const y = this.stage.rawMouseY;\r\n        return this.stage.renderer.spriteTouchesPoint(this, x, y);\r\n      } else if (thing === SpecialObjects.Edge) {\r\n        const bounds = this.rotatedBounds();\r\n        return bounds.left <= -240 || bounds.right >= 240 || bounds.top >= 180 || bounds.bottom <= -180;\r\n      } else {\r\n        if (!this.visible) return false;\r\n        const sprites = this.stage.getObjects(thing);\r\n        return this.stage.renderer.spritesIntersect(this, sprites);\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Determines if this Sprite is touching a color.\r\n     * @param color RGB color, as a single number.\r\n     */\r\n    touchingColor(color: number) {\r\n      return this.stage.renderer.spriteTouchesColor(this, color);\r\n    }\r\n\r\n    /**\r\n     * Determines if one of this Sprite's colors are touching another color.\r\n     * @param sourceColor This sprite's color, as an RGB color.\r\n     * @param touchingColor The other color, as an RGB color.\r\n     */\r\n    colorTouchingColor(sourceColor: number, touchingColor: number) {\r\n      return this.stage.renderer.spriteColorTouchesColor(this, sourceColor, touchingColor);\r\n    }\r\n\r\n    /**\r\n     * Bounces this Sprite off of an edge of the Stage, if this Sprite is touching one.\r\n     */\r\n    bounceOffEdge() {\r\n      var b = this.rotatedBounds();\r\n      var dl = 240 + b.left;\r\n      var dt = 180 - b.top;\r\n      var dr = 240 - b.right;\r\n      var db = 180 + b.bottom;\r\n\r\n      var d = Math.min(dl, dt, dr, db);\r\n      if (d > 0) return;\r\n\r\n      var dir = this.direction * Math.PI / 180;\r\n      var dx = Math.sin(dir);\r\n      var dy = -Math.cos(dir);\r\n\r\n      switch (d) {\r\n        case dl: dx = Math.max(0.2, Math.abs(dx)); break;\r\n        case dt: dy = Math.max(0.2, Math.abs(dy)); break;\r\n        case dr: dx = -Math.max(0.2, Math.abs(dx)); break;\r\n        case db: dy = -Math.max(0.2, Math.abs(dy)); break;\r\n      }\r\n\r\n      this.direction = Math.atan2(dy, dx) * 180 / Math.PI + 90;\r\n      if (this.saying) this.updateBubble();\r\n\r\n      b = this.rotatedBounds();\r\n      var x = this.scratchX;\r\n      var y = this.scratchY;\r\n      if (b.left < -240) x += -240 - b.left;\r\n      if (b.top > 180) y += 180 - b.top;\r\n      if (b.right > 240) x += 240 - b.left;\r\n      if (b.bottom < -180) y += -180 - b.top;\r\n    }\r\n\r\n    /**\r\n     * Determines the distance from this Sprite's center to another position.\r\n     * @param thing The name of any position or Sprite, as accepted by getPosition()\r\n     */\r\n    distanceTo(thing: string) {\r\n      const p = this.stage.getPosition(thing);\r\n      if (!p) {\r\n        return 10000;\r\n      }\r\n      const x = p.x;\r\n      const y = p.y;\r\n      return Math.sqrt((this.scratchX - x) * (this.scratchX - x) + (this.scratchY - y) * (this.scratchY - y));\r\n    }\r\n\r\n    /**\r\n     * Makes this Sprite go to another Sprite\r\n     * @param thing The name of any position or Sprite, as accepted by getPosition()\r\n     */\r\n    gotoObject(thing: string) {\r\n      const position = this.stage.getPosition(thing);\r\n      if (!position) {\r\n        return 0;\r\n      }\r\n      this.moveTo(position.x, position.y);\r\n    }\r\n\r\n    /**\r\n     * Makes this Sprite point towards another object.\r\n     * @param thing The name of any position or Sprite, as accepted by getPosition()\r\n     */\r\n    pointTowards(thing: string) {\r\n      const position = this.stage.getPosition(thing);\r\n      if (!position) {\r\n        return 0;\r\n      }\r\n      const dx = position.x - this.scratchX;\r\n      const dy = position.y - this.scratchY;\r\n      this.direction = dx === 0 && dy === 0 ? 90 : Math.atan2(dx, dy) * 180 / Math.PI;\r\n      if (this.saying) this.updateBubble();\r\n    }\r\n\r\n    /**\r\n     * Set the RGB color of the pen.\r\n     */\r\n    setPenColor(color: number) {\r\n      this.penColor = color;\r\n      const r = this.penColor >> 16 & 0xff;\r\n      const g = this.penColor >> 8 & 0xff;\r\n      const b = this.penColor & 0xff;\r\n      const a = this.penColor >> 24 & 0xff / 0xff || 1;\r\n      this.penCSS = 'rgba(' + r + ', ' + g + ', ' + b + ', ' + a + ')';\r\n    }\r\n\r\n    /**\r\n     * Convert the pen's color from RGB to HSL\r\n     */\r\n    setPenColorHSL() {\r\n      if (this.penCSS) {\r\n        const hsl = P.utils.rgbToHSL(this.penColor);\r\n        this.penHue = hsl[0];\r\n        this.penSaturation = hsl[1];\r\n        this.penLightness = hsl[2];\r\n        this.penAlpha = this.penColor >> 24 & 0xff / 0xff || 1;\r\n        this.penCSS = '';\r\n      }\r\n    }\r\n\r\n    // Sets a pen color HSL parameter.\r\n    setPenColorParam(param: string, value: number) {\r\n      this.setPenColorHSL();\r\n      switch (param) {\r\n        case 'color':\r\n          this.penHue = value * 360 / 100;\r\n          break;\r\n        case 'saturation':\r\n          this.penSaturation = value;\r\n          break;\r\n        case 'brightness':\r\n          this.penLightness = value % 200;\r\n          if (this.penLightness < 0) {\r\n            this.penLightness += 200;\r\n          }\r\n          break;\r\n        case 'transparency':\r\n          this.penAlpha -= value / 100;\r\n          if (this.penAlpha > 1) this.penAlpha = 1;\r\n          if (this.penAlpha < 0) this.penAlpha = 0;\r\n          break;\r\n      }\r\n    }\r\n\r\n    // Changes a pen color HSL parameter.\r\n    changePenColorParam(param: string, value: number) {\r\n      this.setPenColorHSL();\r\n      switch (param) {\r\n        case 'color':\r\n          this.penHue += value * 360 / 100;\r\n          break;\r\n        case 'saturation':\r\n          this.penSaturation += value;\r\n          break;\r\n        case 'brightness':\r\n          this.penLightness = (this.penLightness + value) % 200;\r\n          if (this.penLightness < 0) {\r\n            this.penLightness += 200;\r\n          }\r\n          break;\r\n        case 'transparency':\r\n          this.penAlpha = Math.max(0, Math.min(1, value / 100));\r\n          break;\r\n      }\r\n    }\r\n  }\r\n\r\n  interface CostumeOptions {\r\n    name: string;\r\n    index: number;\r\n    bitmapResolution: number;\r\n    rotationCenterX: number;\r\n    rotationCenterY: number;\r\n    source: HTMLImageElement | HTMLCanvasElement;\r\n  }\r\n\r\n  // A costume\r\n  export class Costume {\r\n    public name: string;\r\n    public rotationCenterX: number;\r\n    public rotationCenterY: number;\r\n    public image: HTMLImageElement | HTMLCanvasElement;\r\n    public index: number;\r\n    public bitmapResolution: number;\r\n    public scale: number;\r\n\r\n    protected _context: CanvasRenderingContext2D | null;\r\n    \r\n    constructor(costumeData: CostumeOptions) {\r\n      this.index = costumeData.index;\r\n      this.bitmapResolution = costumeData.bitmapResolution;\r\n      this.scale = 1 / this.bitmapResolution;\r\n      this.name = costumeData.name;\r\n\r\n      this.rotationCenterX = costumeData.rotationCenterX;\r\n      this.rotationCenterY = costumeData.rotationCenterY;\r\n\r\n      const source = costumeData.source;\r\n      this.image = source;\r\n      if (source.tagName === 'CANVAS') {\r\n        this._context = (source as HTMLCanvasElement).getContext('2d')!;\r\n      } else {\r\n        this._context = null;\r\n      }\r\n    }\r\n\r\n    context(): CanvasRenderingContext2D {\r\n      if (this._context) {\r\n        return this._context;\r\n      }\r\n\r\n      const canvas = document.createElement('canvas');\r\n      const ctx = canvas.getContext('2d');\r\n      if (!ctx) {\r\n        throw new Error('cannot get 2d rendering context');\r\n      }\r\n      canvas.width = this.image.width;\r\n      canvas.height = this.image.height;\r\n      ctx.drawImage(this.image, 0, 0);\r\n      this._context = ctx;\r\n      return ctx;\r\n    }\r\n  }\r\n\r\n  // A sound\r\n  export class Sound {\r\n    public name: string;\r\n    public buffer: AudioBuffer;\r\n    public duration: number;\r\n    public node: GainNode | null = null;\r\n    public source: AudioBufferSourceNode;\r\n    public target: Base;\r\n\r\n    constructor(data: { name: string; buffer: AudioBuffer; }) {\r\n      this.name = data.name;\r\n      this.buffer = data.buffer;\r\n      this.duration = this.buffer ? this.buffer.duration : 0;\r\n    }\r\n  }\r\n\r\n  export abstract class Watcher {\r\n    public stage: Stage;\r\n    public targetName: string;\r\n    public target: Base;\r\n    public valid: boolean = true;\r\n    public visible: boolean = true;\r\n    public x: number = 0;\r\n    public y: number = 0;\r\n\r\n    constructor(stage: Stage, targetName: string) {\r\n      // The stage this variable watcher belongs to.\r\n      this.stage = stage;\r\n\r\n      // The name of the owner of this watcher, if any.\r\n      this.targetName = targetName;\r\n    }\r\n\r\n    // Initializes the Watcher. Called once.\r\n    // Expected to be overridden.\r\n    init() {\r\n      this.target = this.stage.getObject(this.targetName) || this.stage;\r\n    }\r\n\r\n    // The intended way to change visibility\r\n    setVisible(visible: boolean) {\r\n      this.visible = visible;\r\n    }\r\n\r\n    // Updates the VariableWatcher. Called every frame.\r\n    abstract update(): void;\r\n  }\r\n\r\n  // An abstract callable procedure\r\n  export abstract class Procedure {\r\n    public fn: P.runtime.Fn;\r\n    public warp: boolean;\r\n    public inputs: any[];\r\n\r\n    constructor(fn: runtime.Fn, warp: boolean, inputs: any[]) {\r\n      this.fn = fn;\r\n      this.warp = warp;\r\n      this.inputs = inputs;\r\n    }\r\n\r\n    // Call takes a list of inputs and must return the proper arguments to set C.args to in the runtime.\r\n    // Result can be anything as long as the compiler knows how to interpret it.\r\n    abstract call(inputs: any[]): any;\r\n  }\r\n\r\n  /**\r\n   * Determines if an object is a sprite\r\n   * Can be used to ease type assertions.\r\n   */\r\n  export function isSprite(base: P.core.Base): base is P.core.Sprite {\r\n    return base.isSprite;\r\n  }\r\n}\r\n","/// <reference path=\"phosphorus.ts\" />\r\n\r\nnamespace P.utils {\r\n  // Returns the string representation of an error.\r\n  // TODO: does this need to be here?\r\n  export function stringifyError(error: any): string {\r\n    if (!error) {\r\n      return 'unknown error';\r\n    }\r\n    if (error.stack) {\r\n      return 'Message: ' + error.message + '\\nStack:\\n' + error.stack;\r\n    }\r\n    return error.toString();\r\n  }\r\n\r\n  import RotationStyle = P.core.RotationStyle;\r\n  /**\r\n   * Parses a Scratch rotation style string to a RotationStyle enum\r\n   */\r\n  export function parseRotationStyle(style: string): RotationStyle {\r\n    switch (style) {\r\n      case 'leftRight':\r\n      case 'left-right':\r\n        return RotationStyle.LeftRight;\r\n      case 'none':\r\n      case 'don\\'t rotate':\r\n        return RotationStyle.None;\r\n      case 'normal':\r\n      case 'all around':\r\n        return RotationStyle.Normal;\r\n    }\r\n    console.warn('unknown rotation style', style);\r\n    return RotationStyle.Normal;\r\n  }\r\n\r\n  // Determines the type of a project with its project.json data\r\n  export function projectType(data: unknown): 2 | 3 | null {\r\n    if (typeof data !== 'object' || data === null) {\r\n      return null;\r\n    }\r\n    if ('targets' in data) {\r\n      return 3;\r\n    }\r\n    if ('objName' in data) {\r\n      return 2;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Converts an RGB color to an HSL color\r\n   * @param rgb RGB Color\r\n   */\r\n  export function rgbToHSL(rgb: number): [number, number, number] {\r\n    var r = (rgb >> 16 & 0xff) / 0xff;\r\n    var g = (rgb >> 8 & 0xff) / 0xff;\r\n    var b = (rgb & 0xff) / 0xff;\r\n\r\n    var min = Math.min(r, g, b);\r\n    var max = Math.max(r, g, b);\r\n\r\n    if (min === max) {\r\n      return [0, 0, r * 100];\r\n    }\r\n\r\n    var c = max - min;\r\n    var l = (min + max) / 2;\r\n    var s = c / (1 - Math.abs(2 * l - 1));\r\n\r\n    var h: number;\r\n    switch (max) {\r\n      case r: h = ((g - b) / c + 6) % 6; break;\r\n      case g: h = (b - r) / c + 2; break;\r\n      case b: h = (r - g) / c + 4; break;\r\n    }\r\n    h! *= 60;\r\n\r\n    return [h!, s * 100, l * 100];\r\n  }\r\n\r\n  /**\r\n   * Clamps a number within a range\r\n   * @param number The number\r\n   * @param min Minimum, inclusive\r\n   * @param max Maximum, inclusive\r\n   */\r\n  export function clamp(number: number, min: number, max: number) {\r\n    return Math.min(max, Math.max(min, number));\r\n  }\r\n\r\n  /*\r\n   * Creates a promise that resolves when the original promise resolves or fails.\r\n   */\r\n  export function settled(promise: Promise<any>): Promise<void> {\r\n    return new Promise((resolve, _reject) => {\r\n      promise\r\n        .then(() => resolve())\r\n        .catch(() => resolve());\r\n    });\r\n  }\r\n}\r\n","/// <reference path=\"phosphorus.ts\" />\r\n/// <reference path=\"utils.ts\" />\r\n\r\ninterface FontFaceObserver {\r\n  new(font: string): FontFaceObserver;\r\n  load(text?: string, timeout?: number): Promise<void>;\r\n}\r\ndeclare var FontFaceObserver: FontFaceObserver;\r\n\r\nnamespace P.fonts {\r\n  /**\r\n   * Dynamically load a remote font\r\n   * @param name The name of the font (font-family)\r\n   */\r\n  export function loadFont(name: string): Promise<void> {\r\n    P.IO.progressHooks.new();\r\n    const observer = new FontFaceObserver(name);\r\n    return observer.load().then(() => {\r\n      P.IO.progressHooks.end();\r\n    });\r\n  }\r\n\r\n  var loadedScratch2: boolean = false;\r\n  var loadedScratch3: boolean = false;\r\n\r\n  /**\r\n   * Loads all Scratch 2 associated fonts\r\n   */\r\n  export function loadScratch2(): Promise<void> {\r\n    if (loadedScratch2) {\r\n      return Promise.resolve();\r\n    }\r\n    return Promise.all([\r\n      P.utils.settled(loadFont('Donegal One')),\r\n      P.utils.settled(loadFont('Gloria Hallelujah')),\r\n      P.utils.settled(loadFont('Mystery Quest')),\r\n      P.utils.settled(loadFont('Permanent Marker')),\r\n      P.utils.settled(loadFont('Scratch')),\r\n    ]).then(() => void (loadedScratch2 = true));\r\n  }\r\n\r\n  /**\r\n   * Loads all Scratch 3 associated fonts\r\n   */\r\n  export function loadScratch3(): Promise<void> {\r\n    if (loadedScratch3) {\r\n      return Promise.resolve();\r\n    }\r\n    return Promise.all([\r\n      P.utils.settled(loadFont('Knewave')),\r\n      P.utils.settled(loadFont('Handlee')),\r\n      P.utils.settled(loadFont('Pixel')),\r\n      P.utils.settled(loadFont('Griffy')),\r\n      P.utils.settled(loadFont('Scratch')),\r\n      P.utils.settled(loadFont('Source Serif Pro')),\r\n      P.utils.settled(loadFont('Noto Sans')),\r\n    ]).then(() => void (loadedScratch3 = true));\r\n  }\r\n}\r\n","/// <reference path=\"phosphorus.ts\" />\r\n\r\n// IO helpers and hooks\r\n\r\nnamespace P.IO {\r\n  // Hooks that can be replaced by other scripts to hook into progress reports.\r\n  export const progressHooks = {\r\n    // Indicates that a new task has started\r\n    new() {},\r\n    // Indicates that a task has finished successfully\r\n    end() {},\r\n    // Sets the current progress, should override new() and end()\r\n    set(p) {},\r\n    // Indicates an error has occurred and the project will likely fail to load\r\n    error(error) {},\r\n  };\r\n\r\n  const useLocalFetch: boolean = ['http:', 'https:'].indexOf(location.protocol) > -1;\r\n  const localCORSFallback: string = 'https://forkphorus.github.io';\r\n\r\n  /**\r\n   * Fetch a remote URL\r\n   */\r\n  export function fetchRemote(url: string, opts?: any) {\r\n    progressHooks.new();\r\n    return window.fetch(url, opts)\r\n      .then((r) => {\r\n        progressHooks.end();\r\n        return r;\r\n      })\r\n      .catch((err) => {\r\n        progressHooks.error(err);\r\n        throw err;\r\n      });\r\n  }\r\n\r\n  /**\r\n   * Fetch a local file path, relative to phosphorus.\r\n   */\r\n  export function fetchLocal(path: string, opts?: any) {\r\n    // If for some reason fetching cannot be done locally, route the requests to forkphorus.github.io\r\n    // (where is more likely to be allowed)\r\n    if (!useLocalFetch) {\r\n      path = localCORSFallback + path;\r\n    }\r\n    return fetchRemote(path, opts);\r\n  }\r\n\r\n  /**\r\n   * Read a file as an ArrayBuffer\r\n   */\r\n  export function fileAsArrayBuffer(file: File): Promise<ArrayBuffer> {\r\n    const fileReader = new FileReader();\r\n\r\n    return new Promise((resolve, reject) => {\r\n      fileReader.onloadend = function() {\r\n        resolve(fileReader.result as ArrayBuffer);\r\n      };\r\n\r\n      fileReader.onerror = function(err) {\r\n        reject('Failed to load file');\r\n      };\r\n\r\n      fileReader.onprogress = function(progress) {\r\n        progressHooks.set(progress);\r\n      };\r\n\r\n      fileReader.readAsArrayBuffer(file);\r\n    });\r\n  }\r\n}\r\n","/// <reference path=\"phosphorus.ts\" />\r\n/// <reference path=\"utils.ts\" />\r\n/// <reference path=\"core.ts\" />\r\n/// <reference path=\"fonts.ts\" />\r\n/// <reference path=\"config.ts\" />\r\n\r\nnamespace P.sb2 {\r\n  const ASSET_URL = 'https://cdn.assets.scratch.mit.edu/internalapi/asset/';\r\n  let zipArchive: JSZip.Zip;\r\n\r\n  export class Scratch2VariableWatcher extends P.core.Watcher {\r\n    private cmd: string;\r\n    private type: string;\r\n    private color: string;\r\n    public isDiscrete: boolean;\r\n    private label: string;\r\n    private mode: number;\r\n    public param: string;\r\n    public sliderMax: number;\r\n    public sliderMin: number;\r\n\r\n    private el: HTMLElement;\r\n    private labelEl: HTMLElement;\r\n    private readout: HTMLElement;\r\n    public slider: HTMLElement;\r\n    public button: HTMLElement;\r\n    private buttonWrap: HTMLElement;\r\n\r\n    constructor(stage, targetName, data) {\r\n      super(stage, targetName);\r\n\r\n      this.cmd = data.cmd;\r\n      this.type = data.type || 'var';\r\n      if (data.color) {\r\n        var c = (data.color < 0 ? data.color + 0x1000000 : data.color).toString(16);\r\n        this.color = '#000000'.slice(0, -c.length) + c;\r\n      } else {\r\n        this.color = '#ee7d16';\r\n      }\r\n\r\n      this.isDiscrete = data.isDiscrete == null ? true : data.isDiscrete;\r\n      this.label = data.label || '';\r\n      this.mode = data.mode || 1;\r\n      this.param = data.param;\r\n      this.sliderMax = data.sliderMax == null ? 100 : data.sliderMax;\r\n      this.sliderMin = data.sliderMin || 0;\r\n      this.targetName = data.target;\r\n      this.visible = data.visible == null ? false : data.visible;\r\n      this.x = data.x || 0;\r\n      this.y = data.y || 0;\r\n    }\r\n\r\n    init() {\r\n      super.init();\r\n      if (this.target && this.cmd === 'getVar:') {\r\n        this.target.watchers[this.param] = this;\r\n      }\r\n      if (!this.label) {\r\n        this.label = this.getLabel();\r\n        if (this.target.isSprite) this.label = this.target.name + ': ' + this.label;\r\n      }\r\n      this.layout();\r\n    }\r\n\r\n    getLabel(): string {\r\n      var WATCHER_LABELS = {\r\n        'costumeIndex': 'costume #',\r\n        'xpos': 'x position',\r\n        'ypos': 'y position',\r\n        'heading': 'direction',\r\n        'scale': 'size',\r\n        'backgroundIndex': 'background #',\r\n        'sceneName': 'background name',\r\n        'tempo': 'tempo',\r\n        'volume': 'volume',\r\n        'answer': 'answer',\r\n        'timer': 'timer',\r\n        'soundLevel': 'loudness',\r\n        'isLoud': 'loud?',\r\n        'xScroll': 'x scroll',\r\n        'yScroll': 'y scroll'\r\n      };\r\n      switch (this.cmd) {\r\n        case 'getVar:': return this.param;\r\n        case 'sensor:': return this.param + ' sensor value';\r\n        case 'sensorPressed': return 'sensor ' + this.param + '?';\r\n        case 'timeAndDate': return this.param;\r\n        case 'senseVideoMotion': return 'video ' + this.param;\r\n      }\r\n      return WATCHER_LABELS[this.cmd] || '';\r\n    }\r\n\r\n    setVisible(visible: boolean) {\r\n      super.setVisible(visible);\r\n      this.layout();\r\n    }\r\n\r\n    update() {\r\n      var value: string | number = 0;\r\n      if (!this.target) return;\r\n      switch (this.cmd) {\r\n        case 'answer':\r\n          value = this.stage.answer;\r\n          break;\r\n        case 'backgroundIndex':\r\n          value = this.stage.currentCostumeIndex + 1;\r\n          break;\r\n        case 'costumeIndex':\r\n          value = this.target.currentCostumeIndex + 1;\r\n          break;\r\n        case 'getVar:':\r\n          value = this.target.vars[this.param];\r\n          break;\r\n        case 'heading':\r\n          value = (this.target as P.core.Sprite).direction;\r\n          break;\r\n        case 'scale':\r\n          if (this.target.isSprite) {\r\n            value = (this.target as P.core.Sprite).scale * 100;\r\n          }\r\n          break;\r\n        case 'sceneName':\r\n          value = this.stage.getCostumeName();\r\n          break;\r\n        case 'senseVideoMotion':\r\n          // TODO\r\n          break;\r\n        case 'soundLevel':\r\n          // TODO\r\n          break;\r\n        case 'tempo':\r\n          value = this.stage.tempoBPM;\r\n          break;\r\n        case 'timeAndDate':\r\n          value = this.timeAndDate(this.param);\r\n          break;\r\n        case 'timer':\r\n          value = Math.round((this.stage.runtime.rightNow() - this.stage.runtime.timerStart) / 100) / 10;\r\n          break;\r\n        case 'volume':\r\n          value = this.target.volume * 100;\r\n          break;\r\n        case 'xpos':\r\n          value = this.target.scratchX;\r\n          break;\r\n        case 'ypos':\r\n          value = this.target.scratchY;\r\n          break;\r\n      }\r\n      if (typeof value === 'number' && (value < 0.001 || value > 0.001)) {\r\n        value = Math.round(value * 1000) / 1000;\r\n      }\r\n      this.readout.textContent = '' + value;\r\n      if (this.slider) {\r\n        this.buttonWrap.style.transform = 'translate('+((+value || 0) - this.sliderMin) / (this.sliderMax - this.sliderMin)*100+'%,0)';\r\n      }\r\n    }\r\n\r\n    timeAndDate(format: any): number {\r\n      switch (format) {\r\n        case 'year':\r\n          return new Date().getFullYear();\r\n        case 'month':\r\n          return new Date().getMonth() + 1;\r\n        case 'date':\r\n          return new Date().getDate();\r\n        case 'day of week':\r\n          return new Date().getDay() + 1;\r\n        case 'hour':\r\n          return new Date().getHours();\r\n        case 'minute':\r\n          return new Date().getMinutes();\r\n        case 'second':\r\n          return new Date().getSeconds();\r\n      }\r\n      return 0;\r\n    }\r\n\r\n    layout() {\r\n      if (this.el) {\r\n        this.el.style.display = this.visible ? 'block' : 'none';\r\n        return;\r\n      }\r\n      if (!this.visible) return;\r\n\r\n      this.el = document.createElement('div');\r\n      this.el.dataset.watcher = '' + this.stage.allWatchers.indexOf(this);\r\n      this.el.style.whiteSpace = 'pre';\r\n      this.el.style.position = 'absolute';\r\n      this.el.style.left = this.el.style.top = '0';\r\n      this.el.style.transform = 'translate('+(this.x|0)/10+'em,'+(this.y|0)/10+'em)';\r\n      this.el.style.cursor = 'default';\r\n\r\n      if (this.mode === 2) {\r\n        this.el.appendChild(this.readout = document.createElement('div'));\r\n        this.readout.style.minWidth = (38/15)+'em';\r\n        this.readout.style.font = 'bold 1.5em/'+(19/15)+' sans-serif';\r\n        this.readout.style.height = (19/15)+'em';\r\n        this.readout.style.borderRadius = (4/15)+'em';\r\n        this.readout.style.margin = (3/15)+'em 0 0 0';\r\n        this.readout.style.padding = '0 '+(3/10)+'em';\r\n      } else {\r\n        this.el.appendChild(this.labelEl = document.createElement('div'));\r\n        this.el.appendChild(this.readout = document.createElement('div'));\r\n\r\n        this.el.style.border = '.1em solid rgb(148,145,145)';\r\n        this.el.style.borderRadius = '.4em';\r\n        this.el.style.background = 'rgb(193,196,199)';\r\n        this.el.style.padding = '.2em .6em .3em .5em';\r\n\r\n        this.labelEl.textContent = this.label;\r\n        // this.labelEl.style.marginTop = (1/11)+'em';\r\n        this.labelEl.style.font = 'bold 1.1em/1 sans-serif';\r\n        this.labelEl.style.display = 'inline-block';\r\n\r\n        this.labelEl.style.verticalAlign =\r\n        this.readout.style.verticalAlign = 'middle';\r\n\r\n        this.readout.style.minWidth = (37/10)+'em';\r\n        this.readout.style.padding = '0 '+(1/10)+'em';\r\n        this.readout.style.font = 'bold 1.0em/'+(13/10)+' sans-serif';\r\n        this.readout.style.height = (13/10)+'em';\r\n        this.readout.style.borderRadius = (4/10)+'em';\r\n        this.readout.style.marginLeft = (6/10)+'em';\r\n      }\r\n      this.readout.style.color = '#fff';\r\n      var f = 1 / (this.mode === 2 ? 15 : 10);\r\n      this.readout.style.border = f+'em solid #fff';\r\n      this.readout.style.boxShadow = 'inset '+f+'em '+f+'em '+f+'em rgba(0,0,0,.5), inset -'+f+'em -'+f+'em '+f+'em rgba(255,255,255,.5)';\r\n      this.readout.style.textAlign = 'center';\r\n      this.readout.style.background = this.color;\r\n      this.readout.style.display = 'inline-block';\r\n\r\n      if (this.mode === 3) {\r\n        this.el.appendChild(this.slider = document.createElement('div'));\r\n        this.slider.appendChild(this.buttonWrap = document.createElement('div'));\r\n        this.buttonWrap.appendChild(this.button = document.createElement('div'));\r\n\r\n        this.slider.style.height =\r\n        this.slider.style.borderRadius = '.5em';\r\n        this.slider.style.background = 'rgb(192,192,192)';\r\n        this.slider.style.margin = '.4em 0 .1em';\r\n        this.slider.style.boxShadow = 'inset .125em .125em .125em rgba(0,0,0,.5), inset -.125em -.125em .125em rgba(255,255,255,.5)';\r\n        this.slider.style.position = 'relative';\r\n        this.slider.style.pointerEvents = 'auto';\r\n        this.slider.dataset.slider = '';\r\n\r\n        this.slider.style.paddingRight =\r\n        this.button.style.width =\r\n        this.button.style.height =\r\n        this.button.style.borderRadius = '1.1em';\r\n        this.button.style.position = 'absolute';\r\n        this.button.style.left = '0';\r\n        this.button.style.top = '-.3em';\r\n        this.button.style.background = '#fff';\r\n        this.button.style.boxShadow = 'inset .3em .3em .2em -.2em rgba(255,255,255,.9), inset -.3em -.3em .2em -.2em rgba(0,0,0,.9), inset 0 0 0 .1em #777';\r\n        this.button.dataset.button = '';\r\n      }\r\n\r\n      this.stage.ui.appendChild(this.el);\r\n    }\r\n  }\r\n\r\n  export class Scratch2Stage extends P.core.Stage {\r\n    // Used to tell the compiler what scripts this sprite uses.\r\n    // TODO: should the compiler delete after use?\r\n    public scripts: any;\r\n\r\n    private dragging: any = {};\r\n    private defaultWatcherX = 10;\r\n    private defaultWatcherY = 10;\r\n\r\n    lookupVariable(name: string) {\r\n      return this.vars[name];\r\n    }\r\n\r\n    createVariableWatcher(target: P.core.Base, variableName: string) {\r\n      const x = this.defaultWatcherX;\r\n      const y = this.defaultWatcherY;\r\n\r\n      this.defaultWatcherY += 26;\r\n      if (this.defaultWatcherY >= 450) {\r\n        this.defaultWatcherY = 10;\r\n        this.defaultWatcherX += 150;\r\n      }\r\n\r\n      return new P.sb2.Scratch2VariableWatcher(this, target.name, {\r\n        cmd: 'getVar:',\r\n        param: variableName,\r\n        x,\r\n        y,\r\n      });\r\n    }\r\n\r\n    say(text: string, thinking?: boolean) {\r\n      // Stage cannot say things in Scratch 2.\r\n      return ++this.sayId;\r\n    }\r\n\r\n    updateBubble() {\r\n      // Stage cannot say things in Scratch 2.\r\n    }\r\n\r\n    watcherStart(id, t, e) {\r\n      var p = e.target;\r\n      while (p && p.dataset.watcher == null) p = p.parentElement;\r\n      if (!p) return;\r\n      var w = this.allWatchers[p.dataset.watcher] as P.sb2.Scratch2VariableWatcher;\r\n      this.dragging[id] = {\r\n        watcher: w,\r\n        offset: (e.target.dataset.button == null ? -w.button.offsetWidth / 2 | 0 : w.button.getBoundingClientRect().left - t.clientX) - w.slider.getBoundingClientRect().left\r\n      };\r\n    }\r\n    watcherMove(id, t, e) {\r\n      var d = this.dragging[id];\r\n      if (!d) return;\r\n      var w = d.watcher as P.sb2.Scratch2VariableWatcher;\r\n      var sw = w.slider.offsetWidth;\r\n      var bw = w.button.offsetWidth;\r\n      var value = w.sliderMin + Math.max(0, Math.min(1, (t.clientX + d.offset) / (sw - bw))) * (w.sliderMax - w.sliderMin);\r\n      w.target.vars[w.param] = w.isDiscrete ? Math.round(value) : Math.round(value * 100) / 100;\r\n      w.update();\r\n      e.preventDefault();\r\n    }\r\n    watcherEnd(id, t, e) {\r\n      this.watcherMove(id, t, e);\r\n      delete this.dragging[id];\r\n    }\r\n\r\n    ontouch(event: TouchEvent, touch: Touch) {\r\n      const target = event.target as HTMLElement;\r\n      if (target.dataset.button != null || target.dataset.slider != null) {\r\n        this.watcherStart(touch.identifier, touch, event);\r\n      }\r\n    }\r\n    onmousedown(e: MouseEvent) {\r\n      const target = e.target as HTMLElement;\r\n      if (target.dataset.button != null || target.dataset.slider != null) {\r\n        this.watcherStart('mouse', e, e);\r\n      }\r\n    }\r\n    onmousemove(e: MouseEvent) {\r\n      this.watcherMove('mouse', e, e);\r\n    }\r\n    onmouseup(e: MouseEvent) {\r\n      this.watcherEnd('mouse', e, e);\r\n    }\r\n  }\r\n\r\n  export class Scratch2Sprite extends P.core.Sprite {\r\n    public scripts: any;\r\n\r\n    lookupVariable(name: string): string {\r\n      return this.vars[name];\r\n    }\r\n\r\n    _clone() {\r\n      return new Scratch2Sprite(this.stage);\r\n    }\r\n  }\r\n\r\n  // loads an image from a URL\r\n  export function loadImage(url): Promise<HTMLImageElement> {\r\n    P.IO.progressHooks.new();\r\n\r\n    var image = new Image();\r\n    image.crossOrigin = 'anonymous';\r\n\r\n    return new Promise((resolve, reject) => {\r\n      image.onload = function() {\r\n        P.IO.progressHooks.end();\r\n        resolve(image);\r\n      };\r\n      image.onerror = function(err) {\r\n        reject('Failed to load image: ' + image.src);\r\n      };\r\n      image.src = url;\r\n    });\r\n  }\r\n\r\n  // Loads a .sb2 file from an ArrayBuffer containing the .sb2 file\r\n  export function loadSB2Project(arrayBuffer) {\r\n    return JSZip.loadAsync(arrayBuffer)\r\n      .then((zip) => {\r\n        zipArchive = zip;\r\n        return zip.file('project.json').async('text');\r\n      })\r\n      .then((text: string) => {\r\n        const project = JSON.parse(text);\r\n        return loadProject(project);\r\n      });\r\n  }\r\n\r\n  // Loads a project on the scratch.mit.edu website from its project.json\r\n  export function loadProject(data) {\r\n    var children;\r\n    var stage;\r\n\r\n    return loadFonts()\r\n      .then(() => Promise.all<any>([\r\n        P.audio.loadSoundbank(),\r\n        loadArray(data.children, loadObject).then((c) => children = c),\r\n        loadBase(data, true).then((s) => stage = s),\r\n      ]))\r\n      .then(() => {\r\n        children = children.filter((i) => i);\r\n        children.forEach((c) => c.stage = stage);\r\n        var sprites = children.filter((i) => i instanceof Scratch2Sprite);\r\n        var watchers = children.filter((i) => i instanceof Scratch2VariableWatcher);\r\n\r\n        stage.children = sprites;\r\n        stage.allWatchers = watchers;\r\n        stage.allWatchers.forEach((w) => w.init());\r\n        stage.updateBackdrop();\r\n\r\n        P.sb2.compiler.compile(stage);\r\n        return stage;\r\n      });\r\n  }\r\n\r\n  export function loadBase(data, isStage = false) {\r\n    var costumes;\r\n    var sounds;\r\n\r\n    return Promise.all([\r\n      loadArray(data.costumes, loadCostume).then((c) => costumes = c),\r\n      loadArray(data.sounds, loadSound).then((s) => sounds = s),\r\n    ]).then(() => {\r\n      const variables = {};\r\n      if (data.variables) {\r\n        for (const variable of data.variables) {\r\n          if (variable.isPeristent) {\r\n            throw new Error('Cloud variables are not supported');\r\n          }\r\n          variables[variable.name] = variable.value;\r\n        }\r\n      }\r\n\r\n      const lists = {};\r\n      if (data.lists) {\r\n        for (const list of data.lists) {\r\n          if (list.isPeristent) {\r\n            throw new Error('Cloud lists are not supported');\r\n          }\r\n          lists[list.listName] = list.contents;\r\n        }\r\n      }\r\n\r\n      // Dirty hack to construct a target with a null stage\r\n      const object = new (isStage ? Scratch2Stage : Scratch2Sprite)(null!);\r\n\r\n      object.name = data.objName;\r\n      object.vars = variables;\r\n      object.lists = lists;\r\n      object.costumes = costumes;\r\n      object.currentCostumeIndex = data.currentCostumeIndex;\r\n      sounds.forEach((sound) => sound && object.addSound(sound));\r\n\r\n      if (isStage) {\r\n\r\n      } else {\r\n        const sprite = object as Scratch2Sprite;\r\n        sprite.scratchX = data.scratchX;\r\n        sprite.scratchY = data.scratchY;\r\n        sprite.direction = data.direction;\r\n        sprite.isDraggable = data.isDraggable;\r\n        sprite.rotationStyle = P.utils.parseRotationStyle(data.rotationStyle);\r\n        sprite.scale = data.scale;\r\n        sprite.visible = data.visible;\r\n      }\r\n\r\n      // We store the scripts on the Sprite so the compiler can find them easier\r\n      // TODO: to something different?\r\n      object.scripts = data.scripts || [];\r\n\r\n      return object;\r\n    });\r\n  }\r\n\r\n  // A weird mix of Array.map and Promise.all\r\n  export function loadArray(data, process) {\r\n    return Promise.all((data || []).map((i, ind) => process(i, ind)));\r\n  }\r\n\r\n  export function loadFonts(): Promise<void> {\r\n    return P.fonts.loadScratch2();\r\n  }\r\n\r\n  export function loadObject(data) {\r\n    if (data.cmd) {\r\n      return loadVariableWatcher(data);\r\n    } else if (data.listName) {\r\n      // TODO: list watcher\r\n    } else {\r\n      return loadBase(data);\r\n    }\r\n  }\r\n\r\n  export function loadVariableWatcher(data) {\r\n    const targetName = data.target;\r\n    const watcher = new Scratch2VariableWatcher(null, targetName, data);\r\n    return watcher;\r\n  }\r\n\r\n  export function loadCostume(data, index) {\r\n    const promises = [\r\n      loadMD5(data.baseLayerMD5, data.baseLayerID)\r\n        .then((asset) => data.$image = asset)\r\n    ];\r\n    if (data.textLayerMD5) {\r\n      promises.push(loadMD5(data.textLayerMD5, data.textLayerID)\r\n        .then((asset) => data.$text = asset));\r\n    }\r\n    return Promise.all(promises)\r\n      .then((layers: any[]) => {\r\n        var image;\r\n        if (layers.length > 1) {\r\n          image = document.createElement('canvas');\r\n          const ctx = image.getContext('2d')!;\r\n          image.width = Math.max(layers[0].width, 1);\r\n          image.height = Math.max(layers[0].height, 1);\r\n          for (const layer of layers) {\r\n            ctx.drawImage(layer, 0, 0);\r\n          }\r\n        } else {\r\n          image = layers[0];\r\n        }\r\n\r\n        return new P.core.Costume({\r\n          index: index,\r\n          bitmapResolution: data.bitmapResolution,\r\n          name: data.costumeName,\r\n          rotationCenterX: data.rotationCenterX,\r\n          rotationCenterY: data.rotationCenterY,\r\n          source: image,\r\n        });\r\n      });\r\n  }\r\n\r\n  export function loadSound(data): Promise<P.core.Sound | null> {\r\n    return new Promise((resolve, reject) => {\r\n      loadMD5(data.md5, data.soundID, true)\r\n        .then((buffer) => {\r\n          resolve(new P.core.Sound({\r\n            name: data.soundName,\r\n            buffer,\r\n          }));\r\n        })\r\n        .catch((err) => {\r\n          resolve(null);\r\n          console.warn('Could not load sound: ' + err);\r\n        });\r\n    });\r\n  }\r\n\r\n  export function patchSVG(svg, element) {\r\n    const FONTS: ObjectMap<string> = {\r\n      '': 'Helvetica',\r\n      Donegal: 'Donegal One',\r\n      Gloria: 'Gloria Hallelujah',\r\n      Marker: 'Permanent Marker',\r\n      Mystery: 'Mystery Quest'\r\n    };\r\n\r\n    const LINE_HEIGHTS: ObjectMap<number> = {\r\n      Helvetica: 1.13,\r\n      'Donegal One': 1.25,\r\n      'Gloria Hallelujah': 1.97,\r\n      'Permanent Marker': 1.43,\r\n      'Mystery Quest': 1.37\r\n    };\r\n\r\n    if (element.nodeType !== 1) return;\r\n    if (element.nodeName === 'text') {\r\n      // Correct fonts\r\n      var font = element.getAttribute('font-family') || '';\r\n      font = FONTS[font] || font;\r\n      if (font) {\r\n        element.setAttribute('font-family', font);\r\n        if (font === 'Helvetica') element.style.fontWeight = 'bold';\r\n      }\r\n      var size = +element.getAttribute('font-size');\r\n      if (!size) {\r\n        element.setAttribute('font-size', size = 18);\r\n      }\r\n      var bb = element.getBBox();\r\n      var x = 4 - .6 * element.transform.baseVal.consolidate().matrix.a;\r\n      var y = (element.getAttribute('y') - bb.y) * 1.1;\r\n      element.setAttribute('x', x);\r\n      element.setAttribute('y', y);\r\n      var lines = element.textContent.split('\\n');\r\n      if (lines.length > 1) {\r\n        element.textContent = lines[0];\r\n        var lineHeight = LINE_HEIGHTS[font] || 1;\r\n        for (var i = 1, l = lines.length; i < l; i++) {\r\n          var tspan = document.createElementNS(null, 'tspan');\r\n          tspan.textContent = lines[i];\r\n          tspan.setAttribute('x', '' + x);\r\n          tspan.setAttribute('y', '' + (y + size * i * lineHeight));\r\n          element.appendChild(tspan);\r\n        }\r\n      }\r\n    } else if ((element.hasAttribute('x') || element.hasAttribute('y')) && element.hasAttribute('transform')) {\r\n      element.setAttribute('x', 0);\r\n      element.setAttribute('y', 0);\r\n    }\r\n    [].forEach.call(element.childNodes, patchSVG.bind(null, svg));\r\n  }\r\n\r\n  export function loadSVG(source): Promise<HTMLCanvasElement | HTMLImageElement> {\r\n    // canvg needs and actual SVG element, not the source.\r\n    const parser = new DOMParser();\r\n    var doc = parser.parseFromString(source, 'image/svg+xml');\r\n    var svg = doc.documentElement as any;\r\n    if (!svg.style) {\r\n      doc = parser.parseFromString('<body>' + source, 'text/html');\r\n      svg = doc.querySelector('svg');\r\n    }\r\n    svg.style.visibility = 'hidden';\r\n    svg.style.position = 'absolute';\r\n    svg.style.left = '-10000px';\r\n    svg.style.top = '-10000px';\r\n    document.body.appendChild(svg);\r\n    const viewBox = svg.viewBox.baseVal;\r\n    if (viewBox && (viewBox.x || viewBox.y)) {\r\n      svg.width.baseVal.value = viewBox.width - viewBox.x;\r\n      svg.height.baseVal.value = viewBox.height - viewBox.y;\r\n      viewBox.x = 0;\r\n      viewBox.y = 0;\r\n      viewBox.width = 0;\r\n      viewBox.height = 0;\r\n    }\r\n    patchSVG(svg, svg);\r\n    document.body.removeChild(svg);\r\n    svg.style.visibility = svg.style.position = svg.style.left = svg.style.top = '';\r\n\r\n    // TODO: use native renderer\r\n    return new Promise<HTMLCanvasElement | HTMLImageElement>((resolve, reject) => {\r\n      const canvas = document.createElement('canvas');\r\n      canvg(canvas, new XMLSerializer().serializeToString(svg), {\r\n        ignoreMouse: true,\r\n        ignoreAnimation: true,\r\n        ignoreClear: true,\r\n        renderCallback: function() {\r\n          if (canvas.width === 0 || canvas.height === 0) {\r\n            resolve(new Image());\r\n            return;\r\n          }\r\n          resolve(canvas);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  export function loadMD5(hash: string, id: string, isAudio?: true): Promise<AudioBuffer>;\r\n  export function loadMD5(hash: string, id: string, isAudio?: false): Promise<HTMLImageElement | HTMLCanvasElement | null>;\r\n  export function loadMD5(hash: string, id: string, isAudio: boolean = false): Promise<HTMLImageElement | HTMLCanvasElement | AudioBuffer | null> {\r\n    if (zipArchive) {\r\n      var f = isAudio ? zipArchive.file(id + '.wav') : zipArchive.file(id + '.gif') || zipArchive.file(id + '.png') || zipArchive.file(id + '.jpg') || zipArchive.file(id + '.svg');\r\n      hash = f.name;\r\n    }\r\n\r\n    const ext = hash.split('.').pop();\r\n\r\n    if (ext === 'svg') {\r\n      if (zipArchive) {\r\n        return f!.async('text')\r\n          .then((text) => loadSVG(text));\r\n      } else {\r\n        return P.IO.fetchRemote(ASSET_URL + hash + '/get/')\r\n          .then((request) => request.text())\r\n          .then((text) => loadSVG(text));\r\n      }\r\n    } else if (ext === 'wav') {\r\n      if (zipArchive) {\r\n        return f!.async('arrayBuffer')\r\n          .then((buffer) => P.audio.decodeAudio(buffer));\r\n      } else {\r\n        return P.IO.fetchRemote(ASSET_URL + hash + '/get/')\r\n          .then((request) => request.arrayBuffer())\r\n          .then((buffer) => P.audio.decodeAudio(buffer));\r\n      }\r\n    } else {\r\n      if (zipArchive) {\r\n        return new Promise((resolve, reject) => {\r\n          var image = new Image();\r\n          image.onload = function() {\r\n            resolve(image);\r\n          };\r\n          f.async('binarystring')\r\n            .then((data: string) => {\r\n              image.src = 'data:image/' + (ext === 'jpg' ? 'jpeg' : ext) + ';base64,' + btoa(data);\r\n            });\r\n        });\r\n      } else {\r\n        return loadImage(ASSET_URL + hash + '/get/');\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// Compiler for .sb2 projects\r\nnamespace P.sb2.compiler {\r\n  var LOG_PRIMITIVES;\r\n\r\n  // Implements a Scratch 2 procedure.\r\n  // Scratch 2 argument references just go by index, so its very simple.\r\n  export class Scratch2Procedure extends P.core.Procedure {\r\n    call(inputs) {\r\n      return inputs;\r\n    }\r\n  }\r\n\r\n  var EVENT_SELECTORS = [\r\n    'procDef',\r\n    'whenClicked',\r\n    'whenCloned',\r\n    'whenGreenFlag',\r\n    'whenIReceive',\r\n    'whenKeyPressed',\r\n    'whenSceneStarts',\r\n    'whenSensorGreaterThan' // TODO\r\n  ];\r\n\r\n  var compileScripts = function(object) {\r\n    for (var i = 0; i < object.scripts.length; i++) {\r\n      compileListener(object, object.scripts[i][2]);\r\n    }\r\n  };\r\n\r\n  var warnings;\r\n  var warn = function(message) {\r\n    warnings[message] = (warnings[message] || 0) + 1;\r\n  };\r\n\r\n  export var compileListener = function(object, script) {\r\n    if (!script[0] || EVENT_SELECTORS.indexOf(script[0][0]) === -1) return;\r\n\r\n    var nextLabel = function() {\r\n      return object.fns.length + fns.length;\r\n    };\r\n\r\n    var label = function() {\r\n      var id = nextLabel();\r\n      fns.push(source.length);\r\n      visual = 0;\r\n      return id;\r\n    };\r\n\r\n    var delay = function() {\r\n      source += 'return;\\n';\r\n      label();\r\n    };\r\n\r\n    var queue = function(id) {\r\n      source += 'queue(' + id + ');\\n';\r\n      source += 'return;\\n';\r\n    };\r\n\r\n    var forceQueue = function(id) {\r\n      source += 'forceQueue(' + id + ');\\n';\r\n      source += 'return;\\n';\r\n    };\r\n\r\n    var seq = function(script) {\r\n      if (!script) return;\r\n      for (var i = 0; i < script.length; i++) {\r\n        compile(script[i]);\r\n      }\r\n    };\r\n\r\n    var varRef = function(name) {\r\n      if (typeof name !== 'string') {\r\n        return 'getVars(' + val(name) + ')[' + val(name) + ']';\r\n      }\r\n      var o = object.stage.vars[name] !== undefined ? 'self' : 'S';\r\n      return o + '.vars[' + val(name) + ']';\r\n    };\r\n\r\n    var listRef = function(name) {\r\n      if (typeof name !== 'string') {\r\n        return 'getLists(' + val(name) + ')[' + val(name) + ']';\r\n      }\r\n      var o = object.stage.lists[name] !== undefined ? 'self' : 'S';\r\n      if (o === 'S' && !object.lists[name]) {\r\n        object.lists[name] = [];\r\n      }\r\n      return o + '.lists[' + val(name) + ']';\r\n    };\r\n\r\n    var param = function(name, usenum, usebool) {\r\n      if (typeof name !== 'string') {\r\n        throw new Error('Dynamic parameters are not supported');\r\n      }\r\n\r\n      if (!inputs) return '0';\r\n\r\n      var i = inputs.indexOf(name);\r\n      if (i === -1) {\r\n        return '0';\r\n      }\r\n\r\n      var t = types[i];\r\n      var kind =\r\n        t === '%n' || t === '%d' || t === '%c' ? 'num' :\r\n        t === '%b' ? 'bool' : '';\r\n\r\n      if (kind === 'num' && usenum) {\r\n        used[i] = true;\r\n        return 'C.numargs[' + i + ']';\r\n      }\r\n      if (kind === 'bool' && usebool) {\r\n        used[i] = true;\r\n        return 'C.boolargs[' + i + ']';\r\n      }\r\n\r\n      var v = 'C.args[' + i + ']';\r\n      if (usenum) return '(+' + v + ' || 0)';\r\n      if (usebool) return 'bool(' + v + ')';\r\n      return v;\r\n    };\r\n\r\n    var val2 = function(e) {\r\n      var v;\r\n      if (e[0] === 'costumeName') {\r\n\r\n        return 'S.getCostumeName()';\r\n\r\n      } else if (e[0] === 'sceneName') {\r\n\r\n        return 'self.getCostumeName()';\r\n\r\n      } else if (e[0] === 'readVariable') {\r\n\r\n        return varRef(e[1]);\r\n\r\n      } else if (e[0] === 'contentsOfList:') {\r\n\r\n        return 'contentsOfList(' + listRef(e[1]) + ')';\r\n\r\n      } else if (e[0] === 'getLine:ofList:') {\r\n\r\n        return 'getLineOfList(' + listRef(e[2]) + ', ' + val(e[1]) + ')';\r\n\r\n      } else if (e[0] === 'concatenate:with:') {\r\n\r\n        return '(\"\" + ' + val(e[1]) + ' + ' + val(e[2]) + ')';\r\n\r\n      } else if (e[0] === 'letter:of:') {\r\n\r\n        return '((\"\" + ' + val(e[2]) + ')[(' + num(e[1]) + ' | 0) - 1] || \"\")';\r\n\r\n      } else if (e[0] === 'answer') { /* Sensing */\r\n\r\n        return 'self.answer';\r\n\r\n      } else if (e[0] === 'getAttribute:of:') {\r\n\r\n        return 'attribute(' + val(e[1]) + ', ' + val(e[2]) + ')';\r\n\r\n      } else if (e[0] === 'getUserId') {\r\n\r\n        return '0';\r\n\r\n      } else if (e[0] === 'getUserName') {\r\n\r\n        return 'self.username';\r\n\r\n      } else {\r\n\r\n        warn('Undefined val: ' + e[0]);\r\n\r\n      }\r\n    };\r\n\r\n    var val = function(e, usenum?, usebool?) {\r\n      var v;\r\n\r\n      if (typeof e === 'number' || typeof e === 'boolean') {\r\n\r\n        return '' + e;\r\n\r\n      } else if (typeof e === 'string') {\r\n\r\n        return '\"' + e\r\n          .replace(/\\\\/g, '\\\\\\\\')\r\n          .replace(/\\n/g, '\\\\n')\r\n          .replace(/\\r/g, '\\\\r')\r\n          .replace(/\"/g, '\\\\\"')\r\n          .replace(/\\{/g, '\\\\x7b')\r\n          .replace(/\\}/g, '\\\\x7d') + '\"';\r\n\r\n      } else if (e[0] === 'getParam') {\r\n\r\n        return param(e[1], usenum, usebool);\r\n\r\n      } else if ((v = numval(e)) != null || (v = boolval(e)) != null) {\r\n\r\n        return v;\r\n\r\n      } else {\r\n\r\n        v = val2(e);\r\n        if (usenum) return '(+' + v + ' || 0)';\r\n        if (usebool) return 'bool(' + v + ')';\r\n        return v;\r\n\r\n      }\r\n    };\r\n\r\n    var numval = function(e) {\r\n\r\n      if (e[0] === 'xpos') { /* Motion */\r\n\r\n        return 'S.scratchX';\r\n\r\n      } else if (e[0] === 'ypos') {\r\n\r\n        return 'S.scratchY';\r\n\r\n      } else if (e[0] === 'heading') {\r\n\r\n        return 'S.direction';\r\n\r\n      } else if (e[0] === 'costumeIndex') { /* Looks */\r\n\r\n        return '(S.currentCostumeIndex + 1)';\r\n\r\n      } else if (e[0] === 'backgroundIndex') {\r\n\r\n        return '(self.currentCostumeIndex + 1)';\r\n\r\n      } else if (e[0] === 'scale') {\r\n\r\n        return '(S.scale * 100)';\r\n\r\n      } else if (e[0] === 'volume') { /* Sound */\r\n\r\n        return '(S.volume * 100)';\r\n\r\n      } else if (e[0] === 'tempo') {\r\n\r\n        return 'self.tempoBPM';\r\n\r\n      } else if (e[0] === 'lineCountOfList:') { /* Data */\r\n\r\n        return listRef(e[1]) + '.length';\r\n\r\n      } else if (e[0] === '+') { /* Operators */\r\n\r\n        return '(' + num(e[1]) + ' + ' + num(e[2]) + ' || 0)';\r\n\r\n      } else if (e[0] === '-') {\r\n\r\n        return '(' + num(e[1]) + ' - ' + num(e[2]) + ' || 0)';\r\n\r\n      } else if (e[0] === '*') {\r\n\r\n        return '(' + num(e[1]) + ' * ' + num(e[2]) + ' || 0)';\r\n\r\n      } else if (e[0] === '/') {\r\n\r\n        return '(' + num(e[1]) + ' / ' + num(e[2]) + ' || 0)';\r\n\r\n      } else if (e[0] === 'randomFrom:to:') {\r\n\r\n        return 'random(' + num(e[1]) + ', ' + num(e[2]) + ')';\r\n\r\n      } else if (e[0] === 'abs') {\r\n\r\n        return 'Math.abs(' + num(e[1]) + ')';\r\n\r\n      } else if (e[0] === 'sqrt') {\r\n\r\n        return 'Math.sqrt(' + num(e[1]) + ')';\r\n\r\n      } else if (e[0] === 'stringLength:') {\r\n\r\n        return '(\"\" + ' + val(e[1]) + ').length';\r\n\r\n      } else if (e[0] === '%' || e[0] === '\\\\\\\\') {\r\n\r\n        return 'mod(' + num(e[1]) + ', ' + num(e[2]) + ')';\r\n\r\n      } else if (e[0] === 'rounded') {\r\n\r\n        return 'Math.round(' + num(e[1]) + ')';\r\n\r\n      } else if (e[0] === 'computeFunction:of:') {\r\n\r\n        if (typeof e[1] !== 'object') {\r\n          switch ('' + e[1]) {\r\n            case 'abs':\r\n              return 'Math.abs(' + num(e[2]) + ')';\r\n            case 'floor':\r\n              return 'Math.floor(' + num(e[2]) + ')';\r\n            case 'sqrt':\r\n              return 'Math.sqrt(' + num(e[2]) + ')';\r\n            case 'ceiling':\r\n              return 'Math.ceil(' + num(e[2]) + ')';\r\n            case 'cos':\r\n              return 'Math.cos(' + num(e[2]) + ' * Math.PI / 180)';\r\n            case 'sin':\r\n              return 'Math.sin(' + num(e[2]) + ' * Math.PI / 180)';\r\n            case 'tan':\r\n              return 'Math.tan(' + num(e[2]) + ' * Math.PI / 180)';\r\n            case 'asin':\r\n              return 'Math.asin(' + num(e[2]) + ') * 180 / Math.PI';\r\n            case 'acos':\r\n              return 'Math.acos(' + num(e[2]) + ') * 180 / Math.PI';\r\n            case 'atan':\r\n              return 'Math.atan(' + num(e[2]) + ') * 180 / Math.PI';\r\n            case 'ln':\r\n              return 'Math.log(' + num(e[2]) + ')';\r\n            case 'log':\r\n              return 'Math.log(' + num(e[2]) + ') / Math.LN10';\r\n            case 'e ^':\r\n              return 'Math.exp(' + num(e[2]) + ')';\r\n            case '10 ^':\r\n              return 'Math.exp(' + num(e[2]) + ' * Math.LN10)';\r\n          }\r\n          return '0';\r\n        }\r\n        return 'mathFunc(' + val(e[1]) + ', ' + num(e[2]) + ')';\r\n\r\n      } else if (e[0] === 'mouseX') { /* Sensing */\r\n\r\n        return 'self.mouseX';\r\n\r\n      } else if (e[0] === 'mouseY') {\r\n\r\n        return 'self.mouseY';\r\n\r\n      } else if (e[0] === 'timer') {\r\n\r\n        if (P.config.preciseTimers) {\r\n          return '((runtime.rightNow() - runtime.timerStart) / 1000)';\r\n        } else {\r\n          return '((runtime.now - runtime.timerStart) / 1000)';\r\n        }\r\n\r\n\r\n      } else if (e[0] === 'distanceTo:') {\r\n\r\n        return 'S.distanceTo(' + val(e[1]) + ')';\r\n\r\n      // } else if (e[0] === 'soundLevel') {\r\n\r\n      } else if (e[0] === 'timestamp') {\r\n\r\n        return '((Date.now() - epoch) / 86400000)';\r\n\r\n      } else if (e[0] === 'timeAndDate') {\r\n\r\n        return 'timeAndDate(' + val(e[1]) + ')';\r\n\r\n      // } else if (e[0] === 'sensor:') {\r\n\r\n      }\r\n    };\r\n\r\n    var DIGIT = /\\d/;\r\n    var boolval = function(e) {\r\n\r\n      if (e[0] === 'list:contains:') { /* Data */\r\n\r\n        return 'listContains(' + listRef(e[1]) + ', ' + val(e[2]) + ')';\r\n\r\n      } else if (e[0] === '<' || e[0] === '>') { /* Operators */\r\n\r\n        var less: boolean;\r\n        var x;\r\n        var y;\r\n\r\n        if (typeof e[1] === 'string' && DIGIT.test(e[1]) || typeof e[1] === 'number') {\r\n          less = e[0] === '<';\r\n          x = e[1];\r\n          y = e[2];\r\n        } else if (typeof e[2] === 'string' && DIGIT.test(e[2]) || typeof e[2] === 'number') {\r\n          less = e[0] === '>';\r\n          x = e[2];\r\n          y = e[1];\r\n        }\r\n        var nx = +x;\r\n        if (x == null || nx !== nx) {\r\n          return '(compare(' + val(e[1]) + ', ' + val(e[2]) + ') === ' + (e[0] === '<' ? -1 : 1) + ')';\r\n        }\r\n        return (less! ? 'numLess' : 'numGreater') + '(' + nx + ', ' + val(y) + ')';\r\n\r\n      } else if (e[0] === '=') {\r\n\r\n        if (typeof e[1] === 'string' && DIGIT.test(e[1]) || typeof e[1] === 'number') {\r\n          var x = e[1];\r\n          var y = e[2];\r\n        } else if (typeof e[2] === 'string' && DIGIT.test(e[2]) || typeof e[2] === 'number') {\r\n          var x = e[2];\r\n          var y = e[1];\r\n        }\r\n        var nx = +x;\r\n        if (x == null || nx !== nx) {\r\n          return '(equal(' + val(e[1]) + ', ' + val(e[2]) + '))';\r\n        }\r\n        return '(numEqual(' + nx + ', ' + val(y) + '))';\r\n\r\n      } else if (e[0] === '&') {\r\n\r\n        return '(' + bool(e[1]) + ' && ' + bool(e[2]) + ')';\r\n\r\n      } else if (e[0] === '|') {\r\n\r\n        return '(' + bool(e[1]) + ' || ' + bool(e[2]) + ')';\r\n\r\n      } else if (e[0] === 'not') {\r\n\r\n        return '!' + bool(e[1]) + '';\r\n\r\n      } else if (e[0] === 'mousePressed') { /* Sensing */\r\n\r\n        return 'self.mousePressed';\r\n\r\n      } else if (e[0] === 'touching:') {\r\n\r\n        return 'S.touching(' + val(e[1]) + ')';\r\n\r\n      } else if (e[0] === 'touchingColor:') {\r\n\r\n        return 'S.touchingColor(' + val(e[1]) + ')';\r\n\r\n      } else if (e[0] === 'color:sees:') {\r\n\r\n        return 'S.colorTouchingColor(' + val(e[1]) + ', ' + val(e[2]) + ')';\r\n\r\n      } else if (e[0] === 'keyPressed:') {\r\n\r\n        var v = typeof e[1] === 'object' ?\r\n          'getKeyCode(' + val(e[1]) + ')' : val(P.runtime.getKeyCode(e[1]));\r\n        return '!!self.keys[' + v + ']';\r\n\r\n      // } else if (e[0] === 'isLoud') {\r\n\r\n      // } else if (e[0] === 'sensorPressed:') {\r\n\r\n      }\r\n    };\r\n\r\n    var bool = function(e) {\r\n      if (typeof e === 'boolean') {\r\n        return e;\r\n      }\r\n      if (typeof e === 'number' || typeof e === 'string') {\r\n        return +e !== 0 && e !== '' && e !== 'false';\r\n      }\r\n      var v = boolval(e);\r\n      return v != null ? v : val(e, false, true);\r\n    };\r\n\r\n    var num = function(e) {\r\n      if (typeof e === 'number') {\r\n        return e || 0;\r\n      }\r\n      if (typeof e === 'boolean' || typeof e === 'string') {\r\n        return +e || 0;\r\n      }\r\n      var v = numval(e);\r\n      return v != null ? v : val(e, true);\r\n    };\r\n\r\n    var beatHead = function(dur) {\r\n      source += 'save();\\n';\r\n      source += 'R.start = runtime.now;\\n';\r\n      source += 'R.duration = ' + num(dur) + ' * 60 / self.tempoBPM;\\n';\r\n      source += 'var first = true;\\n';\r\n    };\r\n\r\n    var beatTail = function() {\r\n      var id = label();\r\n      source += 'if (runtime.now - R.start < R.duration * 1000 || first) {\\n';\r\n      source += '  var first;\\n';\r\n      forceQueue(id);\r\n      source += '}\\n';\r\n\r\n      source += 'restore();\\n';\r\n    };\r\n\r\n    var wait = function(dur) {\r\n      source += 'save();\\n';\r\n      source += 'R.start = runtime.now;\\n';\r\n      source += 'R.duration = ' + dur + ';\\n';\r\n      source += 'var first = true;\\n';\r\n\r\n      var id = label();\r\n      source += 'if (runtime.now - R.start < R.duration * 1000 || first) {\\n';\r\n      source += '  var first;\\n';\r\n      forceQueue(id);\r\n      source += '}\\n';\r\n\r\n      source += 'restore();\\n';\r\n    };\r\n\r\n    var noRGB = '';\r\n    noRGB += 'if (S.penCSS) {\\n';\r\n    noRGB += '  var hsl = rgb2hsl(S.penColor & 0xffffff);\\n';\r\n    noRGB += '  S.penHue = hsl[0];\\n';\r\n    noRGB += '  S.penSaturation = hsl[1];\\n';\r\n    noRGB += '  S.penLightness = hsl[2];\\n';\r\n    noRGB += '  S.penCSS = null;';\r\n    noRGB += '}\\n';\r\n\r\n    var visual = 0;\r\n    var compile = function(block) {\r\n      if (LOG_PRIMITIVES) {\r\n        source += 'console.log(' + val(block[0]) + ');\\n';\r\n      }\r\n\r\n      if (['turnRight:', 'turnLeft:', 'heading:', 'pointTowards:', 'setRotationStyle', 'lookLike:', 'nextCostume', 'say:duration:elapsed:from:', 'say:', 'think:duration:elapsed:from:', 'think:', 'changeGraphicEffect:by:', 'setGraphicEffect:to:', 'filterReset', 'changeSizeBy:', 'setSizeTo:', 'comeToFront', 'goBackByLayers:'].indexOf(block[0]) !== -1) {\r\n        if (visual < 2) {\r\n          source += 'if (S.visible) VISUAL = true;\\n';\r\n          visual = 2;\r\n        } else if (P.config.debug) source += '/* visual: 2 */\\n';\r\n      } else if (['forward:', 'gotoX:y:', 'gotoSpriteOrMouse:', 'changeXposBy:', 'xpos:', 'changeYposBy:', 'ypos:', 'bounceOffEdge', 'glideSecs:toX:y:elapsed:from:'].indexOf(block[0]) !== -1) {\r\n        if (visual < 1) {\r\n          source += 'if (S.visible || S.isPenDown) VISUAL = true;\\n';\r\n          visual = 1;\r\n        } else if (P.config.debug) source += '/* visual: 1 */\\n';\r\n      } else if (['showBackground:', 'startScene', 'nextBackground', 'nextScene', 'startSceneAndWait', 'show', 'hide', 'putPenDown', 'stampCostume', 'showVariable:', 'hideVariable:', 'doAsk', 'setVolumeTo:', 'changeVolumeBy:', 'setTempoTo:', 'changeTempoBy:'].indexOf(block[0]) !== -1) {\r\n        if (visual < 3) {\r\n          source += 'VISUAL = true;\\n';\r\n          visual = 3;\r\n        } else if (P.config.debug) source += '/* visual: 3 */\\n';\r\n      }\r\n\r\n      if (block[0] === 'forward:') { /* Motion */\r\n\r\n        source += 'S.forward(' + num(block[1]) + ');\\n';\r\n\r\n      } else if (block[0] === 'turnRight:') {\r\n\r\n        source += 'S.setDirection(S.direction + ' + num(block[1]) + ');\\n';\r\n\r\n      } else if (block[0] === 'turnLeft:') {\r\n\r\n        source += 'S.setDirection(S.direction - ' + num(block[1]) + ');\\n';\r\n\r\n      } else if (block[0] === 'heading:') {\r\n\r\n        source += 'S.setDirection(' + num(block[1]) + ');\\n';\r\n\r\n      } else if (block[0] === 'pointTowards:') {\r\n\r\n        source += 'S.pointTowards(' + val(block[1]) + ');\\n';\r\n\r\n      } else if (block[0] === 'gotoX:y:') {\r\n\r\n        source += 'S.moveTo(' + num(block[1]) + ', ' + num(block[2]) + ');\\n';\r\n\r\n      } else if (block[0] === 'gotoSpriteOrMouse:') {\r\n\r\n        source += 'S.gotoObject(' + val(block[1]) + ');\\n';\r\n\r\n      } else if (block[0] === 'changeXposBy:') {\r\n\r\n        source += 'S.moveTo(S.scratchX + ' + num(block[1]) + ', S.scratchY);\\n';\r\n\r\n      } else if (block[0] === 'xpos:') {\r\n\r\n        source += 'S.moveTo(' + num(block[1]) + ', S.scratchY);\\n';\r\n\r\n      } else if (block[0] === 'changeYposBy:') {\r\n\r\n        source += 'S.moveTo(S.scratchX, S.scratchY + ' + num(block[1]) + ');\\n';\r\n\r\n      } else if (block[0] === 'ypos:') {\r\n\r\n        source += 'S.moveTo(S.scratchX, ' + num(block[1]) + ');\\n';\r\n\r\n      } else if (block[0] === 'bounceOffEdge') {\r\n\r\n        source += 'S.bounceOffEdge();\\n';\r\n\r\n      } else if (block[0] === 'setRotationStyle') {\r\n\r\n        source += 'S.rotationStyle = P.utils.parseRotationStyle(' + val(block[1]) + ');\\n';\r\n\r\n      } else if (block[0] === 'lookLike:') { /* Looks */\r\n\r\n        source += 'S.setCostume(' + val(block[1]) + ');\\n';\r\n\r\n      } else if (block[0] === 'nextCostume') {\r\n\r\n        source += 'S.showNextCostume();\\n';\r\n\r\n      } else if (block[0] === 'showBackground:' ||\r\n                 block[0] === 'startScene') {\r\n\r\n        source += 'self.setCostume(' + val(block[1]) + ');\\n';\r\n        source += 'var threads = sceneChange();\\n';\r\n        source += 'if (threads.indexOf(BASE) !== -1) {return;}\\n';\r\n\r\n      } else if (block[0] === 'nextBackground' ||\r\n                 block[0] === 'nextScene') {\r\n\r\n        source += 'S.showNextCostume();\\n';\r\n        source += 'var threads = sceneChange();\\n';\r\n        source += 'if (threads.indexOf(BASE) !== -1) {return;}\\n';\r\n\r\n      } else if (block[0] === 'startSceneAndWait') {\r\n\r\n        source += 'save();\\n';\r\n        source += 'self.setCostume(' + val(block[1]) + ');\\n';\r\n        source += 'R.threads = sceneChange();\\n';\r\n        source += 'if (R.threads.indexOf(BASE) !== -1) {return;}\\n';\r\n        var id = label();\r\n        source += 'if (!running(R.threads)) {\\n';\r\n        forceQueue(id);\r\n        source += '}\\n';\r\n        source += 'restore();\\n';\r\n\r\n      } else if (block[0] === 'say:duration:elapsed:from:') {\r\n\r\n        source += 'save();\\n';\r\n        source += 'R.id = S.say(' + val(block[1]) + ', false);\\n';\r\n        source += 'R.start = runtime.now;\\n';\r\n        source += 'R.duration = ' + num(block[2]) + ';\\n';\r\n\r\n        var id = label();\r\n        source += 'if (runtime.now - R.start < R.duration * 1000) {\\n';\r\n        forceQueue(id);\r\n        source += '}\\n';\r\n\r\n        source += 'if (S.sayId === R.id) {\\n';\r\n        source += '  S.say(\"\");\\n';\r\n        source += '}\\n';\r\n        source += 'restore();\\n';\r\n\r\n      } else if (block[0] === 'say:') {\r\n\r\n        source += 'S.say(' + val(block[1]) + ', false);\\n';\r\n\r\n      } else if (block[0] === 'think:duration:elapsed:from:') {\r\n\r\n        source += 'save();\\n';\r\n        source += 'R.id = S.say(' + val(block[1]) + ', true);\\n';\r\n        source += 'R.start = runtime.now;\\n';\r\n        source += 'R.duration = ' + num(block[2]) + ';\\n';\r\n\r\n        var id = label();\r\n        source += 'if (runtime.now - R.start < R.duration * 1000) {\\n';\r\n        forceQueue(id);\r\n        source += '}\\n';\r\n\r\n        source += 'if (S.sayId === R.id) {\\n';\r\n        source += '  S.say(\"\");\\n';\r\n        source += '}\\n';\r\n        source += 'restore();\\n';\r\n\r\n      } else if (block[0] === 'think:') {\r\n\r\n        source += 'S.say(' + val(block[1]) + ', true);\\n';\r\n\r\n      } else if (block[0] === 'changeGraphicEffect:by:') {\r\n\r\n        source += 'S.changeFilter(' + val(block[1]) + ', ' + num(block[2]) + ');\\n';\r\n\r\n      } else if (block[0] === 'setGraphicEffect:to:') {\r\n\r\n        source += 'S.setFilter(' + val(block[1]) + ', ' + num(block[2]) + ');\\n';\r\n\r\n      } else if (block[0] === 'filterReset') {\r\n\r\n        source += 'S.resetFilters();\\n';\r\n\r\n      } else if (block[0] === 'changeSizeBy:') {\r\n\r\n        source += 'var f = S.scale + ' + num(block[1]) + ' / 100;\\n';\r\n        source += 'S.scale = f < 0 ? 0 : f;\\n';\r\n\r\n      } else if (block[0] === 'setSizeTo:') {\r\n\r\n        source += 'var f = ' + num(block[1]) + ' / 100;\\n';\r\n        source += 'S.scale = f < 0 ? 0 : f;\\n';\r\n\r\n      } else if (block[0] === 'show') {\r\n\r\n        source += 'S.visible = true;\\n';\r\n        source += 'if (S.saying) S.updateBubble();\\n';\r\n\r\n      } else if (block[0] === 'hide') {\r\n\r\n        source += 'S.visible = false;\\n';\r\n        source += 'if (S.saying) S.updateBubble();\\n';\r\n\r\n      } else if (block[0] === 'comeToFront') {\r\n\r\n        source += 'var i = self.children.indexOf(S);\\n';\r\n        source += 'if (i !== -1) self.children.splice(i, 1);\\n';\r\n        source += 'self.children.push(S);\\n';\r\n\r\n      } else if (block[0] === 'goBackByLayers:') {\r\n\r\n        source += 'var i = self.children.indexOf(S);\\n';\r\n        source += 'if (i !== -1) {\\n';\r\n        source += '  self.children.splice(i, 1);\\n';\r\n        source += '  self.children.splice(Math.max(0, i - ' + num(block[1]) + '), 0, S);\\n';\r\n        source += '}\\n';\r\n\r\n      // } else if (block[0] === 'setVideoState') {\r\n\r\n      // } else if (block[0] === 'setVideoTransparency') {\r\n\r\n      } else if (block[0] === 'playSound:') { /* Sound */\r\n\r\n        if (P.audio.context) {\r\n          source += 'var sound = S.getSound(' + val(block[1]) + ');\\n';\r\n          source += 'if (sound) playSound(sound);\\n';\r\n        }\r\n\r\n      } else if (block[0] === 'doPlaySoundAndWait') {\r\n\r\n        if (P.audio.context) {\r\n          source += 'var sound = S.getSound(' + val(block[1]) + ');\\n';\r\n          source += 'if (sound) {\\n';\r\n          source += '  playSound(sound);\\n';\r\n          wait('sound.duration');\r\n          source += '}\\n';\r\n        }\r\n\r\n      } else if (block[0] === 'stopAllSounds') {\r\n\r\n        if (P.audio.context) {\r\n          source += 'self.stopAllSounds();\\n';\r\n        }\r\n\r\n      // } else if (block[0] === 'drum:duration:elapsed:from:') {\r\n\r\n      } else if (block[0] === 'playDrum') {\r\n\r\n        beatHead(block[2]);\r\n        if (P.audio.context) {\r\n          source += 'playSpan(DRUMS[Math.round(' + num(block[1]) + ') - 1] || DRUMS[2], 60, 10);\\n';\r\n        }\r\n        beatTail();\r\n\r\n      } else if (block[0] === 'rest:elapsed:from:') {\r\n\r\n        beatHead(block[1]);\r\n        beatTail();\r\n\r\n      } else if (block[0] === 'noteOn:duration:elapsed:from:') {\r\n\r\n        beatHead(block[2]);\r\n        if (P.audio.context) {\r\n          source += 'playNote(' + num(block[1]) + ', R.duration);\\n';\r\n        }\r\n        beatTail();\r\n\r\n      // } else if (block[0] === 'midiInstrument:') {\r\n\r\n      } else if (block[0] === 'instrument:') {\r\n\r\n        source += 'S.instrument = Math.max(0, Math.min(INSTRUMENTS.length - 1, ' + num(block[1]) + ' - 1)) | 0;';\r\n\r\n      } else if (block[0] === 'changeVolumeBy:' || block[0] === 'setVolumeTo:') {\r\n\r\n        source += 'S.volume = Math.min(1, Math.max(0, ' + (block[0] === 'changeVolumeBy:' ? 'S.volume + ' : '') + num(block[1]) + ' / 100));\\n';\r\n        source += 'if (S.node) S.node.gain.setValueAtTime(S.volume, audioContext.currentTime);\\n';\r\n        source += 'for (var sounds = S.sounds, i = sounds.length; i--;) {\\n';\r\n        source += '  var sound = sounds[i];\\n';\r\n        source += '  if (sound.node && sound.target === S) {\\n';\r\n        source += '    sound.node.gain.setValueAtTime(S.volume, audioContext.currentTime);\\n';\r\n        source += '  }\\n';\r\n        source += '}\\n';\r\n\r\n      } else if (block[0] === 'changeTempoBy:') {\r\n\r\n        source += 'self.tempoBPM += ' + num(block[1]) + ';\\n';\r\n\r\n      } else if (block[0] === 'setTempoTo:') {\r\n\r\n        source += 'self.tempoBPM = ' + num(block[1]) + ';\\n';\r\n\r\n      } else if (block[0] === 'clearPenTrails') { /* Pen */\r\n\r\n        source += 'self.clearPen();\\n';\r\n\r\n      } else if (block[0] === 'putPenDown') {\r\n\r\n        source += 'S.isPenDown = true;\\n';\r\n        source += 'S.dotPen();\\n';\r\n\r\n      } else if (block[0] === 'putPenUp') {\r\n\r\n        source += 'S.isPenDown = false;\\n';\r\n\r\n      } else if (block[0] === 'penColor:') {\r\n\r\n        source += 'var c = ' + num(block[1]) + ';\\n';\r\n        source += 'S.penColor = c;\\n';\r\n        source += 'var a = (c >> 24 & 0xff) / 0xff;\\n';\r\n        source += 'S.penCSS = \"rgba(\" + (c >> 16 & 0xff) + \",\" + (c >> 8 & 0xff) + \",\" + (c & 0xff) + \", \" + (a || 1) + \")\";\\n';\r\n\r\n      } else if (block[0] === 'setPenHueTo:') {\r\n\r\n        source += noRGB;\r\n        source += 'S.penHue = ' + num(block[1]) + ' * 360 / 200;\\n';\r\n        source += 'S.penSaturation = 100;\\n';\r\n\r\n      } else if (block[0] === 'changePenHueBy:') {\r\n\r\n        source += noRGB;\r\n        source += 'S.penHue += ' + num(block[1]) + ' * 360 / 200;\\n';\r\n        source += 'S.penSaturation = 100;\\n';\r\n\r\n      } else if (block[0] === 'setPenShadeTo:') {\r\n\r\n        source += noRGB;\r\n        source += 'S.penLightness = ' + num(block[1]) + ' % 200;\\n';\r\n        source += 'if (S.penLightness < 0) S.penLightness += 200;\\n';\r\n        source += 'S.penSaturation = 100;\\n';\r\n\r\n      } else if (block[0] === 'changePenShadeBy:') {\r\n\r\n        source += noRGB;\r\n        source += 'S.penLightness = (S.penLightness + ' + num(block[1]) + ') % 200;\\n';\r\n        source += 'if (S.penLightness < 0) S.penLightness += 200;\\n';\r\n        source += 'S.penSaturation = 100;\\n';\r\n\r\n      } else if (block[0] === 'penSize:') {\r\n\r\n        source += 'var f = ' + num(block[1]) + ';\\n';\r\n        source += 'S.penSize = f < 1 ? 1 : f;\\n';\r\n\r\n      } else if (block[0] === 'changePenSizeBy:') {\r\n\r\n        source += 'var f = S.penSize + ' + num(block[1]) + ';\\n';\r\n        source += 'S.penSize = f < 1 ? 1 : f;\\n';\r\n\r\n      } else if (block[0] === 'stampCostume') {\r\n\r\n        source += 'S.stamp();\\n';\r\n\r\n      } else if (block[0] === 'setVar:to:') { /* Data */\r\n\r\n        source += varRef(block[1]) + ' = ' + val(block[2]) + ';\\n';\r\n\r\n      } else if (block[0] === 'changeVar:by:') {\r\n\r\n        var ref = varRef(block[1]);\r\n        source += ref + ' = (+' + ref + ' || 0) + ' + num(block[2]) + ';\\n';\r\n\r\n      } else if (block[0] === 'append:toList:') {\r\n\r\n        source += 'appendToList(' + listRef(block[2]) + ', ' + val(block[1]) + ');\\n';\r\n\r\n      } else if (block[0] === 'deleteLine:ofList:') {\r\n\r\n        source += 'deleteLineOfList(' + listRef(block[2]) + ', ' + val(block[1]) + ');\\n';\r\n\r\n      } else if (block[0] === 'insert:at:ofList:') {\r\n\r\n        source += 'insertInList(' + listRef(block[3]) + ', ' + val(block[2]) + ', '+ val(block[1]) + ');\\n';\r\n\r\n      } else if (block[0] === 'setLine:ofList:to:') {\r\n\r\n        source += 'setLineOfList(' + listRef(block[2]) + ', ' + val(block[1]) + ', '+ val(block[3]) + ');\\n';\r\n\r\n      } else if (block[0] === 'showVariable:' || block[0] === 'hideVariable:') {\r\n\r\n        var isShow = block[0] === 'showVariable:';\r\n        if (typeof block[1] !== 'string') {\r\n          throw new Error('Dynamic variables are not supported');\r\n        }\r\n        var o = object.vars[block[1]] !== undefined ? 'S' : 'self';\r\n        source += o + '.showVariable(' + val(block[1]) + ', ' + isShow + ');\\n';\r\n\r\n      // } else if (block[0] === 'showList:') {\r\n\r\n      // } else if (block[0] === 'hideList:') {\r\n\r\n      } else if (block[0] === 'broadcast:') { /* Control */\r\n\r\n        source += 'var threads = broadcast(' + val(block[1]) + ');\\n';\r\n        source += 'if (threads.indexOf(BASE) !== -1) {return;}\\n';\r\n\r\n      } else if (block[0] === 'call') {\r\n\r\n        if (P.config.debug && block[1] === 'phosphorus: debug') {\r\n          source += 'debugger;\\n';\r\n        } else {\r\n          source += 'call(S.procedures[' + val(block[1]) + '], ' + nextLabel() + ', [';\r\n          for (var i = 2; i < block.length; i++) {\r\n            if (i > 2) {\r\n              source += ', ';\r\n            }\r\n            source += val(block[i]);\r\n          }\r\n          source += ']);\\n';\r\n          delay();\r\n        }\r\n\r\n      } else if (block[0] === 'doBroadcastAndWait') {\r\n\r\n        source += 'save();\\n';\r\n        source += 'R.threads = broadcast(' + val(block[1]) + ');\\n';\r\n        source += 'if (R.threads.indexOf(BASE) !== -1) {return;}\\n';\r\n        var id = label();\r\n        source += 'if (running(R.threads)) {\\n';\r\n        forceQueue(id);\r\n        source += '}\\n';\r\n        source += 'restore();\\n';\r\n\r\n      } else if (block[0] === 'doForever') {\r\n\r\n        var id = label();\r\n        seq(block[1]);\r\n        forceQueue(id);\r\n\r\n      } else if (block[0] === 'doForeverIf') {\r\n\r\n        var id = label();\r\n\r\n        source += 'if (' + bool(block[1]) + ') {\\n';\r\n        seq(block[2]);\r\n        source += '}\\n';\r\n\r\n        forceQueue(id);\r\n\r\n      // } else if (block[0] === 'doForLoop') {\r\n\r\n      } else if (block[0] === 'doIf') {\r\n\r\n        source += 'if (' + bool(block[1]) + ') {\\n';\r\n        seq(block[2]);\r\n        source += '}\\n';\r\n\r\n      } else if (block[0] === 'doIfElse') {\r\n\r\n        source += 'if (' + bool(block[1]) + ') {\\n';\r\n        seq(block[2]);\r\n        source += '} else {\\n';\r\n        seq(block[3]);\r\n        source += '}\\n';\r\n\r\n      } else if (block[0] === 'doRepeat') {\r\n\r\n        source += 'save();\\n';\r\n        source += 'R.count = ' + num(block[1]) + ';\\n';\r\n\r\n        var id = label();\r\n\r\n        source += 'if (R.count >= 0.5) {\\n';\r\n        source += '  R.count -= 1;\\n';\r\n        seq(block[2]);\r\n        queue(id);\r\n        source += '} else {\\n';\r\n        source += '  restore();\\n';\r\n        source += '}\\n';\r\n\r\n      } else if (block[0] === 'doReturn') {\r\n\r\n        source += 'endCall();\\n';\r\n        source += 'return;\\n';\r\n\r\n      } else if (block[0] === 'doUntil') {\r\n\r\n        var id = label();\r\n        source += 'if (!' + bool(block[1]) + ') {\\n';\r\n        seq(block[2]);\r\n        queue(id);\r\n        source += '}\\n';\r\n\r\n      } else if (block[0] === 'doWhile') {\r\n\r\n        var id = label();\r\n        source += 'if (' + bool(block[1]) + ') {\\n';\r\n        seq(block[2]);\r\n        queue(id);\r\n        source += '}\\n';\r\n\r\n      } else if (block[0] === 'doWaitUntil') {\r\n\r\n        var id = label();\r\n        source += 'if (!' + bool(block[1]) + ') {\\n';\r\n        queue(id);\r\n        source += '}\\n';\r\n\r\n      } else if (block[0] === 'glideSecs:toX:y:elapsed:from:') {\r\n\r\n        source += 'save();\\n';\r\n        source += 'R.start = runtime.now;\\n';\r\n        source += 'R.duration = ' + num(block[1]) + ';\\n';\r\n        source += 'R.baseX = S.scratchX;\\n';\r\n        source += 'R.baseY = S.scratchY;\\n';\r\n        source += 'R.deltaX = ' + num(block[2]) + ' - S.scratchX;\\n';\r\n        source += 'R.deltaY = ' + num(block[3]) + ' - S.scratchY;\\n';\r\n\r\n        var id = label();\r\n        source += 'var f = (runtime.now - R.start) / (R.duration * 1000);\\n';\r\n        source += 'if (f > 1 || isNaN(f)) f = 1;\\n';\r\n        source += 'S.moveTo(R.baseX + f * R.deltaX, R.baseY + f * R.deltaY);\\n';\r\n\r\n        source += 'if (f < 1) {\\n';\r\n        forceQueue(id);\r\n        source += '}\\n';\r\n        source += 'restore();\\n';\r\n\r\n      } else if (block[0] === 'stopAll') {\r\n\r\n        source += 'runtime.stopAll();\\n';\r\n        source += 'return;\\n';\r\n\r\n      } else if (block[0] === 'stopScripts') {\r\n\r\n        source += 'switch (' + val(block[1]) + ') {\\n';\r\n        source += '  case \"all\":\\n';\r\n        source += '    runtime.stopAll();\\n';\r\n        source += '    return;\\n';\r\n        source += '  case \"this script\":\\n';\r\n        source += '    endCall();\\n';\r\n        source += '    return;\\n';\r\n        source += '  case \"other scripts in sprite\":\\n';\r\n        source += '  case \"other scripts in stage\":\\n';\r\n        source += '    for (var i = 0; i < runtime.queue.length; i++) {\\n';\r\n        source += '      if (i !== THREAD && runtime.queue[i] && runtime.queue[i].sprite === S) {\\n';\r\n        source += '        runtime.queue[i] = undefined;\\n';\r\n        source += '      }\\n';\r\n        source += '    }\\n';\r\n        source += '    break;\\n';\r\n        source += '}\\n';\r\n\r\n      } else if (block[0] === 'wait:elapsed:from:') {\r\n\r\n        wait(num(block[1]));\r\n\r\n      } else if (block[0] === 'warpSpeed') {\r\n\r\n        source += 'WARP++;\\n';\r\n        seq(block[1]);\r\n        source += 'WARP--;\\n';\r\n\r\n      } else if (block[0] === 'createCloneOf') {\r\n\r\n        source += 'clone(' + val(block[1]) + ');\\n';\r\n\r\n      } else if (block[0] === 'deleteClone') {\r\n\r\n        source += 'if (S.isClone) {\\n';\r\n        source += '  S.remove();\\n';\r\n        source += '  var i = self.children.indexOf(S);\\n';\r\n        source += '  if (i !== -1) self.children.splice(i, 1);\\n';\r\n        source += '  for (var i = 0; i < runtime.queue.length; i++) {\\n';\r\n        source += '    if (runtime.queue[i] && runtime.queue[i].sprite === S) {\\n';\r\n        source += '      runtime.queue[i] = undefined;\\n';\r\n        source += '    }\\n';\r\n        source += '  }\\n';\r\n        source += '  return;\\n';\r\n        source += '}\\n';\r\n\r\n      } else if (block[0] === 'doAsk') { /* Sensing */\r\n\r\n        source += 'R.id = self.nextPromptId++;\\n';\r\n\r\n        var id = label();\r\n        source += 'if (self.promptId < R.id) {\\n';\r\n        forceQueue(id);\r\n        source += '}\\n';\r\n\r\n        source += 'S.ask(' + val(block[1]) + ');\\n';\r\n\r\n        var id = label();\r\n        source += 'if (self.promptId === R.id) {\\n';\r\n        forceQueue(id);\r\n        source += '}\\n';\r\n\r\n      } else if (block[0] === 'timerReset') {\r\n\r\n        source += 'runtime.timerStart = runtime.now;\\n';\r\n\r\n      } else {\r\n\r\n        warn('Undefined command: ' + block[0]);\r\n\r\n      }\r\n    };\r\n\r\n    var source = '';\r\n    var startfn = object.fns.length;\r\n    var fns = [0];\r\n\r\n    if (script[0][0] === 'procDef') {\r\n      var inputs = script[0][2];\r\n      var types = script[0][1].match(/%[snmdcb]/g) || [];\r\n      var used: boolean[] = [];\r\n    }\r\n\r\n    for (let i = 1; i < script.length; i++) {\r\n      compile(script[i]);\r\n    }\r\n\r\n    if (script[0][0] === 'procDef') {\r\n      let pre = '';\r\n      for (let i = types.length; i--;) {\r\n        // We know `used` is defined at this point, but typescript doesn't.\r\n        if (used![i]) {\r\n          const t = types[i];\r\n          if (t === '%d' || t === '%n' || t === '%c') {\r\n            pre += 'C.numargs[' + i + '] = +C.args[' + i + '] || 0;\\n';\r\n          } else if (t === '%b') {\r\n            pre += 'C.boolargs[' + i + '] = bool(C.args[' + i + ']);\\n';\r\n          }\r\n        }\r\n      }\r\n      source = pre + source;\r\n      for (let i = 1, l = fns.length; i < l; ++i) {\r\n        fns[i] += pre.length;\r\n      }\r\n      source += 'endCall();\\n';\r\n      source += 'return;\\n';\r\n    }\r\n\r\n    for (let i = 0; i < fns.length; i++) {\r\n      object.fns.push(P.runtime.createContinuation(source.slice(fns[i])));\r\n    }\r\n\r\n    var f = object.fns[startfn];\r\n\r\n    if (script[0][0] === 'whenClicked') {\r\n      object.listeners.whenClicked.push(f);\r\n    } else if (script[0][0] === 'whenGreenFlag') {\r\n      object.listeners.whenGreenFlag.push(f);\r\n    } else if (script[0][0] === 'whenCloned') {\r\n      object.listeners.whenCloned.push(f);\r\n    } else if (script[0][0] === 'whenIReceive') {\r\n      var key = script[0][1].toLowerCase();\r\n      (object.listeners.whenIReceive[key] || (object.listeners.whenIReceive[key] = [])).push(f);\r\n    } else if (script[0][0] === 'whenKeyPressed') {\r\n      if (script[0][1] === 'any') {\r\n        for (var i = 128; i--;) {\r\n          object.listeners.whenKeyPressed[i].push(f);\r\n        }\r\n      } else {\r\n        object.listeners.whenKeyPressed[P.runtime.getKeyCode(script[0][1])].push(f);\r\n      }\r\n    } else if (script[0][0] === 'whenSceneStarts') {\r\n      var key = script[0][1].toLowerCase();\r\n      (object.listeners.whenSceneStarts[key] || (object.listeners.whenSceneStarts[key] = [])).push(f);\r\n    } else if (script[0][0] === 'procDef') {\r\n      const warp = script[0][4];\r\n      object.procedures[script[0][1]] = new Scratch2Procedure(f, warp, inputs);\r\n    } else {\r\n      warn('Undefined event: ' + script[0][0]);\r\n    }\r\n\r\n    if (P.config.debug) {\r\n      var variant = script[0][0];\r\n      if (variant === 'procDef') {\r\n        variant += ':' + script[0][1];\r\n      }\r\n      console.log('compiled sb2 script', variant, source);\r\n    }\r\n  };\r\n\r\n  export function compile(stage) {\r\n    warnings = Object.create(null);\r\n\r\n    compileScripts(stage);\r\n    for (var i = 0; i < stage.children.length; i++) {\r\n      compileScripts(stage.children[i]);\r\n    }\r\n\r\n    for (var key in warnings) {\r\n      console.warn(key + (warnings[key] > 1 ? ' (repeated ' + warnings[key] + ' times)' : ''));\r\n    }\r\n  }\r\n}\r\n","/// <reference path=\"phosphorus.ts\" />\r\n/// <reference path=\"sb2.ts\" />\r\n/// <reference path=\"core.ts\" />\r\n/// <reference path=\"audio.ts\" />\r\n\r\n// TODO: remove sb2 dependence\r\n\r\n// The phosphorus Scratch runtime\r\n// Provides methods expected at runtime by scripts created by the compiler and an environment for Scratch scripts to run\r\nnamespace P.runtime {\r\n  export type Fn = () => void;\r\n\r\n  // The runtime is really weird and hard to understand.\r\n  // The upside: it's fast as hell.\r\n\r\n  // Global variables expected by scripts at runtime:\r\n  // Current runtime\r\n  var runtime: Runtime;\r\n  // Current stage\r\n  var self: P.core.Stage;\r\n  // Current sprite or stage\r\n  var S: P.core.Base;\r\n  // Current thread state.\r\n  var R;\r\n  // Stack of states (R) for this thread\r\n  var STACK;\r\n  // Current procedure call, if any. Contains arguments.\r\n  var C: ThreadCall;\r\n  // This thread's call (C) stack\r\n  var CALLS;\r\n  // If level of layers of \"Run without screen refresh\" we are in\r\n  // Each level (usually procedures) of depth will increment and decrement as they start and stop.\r\n  // As long as this is greater than 0, functions will run without waiting for the screen.\r\n  var WARP: number;\r\n  // ??\r\n  var BASE;\r\n  // The ID of the active thread in the Runtime's queue\r\n  var THREAD: number;\r\n  // The next function to run immediately after this one.\r\n  var IMMEDIATE: Fn | null | undefined;\r\n  // Has a \"visual change\" been made in this frame?\r\n  var VISUAL: boolean;\r\n\r\n  const epoch = Date.UTC(2000, 0, 1);\r\n  const INSTRUMENTS = P.audio.instruments;\r\n  const DRUMS = P.audio.drums;\r\n  const DIGIT = /\\d/;\r\n\r\n  // Converts a value to its boolean equivalent\r\n  var bool = function(v) {\r\n    return +v !== 0 && v !== '' && v !== 'false' && v !== false;\r\n  };\r\n\r\n  // Compares two values. Returns -1 if x < y, 1 if x > y, 0 if x === y\r\n  var compare = function(x, y) {\r\n    if ((typeof x === 'number' || DIGIT.test(x)) && (typeof y === 'number' || DIGIT.test(y))) {\r\n      var nx = +x;\r\n      var ny = +y;\r\n      if (nx === nx && ny === ny) {\r\n        return nx < ny ? -1 : nx === ny ? 0 : 1;\r\n      }\r\n    }\r\n    var xs = ('' + x).toLowerCase();\r\n    var ys = ('' + y).toLowerCase();\r\n    return xs < ys ? -1 : xs === ys ? 0 : 1;\r\n  };\r\n\r\n  // Determines if y is less than nx\r\n  var numLess = function(nx, y) {\r\n    if (typeof y === 'number' || DIGIT.test(y)) {\r\n      var ny = +y;\r\n      if (ny === ny) {\r\n        return nx < ny;\r\n      }\r\n    }\r\n    var ys = ('' + y).toLowerCase();\r\n    return '' + nx < ys;\r\n  };\r\n\r\n  // Determines if y is greater than nx\r\n  var numGreater = function(nx, y) {\r\n    if (typeof y === 'number' || DIGIT.test(y)) {\r\n      var ny = +y;\r\n      if (ny === ny) {\r\n        return nx > ny;\r\n      }\r\n    }\r\n    var ys = ('' + y).toLowerCase();\r\n    return '' + nx > ys;\r\n  };\r\n\r\n  // Determines if x is equal to y\r\n  var equal = function(x, y) {\r\n    // numbers, booleans, and strings that look like numbers will go through the number comparison\r\n    if ((typeof x === 'number' || typeof x === 'boolean' || DIGIT.test(x)) && (typeof y === 'number' || typeof x === 'boolean' || DIGIT.test(y))) {\r\n      var nx = +x;\r\n      var ny = +y;\r\n      // if either is NaN, don't do the comparison\r\n      if (nx === nx && ny === ny) {\r\n        return nx === ny;\r\n      }\r\n    }\r\n    var xs = ('' + x).toLowerCase();\r\n    var ys = ('' + y).toLowerCase();\r\n    return xs === ys;\r\n  };\r\n\r\n  // Determines if x (number) and y (number) are equal to each other\r\n  var numEqual = function(nx, y) {\r\n    if (typeof y === 'number' || DIGIT.test(y)) {\r\n      var ny = +y;\r\n      return ny === ny && nx === ny;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  // Modulo\r\n  var mod = function(x, y) {\r\n    var r = x % y;\r\n    if (r / y < 0) {\r\n      r += y;\r\n    }\r\n    return r;\r\n  };\r\n\r\n  // Random number in range\r\n  var random = function(x, y) {\r\n    x = +x || 0;\r\n    y = +y || 0;\r\n    if (x > y) {\r\n      var tmp = y;\r\n      y = x;\r\n      x = tmp;\r\n    }\r\n    if (x % 1 === 0 && y % 1 === 0) {\r\n      return Math.floor(Math.random() * (y - x + 1)) + x;\r\n    }\r\n    return Math.random() * (y - x) + x;\r\n  };\r\n\r\n  // Converts an RGB color as a number to HSL\r\n  var rgb2hsl = function(rgb) {\r\n    // TODO: P.utils.rgb2hsl?\r\n    var r = (rgb >> 16 & 0xff) / 0xff;\r\n    var g = (rgb >> 8 & 0xff) / 0xff;\r\n    var b = (rgb & 0xff) / 0xff;\r\n\r\n    var min = Math.min(r, g, b);\r\n    var max = Math.max(r, g, b);\r\n\r\n    if (min === max) {\r\n      return [0, 0, r * 100];\r\n    }\r\n\r\n    var c = max - min;\r\n    var l = (min + max) / 2;\r\n    var s = c / (1 - Math.abs(2 * l - 1));\r\n\r\n    var h;\r\n    switch (max) {\r\n      case r: h = ((g - b) / c + 6) % 6; break;\r\n      case g: h = (b - r) / c + 2; break;\r\n      case b: h = (r - g) / c + 4; break;\r\n    }\r\n    h *= 60;\r\n\r\n    return [h, s * 100, l * 100];\r\n  };\r\n\r\n  // Clone a sprite\r\n  var clone = function(name) {\r\n    const parent = name === '_myself_' ? S : self.getObject(name);\r\n    if (!parent) {\r\n      throw new Error('No parent!');\r\n    }\r\n    if (!P.core.isSprite(parent)) {\r\n      throw new Error('Cannot clone non-sprite object');\r\n    }\r\n    const c = parent.clone();\r\n    self.children.splice(self.children.indexOf(parent), 0, c);\r\n    runtime.triggerFor(c, 'whenCloned');\r\n  };\r\n\r\n  var getVars = function(name) {\r\n    return self.vars[name] !== undefined ? self.vars : S.vars;\r\n  };\r\n\r\n  var getLists = function(name) {\r\n    if (self.lists[name] !== undefined) return self.lists;\r\n    if (S.lists[name] === undefined) {\r\n      S.lists[name] = [];\r\n    }\r\n    return S.lists;\r\n  };\r\n\r\n  var listIndex = function(list, index, length) {\r\n    var i = index | 0;\r\n    if (i === index) return i > 0 && i <= length ? i - 1 : -1;\r\n    if (index === 'random' || index === 'any') {\r\n      return Math.random() * length | 0;\r\n    }\r\n    if (index === 'last') {\r\n      return length - 1;\r\n    }\r\n    return i > 0 && i <= length ? i - 1 : -1;\r\n  };\r\n\r\n  var contentsOfList = function(list) {\r\n    var isSingle = true;\r\n    for (var i = list.length; i--;) {\r\n      if (list[i].length !== 1) {\r\n        isSingle = false;\r\n        break;\r\n      }\r\n    }\r\n    return list.join(isSingle ? '' : ' ');\r\n  };\r\n\r\n  var getLineOfList = function(list, index) {\r\n    var i = listIndex(list, index, list.length);\r\n    return i !== -1 ? list[i] : '';\r\n  };\r\n\r\n  var listContains = function(list, value) {\r\n    for (var i = list.length; i--;) {\r\n      if (equal(list[i], value)) return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  var listIndexOf = function(list, value) {\r\n    for (var i = list.length; i--;) {\r\n      if (equal(list[i], value)) return i + 1;\r\n    }\r\n    return 0;\r\n  };\r\n\r\n  var appendToList = function(list, value) {\r\n    list.push(value);\r\n  };\r\n\r\n  var deleteLineOfList = function(list, index) {\r\n    if (index === 'all') {\r\n      list.length = 0;\r\n    } else {\r\n      var i = listIndex(list, index, list.length);\r\n      if (i === list.length - 1) {\r\n        list.pop();\r\n      } else if (i !== -1) {\r\n        list.splice(i, 1);\r\n      }\r\n    }\r\n  };\r\n\r\n  var insertInList = function(list, index, value) {\r\n    var i = listIndex(list, index, list.length + 1);\r\n    if (i === list.length) {\r\n      list.push(value);\r\n    } else if (i !== -1) {\r\n      list.splice(i, 0, value);\r\n    }\r\n  };\r\n\r\n  var setLineOfList = function(list, index, value) {\r\n    var i = listIndex(list, index, list.length);\r\n    if (i !== -1) {\r\n      list[i] = value;\r\n    }\r\n  };\r\n\r\n  var mathFunc = function(f, x) {\r\n    switch (f) {\r\n      case 'abs':\r\n        return Math.abs(x);\r\n      case 'floor':\r\n        return Math.floor(x);\r\n      case 'sqrt':\r\n        return Math.sqrt(x);\r\n      case 'ceiling':\r\n        return Math.ceil(x);\r\n      case 'cos':\r\n        return Math.cos(x * Math.PI / 180);\r\n      case 'sin':\r\n        return Math.sin(x * Math.PI / 180);\r\n      case 'tan':\r\n        return Math.tan(x * Math.PI / 180);\r\n      case 'asin':\r\n        return Math.asin(x) * 180 / Math.PI;\r\n      case 'acos':\r\n        return Math.acos(x) * 180 / Math.PI;\r\n      case 'atan':\r\n        return Math.atan(x) * 180 / Math.PI;\r\n      case 'ln':\r\n        return Math.log(x);\r\n      case 'log':\r\n        return Math.log(x) / Math.LN10;\r\n      case 'e ^':\r\n        return Math.exp(x);\r\n      case '10 ^':\r\n        return Math.exp(x * Math.LN10);\r\n    }\r\n    return 0;\r\n  };\r\n\r\n  var attribute = function(attr, objName) {\r\n    // https://github.com/LLK/scratch-vm/blob/e236d29ff5e03f7c4d77a614751da860521771fd/src/blocks/scratch3_sensing.js#L280\r\n    const o = self.getObject(objName);\r\n    if (!o) return 0;\r\n    if (P.core.isSprite(o)) {\r\n      switch (attr) {\r\n        case 'x position': return o.scratchX;\r\n        case 'y position': return o.scratchY;\r\n        case 'direction': return o.direction;\r\n        case 'costume #': return o.currentCostumeIndex + 1;\r\n        case 'costume name': return o.costumes[o.currentCostumeIndex].name;\r\n        case 'size': return o.scale * 100;\r\n        case 'volume': return o.volume * 100;\r\n      }\r\n    } else {\r\n      switch (attr) {\r\n        case 'background #':\r\n        case 'backdrop #': return o.currentCostumeIndex + 1;\r\n        case 'backdrop name': return o.costumes[o.currentCostumeIndex].name;\r\n        case 'volume': return o.volume * 100;\r\n      }\r\n    }\r\n    const value = o.lookupVariable(attr);\r\n    if (value !== undefined) {\r\n      return value;\r\n    }\r\n    return 0;\r\n  };\r\n\r\n  var timeAndDate = function(format: any): number {\r\n    switch (format) {\r\n      case 'year':\r\n        return new Date().getFullYear();\r\n      case 'month':\r\n        return new Date().getMonth() + 1;\r\n      case 'date':\r\n        return new Date().getDate();\r\n      case 'day of week':\r\n        return new Date().getDay() + 1;\r\n      case 'hour':\r\n        return new Date().getHours();\r\n      case 'minute':\r\n        return new Date().getMinutes();\r\n      case 'second':\r\n        return new Date().getSeconds();\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  /**\r\n   * Converts the name of a key to its code\r\n   */\r\n  export function getKeyCode(keyName: string): number | 'any' {\r\n    switch (keyName.toLowerCase()) {\r\n      case 'space': return 32;\r\n      case 'left arrow': return 37;\r\n      case 'up arrow': return 38;\r\n      case 'right arrow': return 39;\r\n      case 'down arrow': return 40;\r\n      case 'any': return 'any';\r\n    }\r\n\r\n    return keyName.toUpperCase().charCodeAt(0);\r\n  }\r\n\r\n  // Load audio methods if audio is supported\r\n  const audioContext = P.audio.context;\r\n  if (audioContext) {\r\n    var playNote = function(key, duration) {\r\n      if (!S.node) {\r\n        S.node = audioContext.createGain();\r\n        S.node.gain.value = S.volume;\r\n        P.audio.connect(S.node);\r\n      }\r\n\r\n      var span;\r\n      var spans = INSTRUMENTS[S.instrument];\r\n      for (var i = 0, l = spans.length; i < l; i++) {\r\n        span = spans[i];\r\n        if (span.top >= key || span.top === 128) break;\r\n      }\r\n\r\n      P.audio.playSpan(span, key, duration, S.node);\r\n    };\r\n\r\n    var playSpan = function(span, key, duration) {\r\n      if (!S.node) {\r\n        S.node = audioContext.createGain();\r\n        S.node.gain.value = S.volume;\r\n        P.audio.connect(S.node);\r\n      }\r\n      P.audio.playSpan(span, key, duration, S.node);\r\n    };\r\n\r\n    var playSound = function(sound) {\r\n      if (!sound.node) {\r\n        sound.node = audioContext.createGain();\r\n        sound.node.gain.value = S.volume;\r\n        P.audio.connect(sound.node);\r\n      }\r\n      sound.target = S;\r\n      sound.node.gain.setValueAtTime(S.volume, audioContext.currentTime);\r\n      P.audio.playSound(sound);\r\n    };\r\n  }\r\n\r\n  var save = function() {\r\n    STACK.push(R);\r\n    R = {};\r\n  };\r\n\r\n  var restore = function() {\r\n    R = STACK.pop();\r\n  };\r\n\r\n  var call = function(procedure: P.core.Procedure, id, values) {\r\n    if (procedure) {\r\n      STACK.push(R);\r\n      CALLS.push(C);\r\n      C = {\r\n        base: procedure.fn,\r\n        fn: S.fns[id],\r\n        args: procedure.call(values),\r\n        numargs: [],\r\n        boolargs: [],\r\n        stack: STACK = [],\r\n        warp: procedure.warp,\r\n      };\r\n      R = {};\r\n      if (C.warp || WARP) {\r\n        WARP++;\r\n        IMMEDIATE = procedure.fn;\r\n      } else {\r\n        for (var i = CALLS.length, j = 5; i-- && j--;) {\r\n          if (CALLS[i].base === procedure.fn) {\r\n            runtime.queue[THREAD] = new Thread(S, BASE, procedure.fn, CALLS);\r\n            break;\r\n          }\r\n        }\r\n        IMMEDIATE = procedure.fn;\r\n      }\r\n    } else {\r\n      IMMEDIATE = S.fns[id];\r\n    }\r\n  };\r\n\r\n  var endCall = function() {\r\n    if (CALLS.length) {\r\n      if (WARP) WARP--;\r\n      IMMEDIATE = C.fn;\r\n      C = CALLS.pop();\r\n      STACK = C.stack;\r\n      R = STACK.pop();\r\n    }\r\n  };\r\n\r\n  var sceneChange = function() {\r\n    return runtime.trigger('whenSceneStarts', self.getCostumeName());\r\n  };\r\n\r\n  var backdropChange = function() {\r\n    return runtime.trigger('whenBackdropChanges', self.getCostumeName());\r\n  };\r\n\r\n  var broadcast = function(name) {\r\n    return runtime.trigger('whenIReceive', name);\r\n  };\r\n\r\n  var running = function(bases) {\r\n    for (var j = 0; j < runtime.queue.length; j++) {\r\n      if (runtime.queue[j] && bases.indexOf(runtime.queue[j]!.base) !== -1) return true;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  var queue = function(id) {\r\n    if (WARP) {\r\n      IMMEDIATE = S.fns[id];\r\n    } else {\r\n      forceQueue(id);\r\n    }\r\n  };\r\n\r\n  var forceQueue = function(id) {\r\n    runtime.queue[THREAD] = new Thread(S, BASE, S.fns[id], CALLS);\r\n  };\r\n\r\n  type ThreadResume = any;\r\n\r\n  interface ThreadCall {\r\n    fn?: Fn;\r\n    stack: ThreadResume[];\r\n    [s: string]: any;\r\n  }\r\n\r\n  class Thread {\r\n    constructor(\r\n      public sprite: P.core.Base,\r\n      public base: Fn,\r\n      public fn: Fn,\r\n      public calls: ThreadCall[],\r\n    ) {\r\n\r\n    }\r\n  }\r\n\r\n  export class Runtime {\r\n    public queue: Array<Thread | undefined> = [];\r\n    public isRunning: boolean = false;\r\n    public timerStart: number = 0;\r\n    public baseTime: number = 0;\r\n    public baseNow: number = 0;\r\n    public now: number = 0;\r\n    public interval: number;\r\n    public isTurbo: boolean = false;\r\n    public framerate: number = 30;\r\n\r\n    constructor(public stage: P.core.Stage) {\r\n      // Fix scoping\r\n      this.onError = this.onError.bind(this);\r\n      this.step = this.step.bind(this);\r\n    }\r\n\r\n    startThread(sprite: core.Base, base: Fn) {\r\n      const thread = new Thread(sprite, base, base, [{\r\n        args: [],\r\n        stack: [{}],\r\n      }]);\r\n\r\n      // Replace an existing thread instead of adding a new one when possible.\r\n      for (let i = 0; i < this.queue.length; i++) {\r\n        const q = this.queue[i];\r\n        if (q && q.sprite === sprite && q.base === base) {\r\n          this.queue[i] = thread;\r\n          return;\r\n        }\r\n      }\r\n\r\n      this.queue.push(thread);\r\n    }\r\n\r\n    /**\r\n     * Triggers an event for a single sprite.\r\n     */\r\n    triggerFor(sprite: P.core.Base, event: string, arg?: any): Fn[] {\r\n      let threads: Fn[];\r\n      switch (event) {\r\n        case 'whenClicked': threads = sprite.listeners.whenClicked; break;\r\n        case 'whenCloned': threads = sprite.listeners.whenCloned; break;\r\n        case 'whenGreenFlag': threads = sprite.listeners.whenGreenFlag; break;\r\n        case 'whenKeyPressed': threads = sprite.listeners.whenKeyPressed[arg]; break;\r\n        case 'whenSceneStarts': threads = sprite.listeners.whenSceneStarts[('' + arg).toLowerCase()]; break;\r\n        case 'whenBackdropChanges': threads = sprite.listeners.whenBackdropChanges['' + arg]; break;\r\n        case 'whenIReceive':\r\n          arg = '' + arg;\r\n          // TODO: remove toLowerCase() check?\r\n          threads = sprite.listeners.whenIReceive[arg] || sprite.listeners.whenIReceive[arg.toLowerCase()];\r\n          break;\r\n        default: throw new Error('Unknown trigger event: ' + event);\r\n      }\r\n      if (threads) {\r\n        for (let i = 0; i < threads.length; i++) {\r\n          this.startThread(sprite, threads[i]);\r\n        }\r\n      }\r\n      return threads || [];\r\n    }\r\n\r\n    /**\r\n     * Triggers an event on all sprites.\r\n     */\r\n    trigger(event: string, arg?: any) {\r\n      let threads: Fn[] = [];\r\n      for (let i = this.stage.children.length; i--;) {\r\n        threads = threads.concat(this.triggerFor(this.stage.children[i], event, arg));\r\n      }\r\n      return threads.concat(this.triggerFor(this.stage, event, arg));\r\n    }\r\n\r\n    /**\r\n     * Trigger's the project's green flag.\r\n     */\r\n    triggerGreenFlag() {\r\n      this.timerStart = this.rightNow();\r\n      this.trigger('whenGreenFlag');\r\n    }\r\n\r\n    /**\r\n     * Begins the runtime's event loop.\r\n     * Does not start any scripts.\r\n     */\r\n    start() {\r\n      this.isRunning = true;\r\n      if (this.interval) return;\r\n      window.addEventListener('error', this.onError);\r\n      this.baseTime = Date.now();\r\n      this.interval = setInterval(this.step, 1000 / this.framerate);\r\n      if (audioContext) audioContext.resume();\r\n    }\r\n\r\n    /**\r\n     * Pauses the event loop\r\n     */\r\n    pause() {\r\n      if (this.interval) {\r\n        this.baseNow = this.rightNow();\r\n        clearInterval(this.interval);\r\n        this.interval = 0;\r\n        window.removeEventListener('error', this.onError);\r\n        if (audioContext) audioContext.suspend();\r\n      }\r\n      this.isRunning = false;\r\n    }\r\n\r\n    /**\r\n     * Resets the interval loop without the effects of pausing/starting\r\n     */\r\n    resetInterval() {\r\n      if (!this.isRunning) {\r\n        throw new Error('cannot restart interval when paused');\r\n      }\r\n      if (this.interval) {\r\n        clearInterval(this.interval);\r\n      }\r\n      this.interval = setInterval(this.step, 1000 / this.framerate);\r\n    }\r\n\r\n    stopAll() {\r\n      this.stage.hidePrompt = false;\r\n      this.stage.prompter.style.display = 'none';\r\n      this.stage.promptId = this.stage.nextPromptId = 0;\r\n      this.queue.length = 0;\r\n      this.stage.resetFilters();\r\n      this.stage.stopSounds();\r\n      for (var i = 0; i < this.stage.children.length; i++) {\r\n        const c = this.stage.children[i];\r\n        if (c.isClone) {\r\n          c.remove();\r\n          this.stage.children.splice(i, 1);\r\n          i -= 1;\r\n        } else {\r\n          c.resetFilters();\r\n          if (c.saying && P.core.isSprite(c)) c.say('');\r\n          c.stopSounds();\r\n        }\r\n      }\r\n    }\r\n\r\n    /**\r\n     * The current time in the project\r\n     */\r\n    rightNow(): number {\r\n      return this.baseNow + Date.now() - this.baseTime;\r\n    }\r\n\r\n    /**\r\n     * Advances one frame into the future.\r\n     */\r\n    step() {\r\n      // Reset runtime variables\r\n      self = this.stage;\r\n      runtime = this;\r\n      VISUAL = false;\r\n\r\n      if (audioContext && audioContext.state === 'suspended') {\r\n        audioContext.resume();\r\n      }\r\n\r\n      const start = Date.now();\r\n      const queue = this.queue;\r\n      do {\r\n        this.now = this.rightNow();\r\n        for (THREAD = 0; THREAD < queue.length; THREAD++) {\r\n          const thread = queue[THREAD];\r\n          if (thread) {\r\n            // Load thread data\r\n            S = thread.sprite;\r\n            IMMEDIATE = thread.fn;\r\n            BASE = thread.base;\r\n            CALLS = thread.calls;\r\n            C = CALLS.pop();\r\n            STACK = C.stack;\r\n            R = STACK.pop();\r\n            queue[THREAD] = undefined;\r\n            WARP = 0;\r\n\r\n            while (IMMEDIATE) {\r\n              const fn = IMMEDIATE;\r\n              IMMEDIATE = null;\r\n              fn();\r\n            }\r\n\r\n            STACK.push(R);\r\n            CALLS.push(C);\r\n          }\r\n        }\r\n\r\n        // Remove empty elements in the queue list\r\n        for (let i = queue.length; i--;) {\r\n          if (!queue[i]) {\r\n            queue.splice(i, 1);\r\n          }\r\n        }\r\n      } while ((this.isTurbo || !VISUAL) && Date.now() - start < 1000 / this.framerate && queue.length);\r\n\r\n      this.stage.draw();\r\n    }\r\n\r\n    onError(e) {\r\n      clearInterval(this.interval);\r\n      this.handleError(e.error);\r\n    }\r\n\r\n    handleError(e) {\r\n      // Default error handler\r\n      console.error(e);\r\n    }\r\n  }\r\n\r\n  export function createContinuation(source: string): P.runtime.Fn {\r\n    // TODO: make understandable\r\n    var result = '(function() {\\n';\r\n    var brackets = 0;\r\n    var delBrackets = 0;\r\n    var shouldDelete = false;\r\n    var here = 0;\r\n    var length = source.length;\r\n    while (here < length) {\r\n      var i = source.indexOf('{', here);\r\n      var j = source.indexOf('}', here);\r\n      var k = source.indexOf('return;', here);\r\n      if (k === -1) k = length;\r\n      if (i === -1 && j === -1) {\r\n        if (!shouldDelete) {\r\n          result += source.slice(here, k);\r\n        }\r\n        break;\r\n      }\r\n      if (i === -1) i = length;\r\n      if (j === -1) j = length;\r\n      if (shouldDelete) {\r\n        if (i < j) {\r\n          delBrackets++;\r\n          here = i + 1;\r\n        } else {\r\n          delBrackets--;\r\n          if (!delBrackets) {\r\n            shouldDelete = false;\r\n          }\r\n          here = j + 1;\r\n        }\r\n      } else {\r\n        if (brackets === 0 && k < i && k < j) {\r\n          result += source.slice(here, k);\r\n          break;\r\n        }\r\n        if (i < j) {\r\n          result += source.slice(here, i + 1);\r\n          brackets++;\r\n          here = i + 1;\r\n        } else {\r\n          result += source.slice(here, j);\r\n          here = j + 1;\r\n          if (source.substr(j, 8) === '} else {') {\r\n            if (brackets > 0) {\r\n              result += '} else {';\r\n              here = j + 8;\r\n            } else {\r\n              shouldDelete = true;\r\n              delBrackets = 0;\r\n            }\r\n          } else {\r\n            if (brackets > 0) {\r\n              result += '}';\r\n              brackets--;\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    result += '})';\r\n    return scopedEval(result);\r\n  }\r\n\r\n  // Evaluate JavaScript within the scope of the runtime.\r\n  export function scopedEval(source: string): any {\r\n    return eval(source);\r\n  }\r\n}\r\n","/// <reference path=\"phosphorus.ts\" />\r\n/// <reference path=\"utils.ts\" />\r\n/// <reference path=\"core.ts\" />\r\n/// <reference path=\"fonts.ts\" />\r\n/// <reference path=\"config.ts\" />\r\n\r\n// Scratch 3 project loader and runtime objects\r\nnamespace P.sb3 {\r\n  // \"Scratch3*\" classes implement some part of the Scratch 3 runtime.\r\n  // \"SB3*\" interfaces are just types for Scratch 3 projects\r\n\r\n  /**\r\n   * The path to fetch remote assets from.\r\n   * Replace $md5ext with the md5sum and the format of the asset. (just use md5ext)\r\n   */\r\n  export const ASSETS_API = 'https://assets.scratch.mit.edu/internalapi/asset/$md5ext/get/';\r\n\r\n  interface SB3Project {\r\n    targets: SB3Target[];\r\n    monitors: SB3Watcher[];\r\n    meta: any;\r\n  }\r\n\r\n  export interface SB3Target {\r\n    name: string;\r\n    isStage: boolean;\r\n    sounds: SB3Sound[];\r\n    costumes: SB3Costume[];\r\n    draggable: boolean;\r\n    size: number;\r\n    direction: number;\r\n    visible: boolean;\r\n    x: number;\r\n    y: number;\r\n    currentCostume: number;\r\n    rotationStyle: string;\r\n    layerOrder: number;\r\n    lists: ObjectMap<SB3List>;\r\n    variables: ObjectMap<SB3Variable>;\r\n    blocks: ObjectMap<SB3Block>;\r\n    broadcasts: ObjectMap<string>;\r\n  }\r\n\r\n  interface SB3Costume {\r\n    /**\r\n     * The ID of the asset. Should be its md5sum.\r\n     * Example: \"b61b1077b0ea1931abee9dbbfa7903ff\"\r\n     */\r\n    assetId: string;\r\n    name: string;\r\n    /**\r\n     * \"Real pixels per image pixel\"\r\n     */\r\n    bitmapResolution: number;\r\n    /**\r\n     * The ID of the asset with its extension.\r\n     * Example: \"b61b1077b0ea1931abee9dbbfa7903ff.png\"\r\n     */\r\n    md5ext: string;\r\n    /**\r\n     * The format of the image.\r\n     * Usually \"png\" or \"svg\"\r\n     */\r\n    dataFormat: string;\r\n    rotationCenterX: number;\r\n    rotationCenterY: number;\r\n  }\r\n\r\n  interface SB3Sound {\r\n    assetId: string,\r\n    name: string;\r\n    dataFormat: string;\r\n    format: string;\r\n    rate: number;\r\n    sampleCount: number;\r\n    md5ext: string;\r\n  }\r\n\r\n  export interface SB3Block {\r\n    opcode: string;\r\n    topLevel: boolean;\r\n    inputs: ObjectMap<any>;\r\n    fields: ObjectMap<any>;\r\n    mutation: any;\r\n    parent: string | null;\r\n    next: string | null;\r\n  }\r\n\r\n  interface SB3Watcher {\r\n    spriteName: string | null;\r\n    visible: boolean;\r\n    id: string;\r\n    opcode: string;\r\n    mode: string;\r\n    params: any;\r\n    x: number;\r\n    y: number;\r\n    sliderMin?: number;\r\n    sliderMax?: number;\r\n    width?: number;\r\n    height?: number;\r\n    isDiscrete: boolean;\r\n  }\r\n\r\n  /**\r\n   * Tuple of name and initial value\r\n   */\r\n  type SB3List = [string, any[]];\r\n\r\n  /**\r\n   * Tuple of name and initial value\r\n   */\r\n  type SB3Variable = [string, any];\r\n\r\n  // Implements a Scratch 3 Stage.\r\n  // Adds Scratch 3 specific things such as broadcastReferences\r\n  export class Scratch3Stage extends P.core.Stage {\r\n    public variableNames: ObjectMap<string> = {};\r\n    public sb3data: SB3Target;\r\n\r\n    lookupVariable(name: string) {\r\n      return this.vars[this.variableNames[name]];\r\n    }\r\n\r\n    createVariableWatcher(target: P.core.Base, variableName: string) {\r\n      // TODO: implement\r\n      return null;\r\n    }\r\n  }\r\n\r\n  // Implements a Scratch 3 Sprite.\r\n  export class Scratch3Sprite extends P.core.Sprite {\r\n    public sb3data: any;\r\n    public variableNames: ObjectMap<string> = {};\r\n\r\n    lookupVariable(name: string) {\r\n      return this.vars[this.variableNames[name]];\r\n    }\r\n\r\n    _clone() {\r\n      return new Scratch3Sprite(this.stage);\r\n    }\r\n  }\r\n\r\n  export type Target = Scratch3Stage | Scratch3Sprite;\r\n\r\n  // Implements a Scratch 3 VariableWatcher.\r\n  // Adds Scratch 3-like styling\r\n  export class Scratch3VariableWatcher extends P.core.Watcher {\r\n    public id: string;\r\n    public opcode: string;\r\n    public mode: string;\r\n    public params: any;\r\n    public libraryEntry: P.sb3.compiler.WatchedValue;\r\n    public sliderMin: number;\r\n    public sliderMax: number;\r\n    public sliderStep: number;\r\n\r\n    public containerEl: HTMLElement;\r\n    public valueEl: HTMLElement;\r\n\r\n    constructor(stage: Scratch3Stage, data: SB3Watcher) {\r\n      super(stage, data.spriteName || '');\r\n\r\n      // Unique ID\r\n      this.id = data.id;\r\n      // Operation code, similar to other parts of Scratch 3\r\n      this.opcode = data.opcode;\r\n      this.mode = data.mode;\r\n      // Watcher options, varies by opcode.\r\n      this.params = data.params;\r\n      // This opcode's watcherLibrary entry.\r\n      this.libraryEntry = P.sb3.compiler.watcherLibrary[this.opcode];\r\n\r\n      this.x = data.x;\r\n      this.y = data.y;\r\n      this.visible = typeof data.visible === 'boolean' ? data.visible : true;\r\n\r\n      this.sliderMin = data.sliderMin || 0;\r\n      this.sliderMax = data.sliderMax || 0;\r\n      // isDiscrete doesn't always exist\r\n      if (typeof data.isDiscrete !== 'undefined') {\r\n        this.sliderStep = data.isDiscrete ? 1 : 0.01;\r\n      } else {\r\n        this.sliderStep = 1;\r\n      }\r\n\r\n      // Mark ourselves as invalid if the opcode is not recognized.\r\n      if (!this.libraryEntry) {\r\n        console.warn('unknown watcher', this.opcode, this);\r\n        this.valid = false;\r\n      }\r\n    }\r\n\r\n    update() {\r\n      if (this.visible) {\r\n        // Value is only updated when the value has changed to reduce useless paints in some browsers.\r\n        const value = this.getValue();\r\n        if (this.valueEl.textContent !== value) {\r\n          this.valueEl.textContent = this.getValue();\r\n        }\r\n      }\r\n    }\r\n\r\n    init() {\r\n      super.init();\r\n\r\n      // call init() if it exists\r\n      if (this.libraryEntry.init) {\r\n        this.libraryEntry.init(this);\r\n      }\r\n\r\n      this.updateLayout();\r\n    }\r\n\r\n    setVisible(visible: boolean) {\r\n      super.setVisible(visible);\r\n      this.updateLayout();\r\n    }\r\n\r\n    // Gets the label of the watcher.\r\n    // Will include the sprite's name if any.\r\n    // Example results are 'Sprite1: my variable' and 'timer'\r\n    getLabel() {\r\n      const label = this.libraryEntry.getLabel(this);\r\n      if (!this.target.isStage) {\r\n        return this.targetName + ': ' + label;\r\n      }\r\n      return label;\r\n    }\r\n\r\n    // Gets the value of the watcher as a string.\r\n    getValue() {\r\n      const value = this.libraryEntry.evaluate(this);\r\n      // Round off numbers to the 6th decimal\r\n      if (typeof value === 'number') {\r\n        return '' + (Math.round(value * 1e6) / 1e6);\r\n      }\r\n      return '' + value;\r\n    }\r\n\r\n    // Attempts to set the value of the watcher.\r\n    // Will silently fail if this watcher cannot be set.\r\n    setValue(value: number) {\r\n      // Not all opcodes have a set()\r\n      if (this.libraryEntry.set) {\r\n        this.libraryEntry.set(this, value);\r\n      }\r\n    }\r\n\r\n    // Updates or creates the layout of the watcher.\r\n    updateLayout() {\r\n      // If the HTML element has already been created, them simply update the CSS display property.\r\n      if (this.containerEl) {\r\n        this.containerEl.style.display = this.visible ? 'flex' : 'none';\r\n        return;\r\n      }\r\n\r\n      if (!this.visible) {\r\n        return;\r\n      }\r\n\r\n      const container = document.createElement('div');\r\n      container.classList.add('s3-watcher-container');\r\n      container.dataset.opcode = this.opcode;\r\n      container.style.top = (this.y / 10) + 'em';\r\n      container.style.left = (this.x / 10) + 'em';\r\n\r\n      const value = document.createElement('div');\r\n      value.classList.add('s3-watcher-value');\r\n      value.textContent = this.getValue();\r\n\r\n      this.containerEl = container;\r\n      this.valueEl = value;\r\n      this.stage.ui.appendChild(container);\r\n\r\n      const mode = this.mode;\r\n\r\n      if (mode === 'large') {\r\n        container.classList.add('s3-watcher-large');\r\n        container.appendChild(value);\r\n      } else {\r\n        // mode is probably 'normal' or 'slider'\r\n        // if it's not, then 'normal' would be a good fallback anyways.\r\n\r\n        const row = document.createElement('div');\r\n        row.classList.add('s3-watcher-row');\r\n        row.classList.add('s3-watcher-row-normal');\r\n\r\n        const label = document.createElement('div');\r\n        label.classList.add('s3-watcher-label');\r\n        label.textContent = this.getLabel();\r\n\r\n        row.appendChild(label);\r\n        row.appendChild(value);\r\n\r\n        container.classList.add('s3-watcher-container-normal');\r\n        container.appendChild(row);\r\n\r\n        // 'slider' is a slight variation of 'normal', just with an extra slider row.\r\n        if (mode === 'slider') {\r\n          const slider = document.createElement('div');\r\n          slider.classList.add('s3-watcher-row-slider');\r\n\r\n          const input = document.createElement('input');\r\n          input.type = 'range';\r\n          input.min = '' + this.sliderMin;\r\n          input.max = '' + this.sliderMax;\r\n          input.step = '' + this.sliderStep;\r\n          input.value = this.getValue();\r\n          input.addEventListener('input', this.sliderChanged.bind(this));\r\n\r\n          slider.appendChild(input);\r\n          container.appendChild(slider);\r\n        }\r\n      }\r\n    }\r\n\r\n    // Handles slider input events.\r\n    sliderChanged(e: Event) {\r\n      const value = +(e.target as HTMLInputElement).value;\r\n      this.setValue(value);\r\n    }\r\n  }\r\n\r\n  interface ListRow {\r\n    row: HTMLElement;\r\n    index: HTMLElement;\r\n    value: HTMLElement;\r\n  }\r\n\r\n  export class Scratch3ListWatcher extends P.core.Watcher {\r\n    private id: string;\r\n    private params: any;\r\n    private width: number;\r\n    private height: number;\r\n    private list: Scratch3List;\r\n    private domRows: ListRow[] = [];\r\n    private containerEl: HTMLElement;\r\n    private topLabelEl: HTMLElement;\r\n    private bottomLabelEl: HTMLElement;\r\n    private contentEl: HTMLElement;\r\n\r\n    constructor(stage: Scratch3Stage, data: SB3Watcher) {\r\n      super(stage, data.spriteName || '');\r\n\r\n      this.id = data.id;\r\n      this.params = data.params;\r\n      this.x = data.x;\r\n      this.y = data.y;\r\n      this.visible = typeof data.visible === 'boolean' ? data.visible : true;\r\n      this.width = data.width || 100;\r\n      this.height = data.height || 200;\r\n    }\r\n\r\n    update() {\r\n      // We're not visible, so no changes would be seen. We'd only be wasting CPU cycles.\r\n      // If the list was modified, we'll find out after we become visible.\r\n      if (!this.visible) {\r\n        return;\r\n      }\r\n\r\n      // Silently rest if the list has not been modified to improve performance for static lists.\r\n      if (!this.list.modified) {\r\n        return;\r\n      }\r\n      this.list.modified = false;\r\n      this.updateContents();\r\n    }\r\n\r\n    updateContents() {\r\n      const length = this.list.length;\r\n\r\n      if (this.domRows.length < length) {\r\n        while (this.domRows.length < length) {\r\n          const row = this.createRow();\r\n          this.domRows.push(row);\r\n          this.contentEl.appendChild(row.row);\r\n        }\r\n      } else if (this.domRows.length > length) {\r\n        while (this.domRows.length > length) {\r\n          this.domRows.pop();\r\n          this.contentEl.removeChild(this.contentEl.lastChild!);\r\n        }\r\n      }\r\n\r\n      for (var i = 0; i < length; i++) {\r\n        const { value } = this.domRows[i];\r\n        const rowText = '' + this.list[i];\r\n        if (rowText !== value.textContent) {\r\n          value.textContent = rowText;\r\n        }\r\n      }\r\n\r\n      const bottomLabelText = this.getBottomLabel();\r\n      if (this.bottomLabelEl.textContent !== bottomLabelText) {\r\n        this.bottomLabelEl.textContent = this.getBottomLabel();\r\n      }\r\n    }\r\n\r\n    init() {\r\n      super.init();\r\n      if (!(this.id in this.target.lists)) {\r\n        // Create the list if it doesn't exist.\r\n        // It might be better to mark ourselves as invalid instead, but this works just fine.\r\n        this.target.lists[this.id] = new Scratch3List();\r\n      }\r\n      this.list = this.target.lists[this.id] as Scratch3List;\r\n      this.target.watchers[this.id] = this;\r\n      this.updateLayout();\r\n      if (this.visible) {\r\n        this.updateContents();\r\n      }\r\n    }\r\n\r\n    getTopLabel() {\r\n      return this.params.LIST;\r\n    }\r\n    getBottomLabel() {\r\n      return 'length ' + this.list.length;\r\n    }\r\n\r\n    updateLayout() {\r\n      if (!this.containerEl) {\r\n        this.createLayout();\r\n      }\r\n      this.containerEl.style.display = this.visible ? '' : 'none';\r\n    }\r\n\r\n    setVisible(visible: boolean) {\r\n      super.setVisible(visible);\r\n      this.updateLayout();\r\n    }\r\n\r\n    createRow(): ListRow {\r\n      const row = document.createElement('div');\r\n      const index = document.createElement('div');\r\n      const value = document.createElement('div');\r\n      row.classList.add('s3-list-row');\r\n      index.classList.add('s3-list-index');\r\n      value.classList.add('s3-list-value');\r\n      index.textContent = (this.domRows.length + 1).toString();\r\n      row.appendChild(index);\r\n      row.appendChild(value);\r\n      return { row, index, value };\r\n    }\r\n\r\n    createLayout() {\r\n      this.containerEl = document.createElement('div');\r\n      this.topLabelEl = document.createElement('div');\r\n      this.bottomLabelEl = document.createElement('div');\r\n      this.contentEl = document.createElement('div');\r\n\r\n      this.containerEl.style.top = (this.y / 10) + 'em';\r\n      this.containerEl.style.left = (this.x / 10) + 'em';\r\n      this.containerEl.style.height = (this.height / 10) + 'em';\r\n      this.containerEl.style.width = (this.width / 10) + 'em';\r\n      this.containerEl.classList.add('s3-list-container');\r\n\r\n      this.topLabelEl.textContent = this.getTopLabel();\r\n      this.topLabelEl.classList.add('s3-list-top-label');\r\n\r\n      this.bottomLabelEl.textContent = this.getBottomLabel();\r\n      this.bottomLabelEl.classList.add('s3-list-bottom-label');\r\n\r\n      this.contentEl.classList.add('s3-list-content');\r\n\r\n      this.containerEl.appendChild(this.topLabelEl);\r\n      this.containerEl.appendChild(this.contentEl);\r\n      this.containerEl.appendChild(this.bottomLabelEl);\r\n      this.stage.ui.appendChild(this.containerEl);\r\n    }\r\n  }\r\n\r\n  // Implements a Scratch 3 procedure.\r\n  // Scratch 3 uses names as references for arguments (Scratch 2 uses indexes I believe)\r\n  export class Scratch3Procedure extends P.core.Procedure {\r\n    call(inputs: any[]) {\r\n      const args = {};\r\n      for (var i = 0; i < this.inputs.length; i++) {\r\n        args[this.inputs[i]] = inputs[i];\r\n      }\r\n      return args;\r\n    }\r\n  }\r\n\r\n  // An Array usable by the Scratch 3 compiler.\r\n  // Implements Scratch list blocks and their behavior.\r\n  export class Scratch3List extends Array {\r\n    public modified: boolean = false;\r\n\r\n    // Modified toString() that functions like Scratch.\r\n    toString() {\r\n      var i = this.length;\r\n      while (i--) {\r\n        if (('' + this[i]).length !== 1) {\r\n          return this.join(' ');\r\n        }\r\n      }\r\n      return this.join('');\r\n    }\r\n\r\n    /**\r\n     * Determines the \"real\" 0-indexed index of a 1-indexed Scratch index.\r\n     * @param index A scratch 1-indexed index, or 'random', 'any', 'last'\r\n     * @returns The 0-indexed index, or -1\r\n     */\r\n    scratchIndex(index: number | string): number {\r\n      if (index === 'random' || index === 'any') {\r\n        return Math.floor(Math.random() * this.length);\r\n      }\r\n      if (index === 'last') {\r\n        return this.length - 1;\r\n      }\r\n      index = Math.floor(+index);\r\n      if (index < 1 || index > this.length) {\r\n        return -1;\r\n      }\r\n      return index - 1;\r\n    }\r\n\r\n    // Deletes a line from the list.\r\n    // index is a scratch index.\r\n    deleteLine(index: number | 'all') {\r\n      if (index === 'all') {\r\n        this.modified = true;\r\n        this.length = 0;\r\n        return;\r\n      }\r\n\r\n      index = this.scratchIndex(index);\r\n      if (index === this.length - 1) {\r\n        this.modified = true;\r\n        this.pop();\r\n      } else if (index !== -1) {\r\n        this.modified = true;\r\n        this.splice(index, 1);\r\n      }\r\n    }\r\n\r\n    // Adds an item to the list.\r\n    push(...items: any[]) {\r\n      this.modified = true;\r\n      return super.push(...items);\r\n    }\r\n\r\n    // Inserts an item at a spot in the list.\r\n    // Index is a Scratch index.\r\n    insert(index: number, value: any) {\r\n      // TODO: simplify/refactor\r\n      if (+index === 1) {\r\n        this.modified = true;\r\n        this.unshift(value);\r\n        return;\r\n      }\r\n      index = this.scratchIndex(index);\r\n      if (index === this.length) {\r\n        this.modified = true;\r\n        this.push(value);\r\n      } else if (index !== -1) {\r\n        this.modified = true;\r\n        this.splice(index, 0, value);\r\n      }\r\n    }\r\n\r\n    // Sets the index of something in the list.\r\n    set(index: number, value: any) {\r\n      index = this.scratchIndex(index);\r\n      if (index !== -1) {\r\n        this.modified = true;\r\n        this[index] = value;\r\n      }\r\n    }\r\n  }\r\n\r\n  // Modifies a Scratch 3 SVG to work properly in our environment.\r\n  function patchSVG(svg: SVGElement) {\r\n    // SVGs made by Scratch 3 use font names such as 'Sans Serif', which we convert to their real names.\r\n    const FONTS = {\r\n      'Marker': 'Knewave',\r\n      'Handwriting': 'Handlee',\r\n      'Curly': 'Griffy',\r\n      'Pixel': 'Pixel',\r\n      'Scratch': 'Scratch',\r\n      'Serif': 'Source Serif Pro',\r\n      'Sans Serif': 'Noto Sans',\r\n    };\r\n\r\n    const textElements = svg.querySelectorAll('text');\r\n    for (var i = 0; i < textElements.length; i++) {\r\n      const el = textElements[i];\r\n      const font = el.getAttribute('font-family') || '';\r\n      if (FONTS[font]) {\r\n        el.setAttribute('font-family', FONTS[font]);\r\n      } else {\r\n        console.warn('unknown font', font, '(defaulting to sans-serif)');\r\n        // Scratch 3 replaces unknown fonts with sans serif.\r\n        el.setAttribute('font-family', FONTS['Sans Serif']);\r\n      }\r\n    }\r\n  }\r\n\r\n  // Implements base SB3 loading logic.\r\n  // Needs to be extended to add file loading methods.\r\n  // Implementations are expected to set `this.projectData` to something before calling super.load()\r\n  export abstract class BaseSB3Loader {\r\n    protected projectData: SB3Project;\r\n\r\n    protected abstract getAsText(path: string): Promise<string>;\r\n    protected abstract getAsArrayBuffer(path: string): Promise<ArrayBuffer>;\r\n    protected abstract getAsImage(path: string, format: string): Promise<HTMLImageElement>;\r\n\r\n    // Loads and returns a costume from its sb3 JSON data\r\n    getImage(path: string, format: string): Promise<HTMLImageElement | HTMLCanvasElement> {\r\n      if (format === 'svg') {\r\n        return this.getAsText(path)\r\n          .then((source) => {\r\n            const parser = new DOMParser();\r\n            const doc = parser.parseFromString(source, 'image/svg+xml');\r\n            const svg = doc.documentElement as any;\r\n            patchSVG(svg);\r\n\r\n            const canvas = document.createElement('canvas');\r\n\r\n            return new Promise<HTMLCanvasElement | HTMLImageElement>((resolve, reject) => {\r\n              canvg(canvas, new XMLSerializer().serializeToString(svg), {\r\n                ignoreMouse: true,\r\n                ignoreAnimation: true,\r\n                ignoreClear: true,\r\n                renderCallback: function() {\r\n                  if (canvas.width === 0 || canvas.height === 0) {\r\n                    resolve(new Image());\r\n                    return;\r\n                  }\r\n                  resolve(canvas);\r\n                }\r\n              });\r\n            });\r\n          });\r\n      } else {\r\n        return this.getAsImage(path, format);\r\n      }\r\n    }\r\n\r\n    loadCostume(data: SB3Costume, index: number): Promise<P.core.Costume> {\r\n      const path = data.assetId + '.' + data.dataFormat;\r\n      return this.getImage(path, data.dataFormat)\r\n        .then((image) => new P.core.Costume({\r\n          index: index,\r\n          bitmapResolution: data.bitmapResolution,\r\n          name: data.name,\r\n          rotationCenterX: data.rotationCenterX,\r\n          rotationCenterY: data.rotationCenterY,\r\n          source: image,\r\n        }));\r\n    }\r\n\r\n    getAudioBuffer(path: string) {\r\n      return this.getAsArrayBuffer(path)\r\n        .then((buffer) => P.audio.decodeAudio(buffer))\r\n        .catch((err) => {\r\n          throw new Error(`Could not load audio: ${path} (${err})`);\r\n        });\r\n    }\r\n\r\n    loadSound(data: SB3Sound): Promise<P.core.Sound | null> {\r\n      return new Promise((resolve, reject) => {\r\n        this.getAudioBuffer(data.md5ext)\r\n          .then((buffer) => {\r\n            resolve(new P.core.Sound({\r\n              name: data.name,\r\n              buffer,\r\n            }))\r\n          })\r\n          .catch((err) => {\r\n            console.warn('Could not load sound: ' + err);\r\n            resolve(null);\r\n          });\r\n      });\r\n    }\r\n\r\n    loadWatcher(data: SB3Watcher, stage: Scratch3Stage): P.core.Watcher {\r\n      if (data.mode === 'list') {\r\n        return new Scratch3ListWatcher(stage, data);\r\n      }\r\n\r\n      return new Scratch3VariableWatcher(stage, data);\r\n    }\r\n\r\n    loadTarget(data: SB3Target): Promise<Target> {\r\n      // dirty hack for null stage\r\n      const target = new (data.isStage ? Scratch3Stage : Scratch3Sprite)(null as any);\r\n\r\n      for (const id of Object.keys(data.variables)) {\r\n        const variable = data.variables[id];\r\n        const name = variable[0];\r\n        const value = variable[1];\r\n        target.vars[id] = value;\r\n        target.variableNames[name] = id;\r\n      }\r\n\r\n      for (const id of Object.keys(data.lists)) {\r\n        const list = data.lists[id];\r\n        target.lists[id] = new Scratch3List().concat(list[1]);\r\n      }\r\n\r\n      target.name = data.name;\r\n      target.currentCostumeIndex = data.currentCostume;\r\n      target.sb3data = data;\r\n\r\n      if (target.isStage) {\r\n\r\n      } else {\r\n        const sprite = target as Scratch3Sprite;\r\n        sprite.scratchX = data.x;\r\n        sprite.scratchY = data.y;\r\n        sprite.visible = data.visible;\r\n        sprite.direction = data.direction;\r\n        sprite.scale = data.size / 100;\r\n        sprite.isDraggable = data.draggable;\r\n        sprite.rotationStyle = P.utils.parseRotationStyle(data.rotationStyle);\r\n      }\r\n\r\n      const costumesPromise = Promise.all<P.core.Costume>(data.costumes.map((c: any, i: any) => this.loadCostume(c, i)));\r\n      const soundsPromise = Promise.all<P.core.Sound | null>(data.sounds.map((c) => this.loadSound(c)));\r\n\r\n      return Promise.all<P.core.Costume[], Array<P.core.Sound | null>>([costumesPromise, soundsPromise])\r\n        .then((result) => {\r\n          const costumes = result[0];\r\n          const sounds = result[1];\r\n\r\n          target.costumes = costumes;\r\n          sounds.forEach((sound) => sound && target.addSound(sound));\r\n\r\n          return target;\r\n        });\r\n    }\r\n\r\n    loadFonts(): Promise<void> {\r\n      return P.fonts.loadScratch3();\r\n    }\r\n\r\n    load() {\r\n      if (!this.projectData) {\r\n        throw new Error('invalid project data');\r\n      }\r\n      if (!Array.isArray(this.projectData.targets)) {\r\n        throw new Error('no targets');\r\n      }\r\n\r\n      const targets = this.projectData.targets;\r\n      // sort targets by their layerOrder to match how they will display\r\n      targets.sort((a, b) => a.layerOrder - b.layerOrder);\r\n\r\n      return this.loadFonts()\r\n        .then(() => Promise.all(targets.map((data) => this.loadTarget(data))))\r\n        .then((targets: any) => {\r\n          const stage = targets.filter((i) => i.isStage)[0] as Scratch3Stage;\r\n          if (!stage) {\r\n            throw new Error('no stage object');\r\n          }\r\n          const sprites = targets.filter((i) => i.isSprite) as Scratch3Sprite[];\r\n          const watchers = this.projectData.monitors\r\n            .map((data) => this.loadWatcher(data, stage))\r\n            .filter((i) => i && i.valid);\r\n\r\n          sprites.forEach((sprite) => sprite.stage = stage);\r\n          targets.forEach((base) => P.sb3.compiler.compileTarget(base, base.sb3data));\r\n          stage.children = sprites;\r\n          stage.allWatchers = watchers;\r\n          watchers.forEach((watcher) => watcher.init());\r\n          stage.updateBackdrop();\r\n\r\n          return stage;\r\n        });\r\n    }\r\n  }\r\n\r\n  // Loads a .sb3 file\r\n  export class SB3FileLoader extends BaseSB3Loader {\r\n    private buffer: ArrayBuffer;\r\n    private zip: JSZip.Zip;\r\n\r\n    constructor(buffer: ArrayBuffer) {\r\n      super();\r\n      this.buffer = buffer;\r\n    }\r\n\r\n    getAsText(path: string) {\r\n      P.IO.progressHooks.new();\r\n      return this.zip.file(path).async('text')\r\n        .then((response) => {\r\n          P.IO.progressHooks.end();\r\n          return response;\r\n        });\r\n    }\r\n\r\n    getAsArrayBuffer(path: string) {\r\n      P.IO.progressHooks.new();\r\n      return this.zip.file(path).async('arrayBuffer')\r\n        .then((response) => {\r\n          P.IO.progressHooks.end();\r\n          return response;\r\n        });\r\n    }\r\n\r\n    getAsBase64(path: string) {\r\n      P.IO.progressHooks.new();\r\n      return this.zip.file(path).async('base64')\r\n        .then((response) => {\r\n          P.IO.progressHooks.end();\r\n          return response;\r\n        });\r\n    }\r\n\r\n    getAsImage(path: string, format: string) {\r\n      P.IO.progressHooks.new();\r\n      return this.getAsBase64(path)\r\n        .then((imageData) => {\r\n          return new Promise<HTMLImageElement>((resolve, reject) => {\r\n            const image = new Image();\r\n            image.onload = function() {\r\n              P.IO.progressHooks.end();\r\n              resolve(image);\r\n            };\r\n            image.onerror = function(error) {\r\n              P.IO.progressHooks.error(error);\r\n              reject('Failed to load image: ' + path + '.' + format);\r\n            };\r\n            image.src = 'data:image/' + format + ';base64,' + imageData;\r\n          });\r\n        });\r\n    }\r\n\r\n    load() {\r\n      return JSZip.loadAsync(this.buffer)\r\n        .then((data) => {\r\n          this.zip = data;\r\n          return this.getAsText('project.json');\r\n        })\r\n        .then((project) => {\r\n          this.projectData = JSON.parse(project);\r\n        })\r\n        .then(() => super.load());\r\n    }\r\n  }\r\n\r\n  // Loads a Scratch 3 project from the scratch.mit.edu website\r\n  // Uses either a loaded project.json or its ID\r\n  export class Scratch3Loader extends BaseSB3Loader {\r\n    private projectId: number | null;\r\n\r\n    constructor(idOrData: number | SB3Project) {\r\n      super();\r\n      if (typeof idOrData === 'object') {\r\n        this.projectData = idOrData;\r\n        this.projectId = null;\r\n      } else {\r\n        this.projectId = idOrData;\r\n      }\r\n    }\r\n\r\n    getAsText(path: string) {\r\n      return P.IO.fetchRemote(ASSETS_API.replace('$md5ext', path))\r\n        .then((request) => request.text());\r\n    }\r\n\r\n    getAsArrayBuffer(path: string) {\r\n      return P.IO.fetchRemote(ASSETS_API.replace('$md5ext', path))\r\n        .then((request) => request.arrayBuffer());\r\n    }\r\n\r\n    getAsImage(path: string) {\r\n      P.IO.progressHooks.new();\r\n      return new Promise<HTMLImageElement>((resolve, reject) => {\r\n        const image = new Image();\r\n        image.onload = function() {\r\n          P.IO.progressHooks.end();\r\n          resolve(image);\r\n        };\r\n        image.onerror = function(err) {\r\n          P.IO.progressHooks.error(err);\r\n          reject('Failed to load image: ' + image.src);\r\n        };\r\n        image.crossOrigin = 'anonymous';\r\n        image.src = ASSETS_API.replace('$md5ext', path);\r\n      });\r\n    }\r\n\r\n    load() {\r\n      if (this.projectId) {\r\n        return P.IO.fetchRemote(P.config.PROJECT_API.replace('$id', '' + this.projectId))\r\n          .then((request) => request.json())\r\n          .then((data) => {\r\n            this.projectData = data;\r\n          })\r\n          .then(() => super.load());\r\n      } else {\r\n        return super.load();\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// Compiler for .sb3 projects\r\nnamespace P.sb3.compiler {\r\n  // Source of the current script being compiled.\r\n  let source: string;\r\n  // The target being compiled.\r\n  let currentTarget: P.sb3.Target;\r\n  // The blocks of the target.\r\n  let blocks: ObjectMap<Block>;\r\n  // Points to the position of functions (by string index) within the compiled source.\r\n  let fns: number[];\r\n\r\n  // Alias Block so you don't have you type as much\r\n  import Block = P.sb3.SB3Block;\r\n\r\n  /*\r\n  In Scratch 3 all blocks have a unique identifier.\r\n  In the project.json, blocks do not contain other blocks in the way a .sb2 file does, but rather they point to the IDs of other blocks.\r\n\r\n  This compiler differentiates between \"statements\", \"expressions\", \"top levels\", and \"natives\".\r\n  Statements are things like `move [ ] steps`. They do something. Cannot be placed in other blocks.\r\n  Expressions are things like `size`, `addition`, `and` etc. They return something. Cannot do anything on their own.\r\n  Natives are things that are core parts of the runtime. This is stuff like strings, numbers, variable references, list references, colors.\r\n  Top levels are top level blocks like `when green flag pressed`, they react to events.\r\n  Each of these are separated and compiled differently and in different spots.\r\n  */\r\n\r\n  // A CompiledExpression is a type of expression made by an expression compiler with extra\r\n  // data such as types for sake of optimization.\r\n  class CompiledExpression {\r\n    /**\r\n     * The source code of this expression.\r\n     */\r\n    public source: string;\r\n\r\n    /**\r\n     * The type of this expression. Guarantees that, when evaluated, this expression will **always**\r\n     * return a value of a certain type to avoid type coercion overhead.\r\n     */\r\n    public type: ExpressionType;\r\n\r\n    constructor(src: string, type: ExpressionType) {\r\n      this.source = src;\r\n      this.type = type;\r\n    }\r\n  }\r\n\r\n  // Easier aliases for CompiledExpression\r\n  const numberExpr = (src: string) => new CompiledExpression(src, 'number');\r\n  const stringExpr = (src: string) => new CompiledExpression(src, 'string');\r\n  const booleanExpr = (src: string) => new CompiledExpression(src, 'boolean');\r\n\r\n  // All possible types you can compile an expression into.\r\n  type ExpressionType = 'string' | 'boolean' | 'number';\r\n\r\n  // Compiler for a top level block\r\n  export type TopLevelCompiler = (block: Block, f: P.runtime.Fn) => void;\r\n  // Compiler for an expression\r\n  export type ExpressionCompiler = (block: Block) => string | CompiledExpression;\r\n  // Compiler for a statement\r\n  export type StatementCompiler = (block: Block) => void;\r\n  // Compiler/handler for a watcher\r\n  export interface WatchedValue {\r\n    /**\r\n     * Initializes the watcher.\r\n     */\r\n    init?(watcher: P.sb3.Scratch3VariableWatcher): void;\r\n    /**\r\n     * Sets the value of the watcher to a new number.\r\n     */\r\n    set?(watcher: P.sb3.Scratch3VariableWatcher, value: number): void;\r\n    /**\r\n     * Evaluates the current value of the watcher. Called every visible frame.\r\n     */\r\n    evaluate(watcher: P.sb3.Scratch3VariableWatcher): any;\r\n    /**\r\n     * Determines the label to display in the watcher. Called once during initialization (after init)\r\n     */\r\n    getLabel(watcher: P.sb3.Scratch3VariableWatcher): string;\r\n  }\r\n\r\n  // IDs of primitive types\r\n  // https://github.com/LLK/scratch-vm/blob/36fe6378db930deb835e7cd342a39c23bb54dd72/src/serialization/sb3.js#L60-L79\r\n  const enum PrimitiveTypes {\r\n    MATH_NUM = 4,\r\n    POSITIVE_NUM = 5,\r\n    WHOLE_NUM = 6,\r\n    INTEGER_NUM = 7,\r\n    ANGLE_NUM = 8,\r\n    COLOR_PICKER = 9,\r\n    TEXT = 10,\r\n    BROADCAST = 11,\r\n    VAR = 12,\r\n    LIST = 13,\r\n  }\r\n\r\n  /**\r\n   * Maps opcodes of top level blocks to their handler\r\n   */\r\n  export const topLevelLibrary: ObjectMap<TopLevelCompiler> = {\r\n    // Events\r\n    event_whenflagclicked(block, f) {\r\n      currentTarget.listeners.whenGreenFlag.push(f);\r\n    },\r\n    event_whenkeypressed(block, f) {\r\n      const key = block.fields.KEY_OPTION[0];\r\n      if (key === 'any') {\r\n        for (var i = 128; i--;) {\r\n          currentTarget.listeners.whenKeyPressed[i].push(f);\r\n        }\r\n      } else {\r\n        currentTarget.listeners.whenKeyPressed[P.runtime.getKeyCode(key)].push(f);\r\n      }\r\n    },\r\n    event_whenthisspriteclicked(block, f) {\r\n      currentTarget.listeners.whenClicked.push(f);\r\n    },\r\n    event_whenstageclicked(block, f) {\r\n      currentTarget.listeners.whenClicked.push(f);\r\n    },\r\n    event_whenbackdropswitchesto(block, f) {\r\n      const backdrop = block.fields.BACKDROP[0];\r\n      if (!currentTarget.listeners.whenBackdropChanges[backdrop]) {\r\n        currentTarget.listeners.whenBackdropChanges[backdrop] = [];\r\n      }\r\n      currentTarget.listeners.whenBackdropChanges[backdrop].push(f);\r\n    },\r\n    event_whenbroadcastreceived(block, f) {\r\n      const name = block.fields.BROADCAST_OPTION[0].toLowerCase();\r\n      if (!currentTarget.listeners.whenIReceive[name]) {\r\n        currentTarget.listeners.whenIReceive[name] = [];\r\n      }\r\n      currentTarget.listeners.whenIReceive[name].push(f);\r\n    },\r\n\r\n    // Control\r\n    control_start_as_clone(block, f) {\r\n      currentTarget.listeners.whenCloned.push(f);\r\n    },\r\n\r\n    // Procedures\r\n    procedures_definition(block, f) {\r\n      const customBlockId = block.inputs.custom_block[1];\r\n      const mutation = blocks[customBlockId].mutation;\r\n\r\n      const proccode = mutation.proccode;\r\n      // Warp is either a boolean or a string representation of that boolean for some reason.\r\n      const warp = typeof mutation.warp === 'string' ? mutation.warp === 'true' : mutation.warp;\r\n      // It's a stringified JSON array.\r\n      const argumentNames = JSON.parse(mutation.argumentnames);\r\n\r\n      const procedure = new P.sb3.Scratch3Procedure(f, warp, argumentNames);\r\n      currentTarget.procedures[proccode] = procedure;\r\n    },\r\n\r\n    // Makey Makey (extension)\r\n    makeymakey_whenMakeyKeyPressed(block, f) {\r\n      const key = compileExpression(block.inputs.KEY);\r\n      const keyMap = {\r\n        // The key will be a full expression, including quotes around strings.\r\n        '\"SPACE\"': 'space',\r\n        '\"UP\"': 'up arrow',\r\n        '\"DOWN\"': 'down arrow',\r\n        '\"LEFT\"': 'left arrow',\r\n        '\"RIGHT\"': 'right arrow',\r\n        '\"w\"': 'w',\r\n        '\"a\"': 'a',\r\n        '\"s\"': 's',\r\n        '\"d\"': 'd',\r\n        '\"f\"': 'f',\r\n        '\"g\"': 'g',\r\n        // TODO: are other keys supported?\r\n        // TODO: support non-compile-time constants\r\n      };\r\n      if (keyMap.hasOwnProperty(key)) {\r\n        const keyCode = P.runtime.getKeyCode(keyMap[key]);\r\n        currentTarget.listeners.whenKeyPressed[keyCode].push(f);\r\n      } else {\r\n        console.warn('unknown makey makey key', key);\r\n      }\r\n    },\r\n  };\r\n\r\n  // An untyped undefined works as it does in Scratch 3.\r\n  // Becomes \"undefined\" when used as a string, becomes 0 when used as number, false when used as boolean.\r\n  const noopExpression = () => 'undefined';\r\n\r\n  /**\r\n   * Maps expression opcodes to their handler\r\n   */\r\n  export const expressionLibrary: ObjectMap<ExpressionCompiler> = {\r\n    // Motion\r\n    motion_goto_menu(block) {\r\n      const to = block.fields.TO[0];\r\n      return sanitizedExpression(to);\r\n    },\r\n    motion_glideto_menu(block) {\r\n      const to = block.fields.TO[0];\r\n      return sanitizedExpression(to);\r\n    },\r\n    motion_pointtowards_menu(block) {\r\n      const towards = block.fields.TOWARDS[0];\r\n      return sanitizedExpression(towards);\r\n    },\r\n    motion_xposition(block) {\r\n      return numberExpr('S.scratchX');\r\n    },\r\n    motion_yposition(block) {\r\n      return numberExpr('S.scratchY');\r\n    },\r\n    motion_direction() {\r\n      return numberExpr('S.direction');\r\n    },\r\n\r\n    // Looks\r\n    looks_costume(block) {\r\n      const costume = block.fields.COSTUME;\r\n      return sanitizedExpression(costume[0]);\r\n    },\r\n    looks_backdrops(block) {\r\n      const backdrop = block.fields.BACKDROP[0];\r\n      return sanitizedExpression(backdrop);\r\n    },\r\n    looks_costumenumbername(block) {\r\n      const name = block.fields.NUMBER_NAME[0];\r\n      if (name === 'number') {\r\n        return numberExpr('(S.currentCostumeIndex + 1)');\r\n      } else {\r\n        // `name` is probably 'name', but it doesn't matter\r\n        return stringExpr('S.costumes[S.currentCostumeIndex].name');\r\n      }\r\n    },\r\n    looks_backdropnumbername(block) {\r\n      const name = block.fields.NUMBER_NAME[0];\r\n      if (name === 'number') {\r\n        return numberExpr('(self.currentCostumeIndex + 1)');\r\n      } else {\r\n        // `name` is probably 'name', but it doesn't matter\r\n        return stringExpr('self.costumes[self.currentCostumeIndex].name');\r\n      }\r\n    },\r\n    looks_size() {\r\n      return numberExpr('(S.scale * 100)');\r\n    },\r\n\r\n    // Sounds\r\n    sound_sounds_menu(block) {\r\n      const sound = block.fields.SOUND_MENU[0];\r\n      return sanitizedExpression(sound);\r\n    },\r\n    sound_volume() {\r\n      return numberExpr('(S.volume * 100)');\r\n    },\r\n\r\n    // Control\r\n    control_create_clone_of_menu(block) {\r\n      const option = block.fields.CLONE_OPTION;\r\n      return sanitizedExpression(option[0]);\r\n    },\r\n    control_get_counter(block) {\r\n      return numberExpr('self.counter');\r\n    },\r\n\r\n    // Sensing\r\n    sensing_touchingobject(block) {\r\n      const object = block.inputs.TOUCHINGOBJECTMENU;\r\n      return booleanExpr('S.touching(' + compileExpression(object) + ')');\r\n    },\r\n    sensing_touchingobjectmenu(block) {\r\n      const object = block.fields.TOUCHINGOBJECTMENU;\r\n      return sanitizedExpression(object[0]);\r\n    },\r\n    sensing_touchingcolor(block) {\r\n      const color = block.inputs.COLOR;\r\n      return booleanExpr('S.touchingColor(' + compileExpression(color) + ')');\r\n    },\r\n    sensing_coloristouchingcolor(block) {\r\n      const color = block.inputs.COLOR;\r\n      const color2 = block.inputs.COLOR2;\r\n      return booleanExpr('S.colorTouchingColor(' + compileExpression(color) + ', ' + compileExpression(color2) + ')');\r\n    },\r\n    sensing_distanceto(block) {\r\n      const menu = block.inputs.DISTANCETOMENU;\r\n      return numberExpr('S.distanceTo(' + compileExpression(menu) + ')');\r\n    },\r\n    sensing_distancetomenu(block) {\r\n      return sanitizedExpression(block.fields.DISTANCETOMENU[0]);\r\n    },\r\n    sensing_answer(block) {\r\n      return stringExpr('self.answer');\r\n    },\r\n    sensing_keypressed(block) {\r\n      const key = block.inputs.KEY_OPTION;\r\n      return booleanExpr('!!self.keys[P.runtime.getKeyCode(' + compileExpression(key) + ')]');\r\n    },\r\n    sensing_keyoptions(block) {\r\n      const key = block.fields.KEY_OPTION[0];\r\n      return sanitizedExpression(key);\r\n    },\r\n    sensing_mousedown(block) {\r\n      return booleanExpr('self.mousePressed');\r\n    },\r\n    sensing_mousex(block) {\r\n      return numberExpr('self.mouseX');\r\n    },\r\n    sensing_mousey(block) {\r\n      return numberExpr('self.mouseY');\r\n    },\r\n    sensing_loudness(block) {\r\n      // We don't implement loudness, we always return -1 which indicates that there is no microphone available.\r\n      return numberExpr('-1');\r\n    },\r\n    sensing_loud(block) {\r\n      // see sensing_loudness above\r\n      return booleanExpr('false');\r\n    },\r\n    sensing_timer(block) {\r\n      if (P.config.preciseTimers) {\r\n        return numberExpr('((runtime.rightNow() - runtime.timerStart) / 1000)');\r\n      } else {\r\n        return numberExpr('((runtime.now - runtime.timerStart) / 1000)');\r\n      }\r\n    },\r\n    sensing_of(block) {\r\n      const property = block.fields.PROPERTY[0];\r\n      const object = block.inputs.OBJECT;\r\n      return 'attribute(' + sanitizedString(property) + ', ' + compileExpression(object, 'string') + ')';\r\n    },\r\n    sensing_of_object_menu(block) {\r\n      const object = block.fields.OBJECT[0];\r\n      return sanitizedExpression(object);\r\n    },\r\n    sensing_current(block) {\r\n      const current = block.fields.CURRENTMENU[0].toLowerCase();\r\n\r\n      switch (current) {\r\n        case 'year': return numberExpr('new Date().getFullYear()');\r\n        case 'month': return numberExpr('(new Date().getMonth() + 1)');\r\n        case 'date': return numberExpr('new Date().getDate()');\r\n        case 'dayofweek': return numberExpr('(new Date().getDay() + 1)');\r\n        case 'hour': return numberExpr('new Date().getHours()');\r\n        case 'minute': return numberExpr('new Date().getMinutes()');\r\n        case 'second': return numberExpr('new Date().getSeconds()');\r\n      }\r\n\r\n      return numberExpr('0');\r\n    },\r\n    sensing_dayssince2000(block) {\r\n      return numberExpr('((Date.now() - epoch) / 86400000)');\r\n    },\r\n    sensing_username(block) {\r\n      return stringExpr('self.username');\r\n    },\r\n\r\n    // Operators\r\n    operator_add(block) {\r\n      const num1 = block.inputs.NUM1;\r\n      const num2 = block.inputs.NUM2;\r\n      return numberExpr('(' + compileExpression(num1, 'number') + ' + ' + compileExpression(num2, 'number') + ' || 0)');\r\n    },\r\n    operator_subtract(block) {\r\n      const num1 = block.inputs.NUM1;\r\n      const num2 = block.inputs.NUM2;\r\n      return numberExpr('(' + compileExpression(num1, 'number') + ' - ' + compileExpression(num2, 'number') + ' || 0)');\r\n    },\r\n    operator_multiply(block) {\r\n      const num1 = block.inputs.NUM1;\r\n      const num2 = block.inputs.NUM2;\r\n      return numberExpr('(' + compileExpression(num1, 'number') + ' * ' + compileExpression(num2, 'number') + ' || 0)');\r\n    },\r\n    operator_divide(block) {\r\n      const num1 = block.inputs.NUM1;\r\n      const num2 = block.inputs.NUM2;\r\n      return numberExpr('(' + compileExpression(num1, 'number') + ' / ' + compileExpression(num2, 'number') + ' || 0)');\r\n    },\r\n    operator_random(block) {\r\n      const from = block.inputs.FROM;\r\n      const to = block.inputs.TO;\r\n      return numberExpr('random(' + compileExpression(from, 'number') + ', ' + compileExpression(to, 'number') + ')');\r\n    },\r\n    operator_gt(block) {\r\n      const operand1 = block.inputs.OPERAND1;\r\n      const operand2 = block.inputs.OPERAND2;\r\n      // TODO: use numGreater?\r\n      return booleanExpr('(compare(' + compileExpression(operand1) + ', ' + compileExpression(operand2) + ') === 1)');\r\n    },\r\n    operator_lt(block) {\r\n      const operand1 = block.inputs.OPERAND1;\r\n      const operand2 = block.inputs.OPERAND2;\r\n      // TODO: use numLess?\r\n      return booleanExpr('(compare(' + compileExpression(operand1) + ', ' + compileExpression(operand2) + ') === -1)');\r\n    },\r\n    operator_equals(block) {\r\n      const operand1 = block.inputs.OPERAND1;\r\n      const operand2 = block.inputs.OPERAND2;\r\n      return booleanExpr('equal(' + compileExpression(operand1) + ', ' + compileExpression(operand2) + ')');\r\n    },\r\n    operator_and(block) {\r\n      const operand1 = block.inputs.OPERAND1;\r\n      const operand2 = block.inputs.OPERAND2;\r\n      return booleanExpr('(' + compileExpression(operand1) + ' && ' + compileExpression(operand2) + ')');\r\n    },\r\n    operator_or(block) {\r\n      const operand1 = block.inputs.OPERAND1;\r\n      const operand2 = block.inputs.OPERAND2;\r\n      return booleanExpr('(' + compileExpression(operand1) + ' || ' + compileExpression(operand2) + ')');\r\n    },\r\n    operator_not(block) {\r\n      const operand = block.inputs.OPERAND;\r\n      return booleanExpr('!' + compileExpression(operand));\r\n    },\r\n    operator_join(block) {\r\n      const string1 = block.inputs.STRING1;\r\n      const string2 = block.inputs.STRING2;\r\n      return stringExpr('(' + compileExpression(string1, 'string') + ' + ' + compileExpression(string2, 'string') + ')');\r\n    },\r\n    operator_letter_of(block) {\r\n      const string = block.inputs.STRING;\r\n      const letter = block.inputs.LETTER;\r\n      return stringExpr('((' + compileExpression(string, 'string') + ')[(' + compileExpression(letter, 'number') + ' | 0) - 1] || \"\")');\r\n    },\r\n    operator_length(block) {\r\n      const string = block.inputs.STRING;\r\n      // TODO: parenthesis important?\r\n      return numberExpr('(' + compileExpression(string, 'string') + ').length');\r\n    },\r\n    operator_contains(block) {\r\n      const string1 = block.inputs.STRING1;\r\n      const string2 = block.inputs.STRING2;\r\n      return booleanExpr(compileExpression(string1, 'string') + '.includes(' + compileExpression(string2, 'string') + ')');\r\n    },\r\n    operator_mod(block) {\r\n      const num1 = block.inputs.NUM1;\r\n      const num2 = block.inputs.NUM2;\r\n      return numberExpr('mod(' + compileExpression(num1, 'number') + ', ' + compileExpression(num2, 'number') + ')');\r\n    },\r\n    operator_round(block) {\r\n      const num = block.inputs.NUM;\r\n      return numberExpr('Math.round(' + compileExpression(num, 'number') + ')');\r\n    },\r\n    operator_mathop(block) {\r\n      const operator = block.fields.OPERATOR[0];\r\n      const num = block.inputs.NUM;\r\n      const compiledNum = compileExpression(num, 'number');\r\n\r\n      switch (operator) {\r\n        case 'abs':\r\n          return numberExpr(`Math.abs(${compiledNum})`);\r\n        case 'floor':\r\n          return numberExpr(`Math.floor(${compiledNum})`);\r\n        case 'sqrt':\r\n          return numberExpr(`Math.sqrt(${compiledNum})`);\r\n        case 'ceiling':\r\n          return numberExpr(`Math.ceil(${compiledNum})`);\r\n        case 'cos':\r\n          return numberExpr(`Math.cos(${compiledNum} * Math.PI / 180)`);\r\n        case 'sin':\r\n          return numberExpr(`Math.sin(${compiledNum} * Math.PI / 180)`);\r\n        case 'tan':\r\n          return numberExpr(`Math.tan(${compiledNum} * Math.PI / 180)`);\r\n        case 'asin':\r\n          return numberExpr(`(Math.asin(${compiledNum}) * 180 / Math.PI)`)\r\n        case 'acos':\r\n          return numberExpr(`(Math.acos(${compiledNum}) * 180 / Math.PI)`)\r\n        case 'atan':\r\n          return numberExpr(`(Math.atan(${compiledNum}) * 180 / Math.PI)`)\r\n        case 'ln':\r\n          return numberExpr(`Math.log(${compiledNum})`);\r\n        case 'log':\r\n          return numberExpr(`(Math.log(${compiledNum}) / Math.LN10)`);\r\n        case 'e ^':\r\n          return numberExpr(`Math.exp(${compiledNum})`);\r\n        case '10 ^':\r\n          return numberExpr(`Math.exp(${compiledNum} * Math.LN10)`);\r\n        default:\r\n          return numberExpr('0');\r\n      }\r\n    },\r\n\r\n    // Data\r\n    data_itemoflist(block) {\r\n      const list = block.fields.LIST[1];\r\n      const index = block.inputs.INDEX;\r\n      return 'getLineOfList(' + listReference(list) + ', ' + compileExpression(index) + ')';\r\n    },\r\n    data_itemnumoflist(block) {\r\n      const list = block.fields.LIST[1];\r\n      const item = block.inputs.ITEM;\r\n      return numberExpr('listIndexOf(' + listReference(list) + ', ' + compileExpression(item) + ')');\r\n    },\r\n    data_lengthoflist(block) {\r\n      const list = block.fields.LIST[1];\r\n      return numberExpr(listReference(list) + '.length');\r\n    },\r\n    data_listcontainsitem(block) {\r\n      const list = block.fields.LIST[1];\r\n      const item = block.inputs.ITEM;\r\n      return booleanExpr('listContains(' + listReference(list) + ', ' + compileExpression(item) + ')');\r\n    },\r\n\r\n    // Procedures/arguments\r\n    argument_reporter_string_number(block) {\r\n      const name = block.fields.VALUE[0];\r\n      return 'C.args[' + sanitizedString(name) + ']';\r\n    },\r\n    argument_reporter_boolean(block) {\r\n      const name = block.fields.VALUE[0];\r\n      // Forcibly convert to boolean\r\n      return booleanExpr(asType('C.args[' + sanitizedString(name) + ']', 'boolean'));\r\n    },\r\n\r\n    // The matrix, a little known expression. Only used in some of the robot extensions.\r\n    matrix(block) {\r\n      const matrix = block.fields.MATRIX[0];\r\n      // This is a string, not a number. It's not to be treated as binary digits to convert to base 10.\r\n      return sanitizedExpression(matrix);\r\n    },\r\n\r\n    // Pen (extension)\r\n    pen_menu_colorParam(block) {\r\n      const colorParam = block.fields.colorParam[0];\r\n      return sanitizedExpression(colorParam);\r\n    },\r\n\r\n    // Music (extension)\r\n    music_getTempo(block) {\r\n      return numberExpr('self.tempoBPM');\r\n    },\r\n\r\n    // Makey Makey (extension)\r\n    makeymakey_menu_KEY(block) {\r\n      const key = block.fields.KEY[0];\r\n      return sanitizedExpression(key);\r\n    },\r\n\r\n    // Legacy no-ops\r\n    // https://github.com/LLK/scratch-vm/blob/bb42c0019c60f5d1947f3432038aa036a0fddca6/src/blocks/scratch3_sensing.js#L74\r\n    sensing_userid: noopExpression,\r\n    // https://github.com/LLK/scratch-vm/blob/bb42c0019c60f5d1947f3432038aa036a0fddca6/src/blocks/scratch3_motion.js#L42-L43\r\n    motion_xscroll: noopExpression,\r\n    motion_yscroll: noopExpression,\r\n  };\r\n\r\n  const noopStatement = () => { source += '/* noop */\\n'};\r\n\r\n  /**\r\n   * Maps statement opcodes to their handler\r\n   */\r\n  export const statementLibrary: ObjectMap<StatementCompiler> = {\r\n    // Motion\r\n    motion_movesteps(block) {\r\n      const steps = block.inputs.STEPS;\r\n      source += 'S.forward(' + compileExpression(steps, 'number') + ');\\n';\r\n      visualCheck('drawing');\r\n    },\r\n    motion_turnright(block) {\r\n      const degrees = block.inputs.DEGREES;\r\n      source += 'S.setDirection(S.direction + ' + compileExpression(degrees, 'number') + ');\\n';\r\n      visualCheck('visible');\r\n    },\r\n    motion_turnleft(block) {\r\n      const degrees = block.inputs.DEGREES;\r\n      source += 'S.setDirection(S.direction - ' + compileExpression(degrees, 'number') + ');\\n';\r\n      visualCheck('visible');\r\n    },\r\n    motion_goto(block) {\r\n      const to = block.inputs.TO;\r\n      source += 'S.gotoObject(' + compileExpression(to) + ');\\n';\r\n      visualCheck('drawing');\r\n    },\r\n    motion_gotoxy(block) {\r\n      const x = block.inputs.X;\r\n      const y = block.inputs.Y;\r\n      source += 'S.moveTo(' + compileExpression(x, 'number') + ', ' + compileExpression(y, 'number') + ');\\n';\r\n      visualCheck('drawing');\r\n    },\r\n    motion_glideto(block) {\r\n      const secs = block.inputs.SECS;\r\n      const to = block.inputs.TO;\r\n\r\n      visualCheck('drawing');\r\n      source += 'save();\\n';\r\n      source += 'R.start = runtime.now;\\n';\r\n      source += 'R.duration = ' + compileExpression(secs) + ';\\n';\r\n      source += 'R.baseX = S.scratchX;\\n';\r\n      source += 'R.baseY = S.scratchY;\\n';\r\n      source += 'var to = self.getPosition(' + compileExpression(to) + ');\\n';\r\n      source += 'if (to) {';\r\n      source += '  R.deltaX = to.x - S.scratchX;\\n';\r\n      source += '  R.deltaY = to.y - S.scratchY;\\n';\r\n      const id = label();\r\n      source += '  var f = (runtime.now - R.start) / (R.duration * 1000);\\n';\r\n      source += '  if (f > 1 || isNaN(f)) f = 1;\\n';\r\n      source += '  S.moveTo(R.baseX + f * R.deltaX, R.baseY + f * R.deltaY);\\n';\r\n      source += '  if (f < 1) {\\n';\r\n      forceQueue(id);\r\n      source += '  }\\n';\r\n      source += '  restore();\\n';\r\n      source += '}\\n';\r\n    },\r\n    motion_glidesecstoxy(block) {\r\n      const secs = block.inputs.SECS;\r\n      const x = block.inputs.X;\r\n      const y = block.inputs.Y;\r\n\r\n      visualCheck('drawing');\r\n      source += 'save();\\n';\r\n      source += 'R.start = runtime.now;\\n';\r\n      source += 'R.duration = ' + compileExpression(secs) + ';\\n';\r\n      source += 'R.baseX = S.scratchX;\\n';\r\n      source += 'R.baseY = S.scratchY;\\n';\r\n      source += 'R.deltaX = ' + compileExpression(x) + ' - S.scratchX;\\n';\r\n      source += 'R.deltaY = ' + compileExpression(y) + ' - S.scratchY;\\n';\r\n      const id = label();\r\n      source += 'var f = (runtime.now - R.start) / (R.duration * 1000);\\n';\r\n      source += 'if (f > 1) f = 1;\\n';\r\n      source += 'S.moveTo(R.baseX + f * R.deltaX, R.baseY + f * R.deltaY);\\n';\r\n      source += 'if (f < 1) {\\n';\r\n      forceQueue(id);\r\n      source += '}\\n';\r\n      source += 'restore();\\n';\r\n    },\r\n    motion_pointindirection(block) {\r\n      const direction = block.inputs.DIRECTION;\r\n      visualCheck('visible');\r\n      source += 'S.direction = ' + compileExpression(direction) + ';\\n';\r\n    },\r\n    motion_pointtowards(block) {\r\n      const towards = block.inputs.TOWARDS;\r\n      source += 'S.pointTowards(' + compileExpression(towards) + ');\\n';\r\n      visualCheck('visible');\r\n    },\r\n    motion_changexby(block) {\r\n      const dx = block.inputs.DX;\r\n      source += 'S.moveTo(S.scratchX + ' + compileExpression(dx, 'number') + ', S.scratchY);\\n';\r\n      visualCheck('drawing');\r\n    },\r\n    motion_setx(block) {\r\n      const x = block.inputs.X;\r\n      source += 'S.moveTo(' + compileExpression(x, 'number') + ', S.scratchY);\\n';\r\n      visualCheck('drawing');\r\n    },\r\n    motion_changeyby(block) {\r\n      const dy = block.inputs.DY;\r\n      source += 'S.moveTo(S.scratchX, S.scratchY + ' + compileExpression(dy, 'number') + ');\\n';\r\n      visualCheck('drawing');\r\n    },\r\n    motion_sety(block) {\r\n      const y = block.inputs.Y;\r\n      source += 'S.moveTo(S.scratchX, ' + compileExpression(y, 'number') + ');\\n';\r\n      visualCheck('drawing');\r\n    },\r\n    motion_ifonedgebounce(block) {\r\n      // TODO: set visual if bounced\r\n      source += 'S.bounceOffEdge();\\n';\r\n    },\r\n    motion_setrotationstyle(block) {\r\n      const style = block.fields.STYLE[0];\r\n      source += 'S.rotationStyle = ' + P.utils.parseRotationStyle(style) + ';\\n';\r\n      visualCheck('visible');\r\n    },\r\n\r\n    // Looks\r\n    looks_sayforsecs(block) {\r\n      const message = block.inputs.MESSAGE;\r\n      const secs = block.inputs.SECS;\r\n      source += 'save();\\n';\r\n      source += 'R.id = S.say(' + compileExpression(message) + ', false);\\n';\r\n      source += 'R.start = runtime.now;\\n';\r\n      source += 'R.duration = ' + compileExpression(secs, 'number') + ';\\n';\r\n      const id = label();\r\n      source += 'if (runtime.now - R.start < R.duration * 1000) {\\n';\r\n      forceQueue(id);\r\n      source += '}\\n';\r\n      source += 'if (S.sayId === R.id) {\\n';\r\n      source += '  S.say(\"\");\\n';\r\n      source += '}\\n';\r\n      source += 'restore();\\n';\r\n      visualCheck('visible');\r\n    },\r\n    looks_say(block) {\r\n      const message = block.inputs.MESSAGE;\r\n      source += 'S.say(' + compileExpression(message) + ', false);\\n';\r\n      visualCheck('visible');\r\n    },\r\n    looks_thinkforsecs(block) {\r\n      const message = block.inputs.MESSAGE;\r\n      const secs = block.inputs.SECS;\r\n      source += 'save();\\n';\r\n      source += 'R.id = S.say(' + compileExpression(message) + ', true);\\n';\r\n      source += 'R.start = runtime.now;\\n';\r\n      source += 'R.duration = ' + compileExpression(secs, 'number') + ';\\n';\r\n      const id = label();\r\n      source += 'if (runtime.now - R.start < R.duration * 1000) {\\n';\r\n      forceQueue(id);\r\n      source += '}\\n';\r\n      source += 'if (S.sayId === R.id) {\\n';\r\n      source += '  S.say(\"\");\\n';\r\n      source += '}\\n';\r\n      source += 'restore();\\n';\r\n      visualCheck('visible');\r\n    },\r\n    looks_think(block) {\r\n      const message = block.inputs.MESSAGE;\r\n      source += 'S.say(' + compileExpression(message) + ', true);\\n';\r\n      visualCheck('visible');\r\n    },\r\n    looks_switchcostumeto(block) {\r\n      const costume = block.inputs.COSTUME;\r\n      source += 'S.setCostume(' + compileExpression(costume) + ');\\n';\r\n      visualCheck('visible');\r\n    },\r\n    looks_nextcostume(block) {\r\n      source += 'S.showNextCostume();\\n';\r\n      visualCheck('visible');\r\n    },\r\n    looks_switchbackdropto(block) {\r\n      const backdrop = block.inputs.BACKDROP;\r\n      source += 'self.setCostume(' + compileExpression(backdrop) + ');\\n';\r\n      visualCheck('always');\r\n      source += 'var threads = backdropChange();\\n';\r\n      source += 'if (threads.indexOf(BASE) !== -1) {return;}\\n';\r\n    },\r\n    looks_nextbackdrop(block) {\r\n      source += 'self.showNextCostume();\\n';\r\n      visualCheck('always');\r\n      source += 'var threads = backdropChange();\\n';\r\n      source += 'if (threads.indexOf(BASE) !== -1) {return;}\\n';\r\n    },\r\n    looks_changesizeby(block) {\r\n      const change = block.inputs.CHANGE;\r\n      source += 'var f = S.scale + ' + compileExpression(change) + ' / 100;\\n';\r\n      source += 'S.scale = f < 0 ? 0 : f;\\n';\r\n      visualCheck('visible');\r\n    },\r\n    looks_setsizeto(block) {\r\n      const size = block.inputs.SIZE;\r\n      source += 'var f = ' + compileExpression(size) + ' / 100;\\n';\r\n      source += 'S.scale = f < 0 ? 0 : f;\\n';\r\n      visualCheck('visible');\r\n    },\r\n    looks_changeeffectby(block) {\r\n      const effect = block.fields.EFFECT[0];\r\n      const change = block.inputs.CHANGE;\r\n      source += 'S.changeFilter(' + sanitizedString(effect).toLowerCase() + ', ' + compileExpression(change, 'number') + ');\\n';\r\n      visualCheck('visible');\r\n    },\r\n    looks_seteffectto(block) {\r\n      const effect = block.fields.EFFECT[0];\r\n      const value = block.inputs.VALUE;\r\n      // Lowercase conversion is necessary to remove capitals, which we do not want.\r\n      source += 'S.setFilter(' + sanitizedString(effect).toLowerCase() + ', ' + compileExpression(value, 'number') + ');\\n';\r\n      visualCheck('visible');\r\n    },\r\n    looks_cleargraphiceffects(block) {\r\n      source += 'S.resetFilters();\\n';\r\n      visualCheck('visible');\r\n    },\r\n    looks_show(block) {\r\n      source += 'S.visible = true;\\n';\r\n      visualCheck('always');\r\n      updateBubble();\r\n    },\r\n    looks_hide(block) {\r\n      visualCheck('visible');\r\n      source += 'S.visible = false;\\n';\r\n      updateBubble();\r\n    },\r\n    looks_gotofrontback(block) {\r\n      const frontBack = block.fields.FRONT_BACK[0];\r\n      source += 'var i = self.children.indexOf(S);\\n';\r\n      source += 'if (i !== -1) self.children.splice(i, 1);\\n';\r\n      if (frontBack === 'front') {\r\n        source += 'self.children.push(S);\\n';\r\n      } else {\r\n        // `frontBack` is probably 'back', but it doesn't matter\r\n        source += 'self.children.unshift(S);\\n';\r\n      }\r\n    },\r\n    looks_goforwardbackwardlayers(block) {\r\n      const direction = block.fields.FORWARD_BACKWARD[0];\r\n      const number = block.inputs.NUM;\r\n      source += 'var i = self.children.indexOf(S);\\n';\r\n      source += 'if (i !== -1) {\\n';\r\n      source += '  self.children.splice(i, 1);\\n';\r\n      if (direction === 'forward') {\r\n        source += '  self.children.splice(Math.min(self.children.length - 1, i + ' + compileExpression(number) + '), 0, S);\\n';\r\n      } else {\r\n        // `direction` is probably 'backward', but it doesn't matter\r\n        source += '  self.children.splice(Math.max(0, i - ' + compileExpression(number) + '), 0, S);\\n';\r\n      }\r\n      source += '}\\n';\r\n    },\r\n\r\n    // Sounds\r\n    sound_playuntildone(block) {\r\n      const sound = block.inputs.SOUND_MENU;\r\n      source += 'var sound = S.getSound(' + compileExpression(sound) + ');\\n';\r\n      source += 'if (sound) {\\n';\r\n      source += '  playSound(sound);\\n';\r\n      wait('sound.duration');\r\n      source += '}\\n';\r\n    },\r\n    sound_play(block) {\r\n      const sound = block.inputs.SOUND_MENU;\r\n      source += 'var sound = S.getSound(' + compileExpression(sound) + ');\\n';\r\n      source += 'if (sound) {\\n';\r\n      source += '  playSound(sound);\\n';\r\n      source += '}\\n';\r\n    },\r\n    sound_stopallsounds(block) {\r\n      if (P.audio.context) {\r\n        source += 'self.stopAllSounds();\\n';\r\n      }\r\n    },\r\n    sound_changevolumeby(block) {\r\n      const volume = block.inputs.VOLUME;\r\n      source += 'S.volume = Math.max(0, Math.min(1, S.volume + ' + compileExpression(volume, 'number') + ' / 100));\\n';\r\n      source += 'if (S.node) S.node.gain.setValueAtTime(S.volume, audioContext.currentTime);\\n';\r\n      source += 'for (var sounds = S.sounds, i = sounds.length; i--;) {\\n';\r\n      source += '  var sound = sounds[i];\\n';\r\n      source += '  if (sound.node && sound.target === S) {\\n';\r\n      source += '    sound.node.gain.setValueAtTime(S.volume, audioContext.currentTime);\\n';\r\n      source += '  }\\n';\r\n      source += '}\\n';\r\n    },\r\n    sound_setvolumeto(block) {\r\n      const volume = block.inputs.VOLUME;\r\n      source += 'S.volume = Math.max(0, Math.min(1, ' + compileExpression(volume, 'number') + ' / 100));\\n';\r\n      source += 'if (S.node) S.node.gain.setValueAtTime(S.volume, audioContext.currentTime);\\n';\r\n      source += 'for (var sounds = S.sounds, i = sounds.length; i--;) {\\n';\r\n      source += '  var sound = sounds[i];\\n';\r\n      source += '  if (sound.node && sound.target === S) {\\n';\r\n      source += '    sound.node.gain.setValueAtTime(S.volume, audioContext.currentTime);\\n';\r\n      source += '  }\\n';\r\n      source += '}\\n';\r\n    },\r\n\r\n    // Event\r\n    event_broadcast(block) {\r\n      const input = block.inputs.BROADCAST_INPUT;\r\n      source += 'var threads = broadcast(' + compileExpression(input) + ');\\n';\r\n      source += 'if (threads.indexOf(BASE) !== -1) {return;}\\n';\r\n    },\r\n    event_broadcastandwait(block) {\r\n      const input = block.inputs.BROADCAST_INPUT;\r\n      source += 'save();\\n';\r\n      source += 'R.threads = broadcast(' + compileExpression(input) + ');\\n';\r\n      source += 'if (R.threads.indexOf(BASE) !== -1) {return;}\\n';\r\n      const id = label();\r\n      source += 'if (running(R.threads)) {\\n';\r\n      forceQueue(id);\r\n      source += '}\\n';\r\n      source += 'restore();\\n';\r\n    },\r\n\r\n    // Control\r\n    control_wait(block) {\r\n      const duration = block.inputs.DURATION;\r\n      source += 'save();\\n';\r\n      source += 'R.start = runtime.now;\\n';\r\n      source += 'R.duration = ' + compileExpression(duration) + ';\\n';\r\n      source += 'var first = true;\\n';\r\n      const id = label();\r\n      source += 'if (runtime.now - R.start < R.duration * 1000 || first) {\\n';\r\n      source += '  var first;\\n';\r\n      forceQueue(id);\r\n      source += '}\\n';\r\n      source += 'restore();\\n';\r\n    },\r\n    control_repeat(block) {\r\n      const times = block.inputs.TIMES;\r\n      const substack = block.inputs.SUBSTACK;\r\n      source += 'save();\\n';\r\n      source += 'R.count = ' + compileExpression(times) + ';\\n';\r\n      const id = label();\r\n      source += 'if (R.count >= 0.5) {\\n';\r\n      source += '  R.count -= 1;\\n';\r\n      compileSubstack(substack);\r\n      queue(id);\r\n      source += '} else {\\n';\r\n      source += '  restore();\\n';\r\n      source += '}\\n';\r\n    },\r\n    control_forever(block) {\r\n      const substack = block.inputs.SUBSTACK;\r\n      const id = label();\r\n      compileSubstack(substack);\r\n      queue(id);\r\n    },\r\n    control_if(block) {\r\n      const condition = block.inputs.CONDITION;\r\n      const substack = block.inputs.SUBSTACK;\r\n      source += 'if (' + compileExpression(condition) + ') {\\n';\r\n      compileSubstack(substack);\r\n      source += '}\\n';\r\n    },\r\n    control_if_else(block) {\r\n      const condition = block.inputs.CONDITION;\r\n      const substack1 = block.inputs.SUBSTACK;\r\n      const substack2 = block.inputs.SUBSTACK2;\r\n      source += 'if (' + compileExpression(condition) + ') {\\n';\r\n      compileSubstack(substack1);\r\n      source += '} else {\\n';\r\n      compileSubstack(substack2);\r\n      source += '}\\n';\r\n    },\r\n    control_wait_until(block) {\r\n      const condition = block.inputs.CONDITION;\r\n      const id = label();\r\n      source += 'if (!' + compileExpression(condition) + ') {\\n';\r\n      queue(id);\r\n      source += '}\\n';\r\n    },\r\n    control_repeat_until(block) {\r\n      const condition = block.inputs.CONDITION;\r\n      const substack = block.inputs.SUBSTACK;\r\n      const id = label();\r\n      source += 'if (!' + compileExpression(condition, 'boolean') + ') {\\n';\r\n      compileSubstack(substack);\r\n      queue(id);\r\n      source += '}\\n';\r\n    },\r\n    control_while(block) {\r\n      // Hacked block\r\n      const condition = block.inputs.CONDITION;\r\n      const substack = block.inputs.SUBSTACK;\r\n      const id = label();\r\n      source += 'if (' + compileExpression(condition, 'boolean') + ') {\\n';\r\n      compileSubstack(substack);\r\n      queue(id);\r\n      source += '}\\n';\r\n    },\r\n    control_all_at_once(block) {\r\n      // https://github.com/LLK/scratch-vm/blob/bb42c0019c60f5d1947f3432038aa036a0fddca6/src/blocks/scratch3_control.js#L194-L199\r\n      const substack = block.inputs.SUBSTACK;\r\n      compileSubstack(substack);\r\n    },\r\n    control_stop(block) {\r\n      const option = block.fields.STOP_OPTION[0];\r\n\r\n      switch (option) {\r\n        case 'all':\r\n          source += 'runtime.stopAll();\\n';\r\n          source += 'return;\\n';\r\n          break;\r\n        case 'this script':\r\n          source += 'endCall();\\n';\r\n          source += 'return;\\n';\r\n          break;\r\n        case 'other scripts in sprite':\r\n        case 'other scripts in stage':\r\n          source += 'for (var i = 0; i < runtime.queue.length; i++) {\\n';\r\n          source += '  if (i !== THREAD && runtime.queue[i] && runtime.queue[i].sprite === S) {\\n';\r\n          source += '    runtime.queue[i] = undefined;\\n';\r\n          source += '  }\\n';\r\n          source += '}\\n';\r\n          break;\r\n        default:\r\n          // If the field is not recognized or not a compile-time constant, then fallback to a large switch statement.\r\n          source += 'switch (' + sanitizedString(option) + ') {\\n';\r\n          source += '  case \"all\":\\n';\r\n          source += '    runtime.stopAll();\\n';\r\n          source += '    return;\\n';\r\n          source += '  case \"this script\":\\n';\r\n          source += '    endCall();\\n';\r\n          source += '    return;\\n';\r\n          source += '  case \"other scripts in sprite\":\\n';\r\n          source += '  case \"other scripts in stage\":\\n';\r\n          source += '    for (var i = 0; i < runtime.queue.length; i++) {\\n';\r\n          source += '      if (i !== THREAD && runtime.queue[i] && runtime.queue[i].sprite === S) {\\n';\r\n          source += '        runtime.queue[i] = undefined;\\n';\r\n          source += '      }\\n';\r\n          source += '    }\\n';\r\n          source += '    break;\\n';\r\n          source += '}\\n';\r\n      }\r\n    },\r\n    control_create_clone_of(block) {\r\n      const option = block.inputs.CLONE_OPTION;\r\n      source += 'clone(' + compileExpression(option) + ');\\n';\r\n    },\r\n    control_delete_this_clone(block) {\r\n      source += 'if (S.isClone) {\\n';\r\n      source += '  S.remove();\\n';\r\n      source += '  var i = self.children.indexOf(S);\\n';\r\n      source += '  if (i !== -1) self.children.splice(i, 1);\\n';\r\n      source += '  for (var i = 0; i < runtime.queue.length; i++) {\\n';\r\n      source += '    if (runtime.queue[i] && runtime.queue[i].sprite === S) {\\n';\r\n      source += '      runtime.queue[i] = undefined;\\n';\r\n      source += '    }\\n';\r\n      source += '  }\\n';\r\n      source += '  return;\\n';\r\n      source += '}\\n';\r\n    },\r\n    control_incr_counter(block) {\r\n      source += 'self.counter++;\\n';\r\n    },\r\n    control_clear_counter(block) {\r\n      source += 'self.counter = 0;\\n';\r\n    },\r\n\r\n    // Sensing\r\n    sensing_askandwait(block) {\r\n      const question = block.inputs.QUESTION;\r\n      source += 'R.id = self.nextPromptId++;\\n';\r\n      // 1 - wait until we are next up for the asking\r\n      const id1 = label();\r\n      source += 'if (self.promptId < R.id) {\\n';\r\n      forceQueue(id1);\r\n      source += '}\\n';\r\n\r\n      source += 'S.ask(' + compileExpression(question, 'string') + ');\\n';\r\n      // 2 - wait until the prompt has been answered\r\n      const id2 = label();\r\n      source += 'if (self.promptId === R.id) {\\n';\r\n      forceQueue(id2);\r\n      source += '}\\n';\r\n\r\n      visualCheck('always');\r\n    },\r\n    sensing_setdragmode(block) {\r\n      const dragMode = block.fields.DRAG_MODE[0];\r\n      if (dragMode === 'draggable') {\r\n        source += 'S.isDraggable = true;\\n';\r\n      } else {\r\n        // it doesn't matter what `dragMode` is at this point\r\n        source += 'S.isDraggable = false;\\n';\r\n      }\r\n    },\r\n    sensing_resettimer(blocK) {\r\n      source += 'runtime.timerStart = runtime.now;\\n';\r\n    },\r\n\r\n    // Data\r\n    data_setvariableto(block) {\r\n      const variableId = block.fields.VARIABLE[1];\r\n      const value = block.inputs.VALUE;\r\n      source += variableReference(variableId) + ' = ' + compileExpression(value) + ';\\n';\r\n    },\r\n    data_changevariableby(block) {\r\n      const variableId = block.fields.VARIABLE[1];\r\n      const value = block.inputs.VALUE;\r\n      const ref = variableReference(variableId);\r\n      source += ref + ' = (' + asType(ref, 'number') + ' + ' + compileExpression(value, 'number') + ');\\n';\r\n    },\r\n    data_showvariable(block) {\r\n      const variable = block.fields.VARIABLE[1];\r\n      const scope = variableScope(variable);\r\n      source += scope + '.showVariable(' + sanitizedString(variable) + ', true);\\n';\r\n    },\r\n    data_hidevariable(block) {\r\n      const variable = block.fields.VARIABLE[1];\r\n      const scope = variableScope(variable);\r\n      source += scope + '.showVariable(' + sanitizedString(variable) + ', false);\\n';\r\n    },\r\n    data_showlist(block) {\r\n      const list = block.fields.LIST[1];\r\n      const scope = listScope(list);\r\n      source += scope + '.showVariable(' + sanitizedString(list) + ', true);\\n';\r\n    },\r\n    data_hidelist(block) {\r\n      const list = block.fields.LIST[1];\r\n      const scope = listScope(list);\r\n      source += scope + '.showVariable(' + sanitizedString(list) + ', false);\\n';\r\n    },\r\n    data_addtolist(block) {\r\n      const list = block.fields.LIST[1];\r\n      const item = block.inputs.ITEM;\r\n      source += listReference(list) + '.push(' + compileExpression(item)  + ');\\n';\r\n    },\r\n    data_deleteoflist(block) {\r\n      const list = block.fields.LIST[1];\r\n      const index = block.inputs.INDEX;\r\n      source += listReference(list) + '.deleteLine(' + compileExpression(index) + ');\\n';\r\n    },\r\n    data_deletealloflist(block) {\r\n      const list = block.fields.LIST[1];\r\n      source += listReference(list) + '.deleteLine(\"all\");\\n';\r\n    },\r\n    data_insertatlist(block) {\r\n      const list = block.fields.LIST[1];\r\n      const item = block.inputs.ITEM;\r\n      const index = block.inputs.INDEX;\r\n      source += listReference(list) + '.insert(' + compileExpression(index) + ', ' + compileExpression(item) + ');\\n';\r\n    },\r\n    data_replaceitemoflist(block) {\r\n      const list = block.fields.LIST[1];\r\n      const item = block.inputs.ITEM;\r\n      const index = block.inputs.INDEX;\r\n      source += listReference(list) + '.set(' + compileExpression(index) + ', ' + compileExpression(item) + ');\\n';\r\n    },\r\n\r\n    // Procedures\r\n    procedures_call(block) {\r\n      const mutation = block.mutation;\r\n      const name = mutation.proccode;\r\n\r\n      if (P.config.debug && name === 'forkphorus:debugger;') {\r\n        source += '/* forkphorus debugger */debugger;\\n';\r\n        return;\r\n      }\r\n\r\n      const id = nextLabel();\r\n      source += 'call(S.procedures[' + sanitizedString(name) + '], ' + id + ', [\\n';\r\n\r\n      // The mutation has a stringified JSON list of input IDs... it's weird.\r\n      const inputIds = JSON.parse(mutation.argumentids);\r\n      for (const id of inputIds) {\r\n        const input = block.inputs[id];\r\n        source += '  ' + compileExpression(input) + ',\\n';\r\n      }\r\n\r\n      source += ']);\\n';\r\n\r\n      delay();\r\n    },\r\n\r\n    // Pen (extension)\r\n    pen_clear(block) {\r\n      source += 'self.clearPen();\\n';\r\n      visualCheck('always');\r\n    },\r\n    pen_stamp(block) {\r\n      source += 'S.stamp();\\n';\r\n      visualCheck('always');\r\n    },\r\n    pen_penDown(block) {\r\n      source += 'S.isPenDown = true;\\n';\r\n      source += 'S.dotPen();\\n';\r\n      visualCheck('always');\r\n    },\r\n    pen_penUp(block) {\r\n      // TODO: determine visualCheck variant\r\n      // definitely not 'always' or 'visible', might be a 'if (S.isPenDown)'\r\n      source += 'S.isPenDown = false;\\n';\r\n    },\r\n    pen_setPenColorToColor(block) {\r\n      const color = block.inputs.COLOR;\r\n      source += 'S.setPenColor(' + compileExpression(color, 'number') + ');\\n';\r\n    },\r\n    pen_setPenHueToNumber(block) {\r\n      const hue = block.inputs.HUE;\r\n      source += 'S.setPenColorHSL();\\n';\r\n      source += 'S.penHue = ' + compileExpression(hue, 'number') + ' * 360 / 200;\\n';\r\n      source += 'S.penSaturation = 100;\\n';\r\n    },\r\n    pen_changePenHueBy(block) {\r\n      const hue = block.inputs.HUE;\r\n      source += 'S.setPenColorHSL();\\n';\r\n      source += 'S.penHue += ' + compileExpression(hue, 'number') + ' * 360 / 200;\\n';\r\n      source += 'S.penSaturation = 100;\\n';\r\n    },\r\n    pen_setPenShadeToNumber(block) {\r\n      const shade = block.inputs.SHADE;\r\n      source += 'S.setPenColorHSL();\\n';\r\n      source += 'S.penLightness = ' + compileExpression(shade, 'number') + ' % 200;\\n';\r\n      source += 'if (S.penLightness < 0) S.penLightness += 200;\\n';\r\n      source += 'S.penSaturation = 100;\\n';\r\n    },\r\n    pen_changePenShadeBy(block) {\r\n      const shade = block.inputs.SHADE;\r\n      source += 'S.setPenColorHSL();\\n';\r\n      source += 'S.penLightness = (S.penLightness + ' + compileExpression(shade, 'number') + ') % 200;\\n';\r\n      source += 'if (S.penLightness < 0) S.penLightness += 200;\\n';\r\n      source += 'S.penSaturation = 100;\\n';\r\n    },\r\n    pen_setPenColorParamTo(block) {\r\n      const colorParam = block.inputs.COLOR_PARAM;\r\n      const value = block.inputs.VALUE;\r\n      source += 'S.setPenColorParam(' + compileExpression(colorParam, 'string') + ', ' + compileExpression(value, 'number') + ');\\n';\r\n    },\r\n    pen_changePenColorParamBy(block) {\r\n      const colorParam = block.inputs.COLOR_PARAM;\r\n      const value = block.inputs.VALUE;\r\n      source += 'S.changePenColorParam(' + compileExpression(colorParam, 'string') + ', ' + compileExpression(value, 'number') + ');\\n';\r\n    },\r\n    pen_changePenSizeBy(block) {\r\n      const size = block.inputs.SIZE;\r\n      source += 'S.penSize = Math.max(1, S.penSize + ' + compileExpression(size, 'number') + ');\\n';\r\n    },\r\n    pen_setPenSizeTo(block) {\r\n      const size = block.inputs.SIZE;\r\n      source += 'S.penSize = Math.max(1, ' + compileExpression(size, 'number') + ');\\n';\r\n    },\r\n\r\n    // Music (extension)\r\n    music_setTempo(block) {\r\n      const tempo = block.inputs.TEMPO;\r\n      source += 'self.tempoBPM = ' + compileExpression(tempo, 'number') + ';\\n';\r\n    },\r\n    music_changeTempo(block) {\r\n      const tempo = block.inputs.TEMPO;\r\n      source += 'self.tempoBPM += ' + compileExpression(tempo, 'number') + ';\\n';\r\n    },\r\n\r\n    // Legacy no-ops.\r\n    // https://github.com/LLK/scratch-vm/blob/bb42c0019c60f5d1947f3432038aa036a0fddca6/src/blocks/scratch3_motion.js#L19\r\n    motion_scroll_right: noopStatement,\r\n    motion_scroll_up: noopStatement,\r\n    motion_align_scene: noopStatement,\r\n    // https://github.com/LLK/scratch-vm/blob/bb42c0019c60f5d1947f3432038aa036a0fddca6/src/blocks/scratch3_looks.js#L248\r\n    looks_changestretchby: noopStatement,\r\n    looks_setstretchto: noopStatement,\r\n    looks_hideallsprites: noopStatement,\r\n  };\r\n\r\n  // Contains data used for variable watchers.\r\n  export const watcherLibrary: ObjectMap<WatchedValue> = {\r\n    // Maps watcher opcode to the methods that define its behavior.\r\n\r\n    // Motion\r\n    motion_xposition: {\r\n      evaluate(watcher) { return watcher.target.scratchX; },\r\n      getLabel() { return 'x position'; },\r\n    },\r\n    motion_yposition: {\r\n      evaluate(watcher) { return watcher.target.scratchY; },\r\n      getLabel() { return 'y position'; },\r\n    },\r\n    motion_direction: {\r\n      evaluate(watcher) { return P.core.isSprite(watcher.target) ? watcher.target.direction : 0; },\r\n      getLabel() { return 'direction'; },\r\n    },\r\n\r\n    // Looks\r\n    looks_costumenumbername: {\r\n      evaluate(watcher) {\r\n        const target = watcher.target;\r\n        const param = watcher.params.NUMBER_NAME;\r\n        if (param === 'number') {\r\n          return target.currentCostumeIndex + 1;\r\n        } else {\r\n          return target.costumes[target.currentCostumeIndex].name;\r\n        }\r\n      },\r\n      getLabel(watcher) {\r\n        return 'costume ' + watcher.params.NUMBER_NAME;\r\n      },\r\n    },\r\n    looks_backdropnumbername: {\r\n      evaluate(watcher) {\r\n        const target = watcher.stage;\r\n        const param = watcher.params.NUMBER_NAME;\r\n        if (param === 'number') {\r\n          return target.currentCostumeIndex + 1;\r\n        } else {\r\n          return target.costumes[target.currentCostumeIndex].name;\r\n        }\r\n      },\r\n      getLabel(watcher) {\r\n        return 'backdrop ' + watcher.params.NUMBER_NAME;\r\n      },\r\n    },\r\n    looks_size: {\r\n      evaluate(watcher) { return P.core.isSprite(watcher.target) ? watcher.target.scale * 100 : 100; },\r\n      getLabel() { return 'size'; },\r\n    },\r\n\r\n    // Sound\r\n    sound_volume: {\r\n      evaluate(watcher) { return watcher.target.volume * 100; },\r\n      getLabel() { return 'volume'; },\r\n    },\r\n\r\n    // Sensing\r\n    sensing_answer: {\r\n      evaluate(watcher) { return watcher.stage.answer; },\r\n      getLabel() { return 'answer'; },\r\n    },\r\n    sensing_loudness: {\r\n      // We don't implement loudness.\r\n      evaluate() { return -1; },\r\n      getLabel() { return 'loudness'; },\r\n    },\r\n    sensing_timer: {\r\n      evaluate(watcher) {\r\n        return (watcher.stage.runtime.now - watcher.stage.runtime.timerStart) / 1000;\r\n      },\r\n      getLabel() { return 'timer'; },\r\n    },\r\n    sensing_current: {\r\n      evaluate(watcher) {\r\n        const param = watcher.params.CURRENTMENU.toLowerCase();\r\n        switch (param) {\r\n          case 'year': return new Date().getFullYear();\r\n          case 'month': return new Date().getMonth() + 1;\r\n          case 'date': return new Date().getDate();\r\n          case 'dayofweek': return new Date().getDay() + 1;\r\n          case 'hour': return new Date().getHours();\r\n          case 'minute': return new Date().getMinutes();\r\n          case 'second': return new Date().getSeconds();\r\n        }\r\n        return 0;\r\n      },\r\n      getLabel(watcher) {\r\n        const param = watcher.params.CURRENTMENU.toLowerCase();\r\n        // all expected params except DAYOFWEEK can just be lowercased and used directly\r\n        if (param === 'dayofweek') {\r\n          return 'day of week';\r\n        }\r\n        return param;\r\n      }\r\n    },\r\n    sensing_username: {\r\n      evaluate(watcher) { return watcher.stage.username; },\r\n      getLabel() { return 'username'; },\r\n    },\r\n\r\n    // Data\r\n    data_variable: {\r\n      init(watcher) {\r\n        watcher.target.watchers[watcher.id] = watcher;\r\n      },\r\n      set(watcher, value) {\r\n        watcher.target.vars[watcher.id] = value;\r\n      },\r\n      evaluate(watcher) {\r\n        return watcher.target.vars[watcher.id];\r\n      },\r\n      getLabel(watcher) {\r\n        return watcher.params.VARIABLE;\r\n      },\r\n    },\r\n\r\n    // Music (extension)\r\n    music_getTempo: {\r\n      evaluate(watcher) { return watcher.stage.tempoBPM; },\r\n      getLabel() { return 'Music: tempo'; },\r\n    },\r\n  };\r\n\r\n  ///\r\n  /// Helpers\r\n  ///\r\n\r\n  /**\r\n   * Adds JS to update the speech bubble if necessary\r\n   */\r\n  function updateBubble() {\r\n    source += 'if (S.saying) S.updateBubble();\\n';\r\n  }\r\n\r\n  /**\r\n   * Adds JS to enable the VISUAL runtime flag when necessary\r\n   * @param variant 'drawing', 'visible', or 'always'\r\n   */\r\n  function visualCheck(variant: 'drawing' | 'visible' | 'always') {\r\n    if (P.config.debug) {\r\n      source += '/*visual:' + variant + '*/';\r\n    }\r\n    switch (variant) {\r\n      case 'drawing': source += 'if (S.visible || S.isPenDown) VISUAL = true;\\n'; break;\r\n      case 'visible': source += 'if (S.visible) VISUAL = true;\\n'; break;\r\n      case 'always':  source += 'VISUAL = true;\\n'; break;\r\n    }\r\n  }\r\n\r\n  // Queues something to run with the forceQueue runtime method\r\n  function forceQueue(id: number) {\r\n    source += 'forceQueue(' + id + '); return;\\n';\r\n  }\r\n\r\n  // Queues something to run with the queue runtime method\r\n  function queue(id: number) {\r\n    source += 'queue(' + id + '); return;\\n';\r\n  }\r\n\r\n  // Adds a delay\r\n  function delay() {\r\n    source += 'return;\\n';\r\n    label();\r\n  }\r\n\r\n  // Gets the next label\r\n  function nextLabel(): number {\r\n    return fns.length + currentTarget.fns.length;\r\n  }\r\n\r\n  // Creates and returns a new label for the script's current state\r\n  function label(): number {\r\n    const id = nextLabel();\r\n    fns.push(source.length);\r\n    if (P.config.debug) {\r\n      source += '/*label:' + id + '*/';\r\n    }\r\n    return id;\r\n  }\r\n\r\n  // Sanitizes a string to be used in a javascript string enclosed in double quotes.\r\n  function sanitizedString(thing: string): string {\r\n    if (typeof thing !== 'string') {\r\n      thing = '' + thing;\r\n    }\r\n    return '\"' + thing\r\n      .replace(/\\\\/g, '\\\\\\\\')\r\n      .replace(/'/g, '\\\\\\'')\r\n      .replace(/\"/g, '\\\\\"')\r\n      .replace(/\\n/g, '\\\\n')\r\n      .replace(/\\r/g, '\\\\r')\r\n      .replace(/\\{/g, '\\\\x7b')\r\n      .replace(/\\}/g, '\\\\x7d') + '\"';\r\n  }\r\n\r\n  // Sanitizes a string using sanitizedString() as a compiled string expression.\r\n  function sanitizedExpression(thing: string): CompiledExpression {\r\n    return stringExpr(sanitizedString(thing));\r\n  }\r\n\r\n  // Adds JS to wait for a duration.\r\n  // `duration` is a valid compiled JS expression.\r\n  function wait(duration: string) {\r\n    source += 'save();\\n';\r\n    source += 'R.start = runtime.now;\\n';\r\n    source += 'R.duration = ' + duration + ';\\n';\r\n    source += 'var first = true;\\n';\r\n    const id = label();\r\n    source += 'if (runtime.now - R.start < R.duration * 1000 || first) {\\n';\r\n    source += '  var first;\\n';\r\n    forceQueue(id);\r\n    source += '}\\n';\r\n    source += 'restore();\\n';\r\n  }\r\n\r\n  /**\r\n   * Determines the runtime object that owns a variable.\r\n   * If the variable does not exist, it will be created.\r\n   * @param id The Scratch 3 variable ID\r\n   */\r\n  function variableScope(id: string) {\r\n    if (id in currentTarget.stage.vars) {\r\n      return 'self';\r\n    } else if (id in currentTarget.vars) {\r\n      return 'S';\r\n    } else {\r\n      // We make sure all variables exist at compile time.\r\n      // We'll use 0 as a default value because I **think** this is what Scratch 3 does.\r\n      currentTarget.vars[id] = 0;\r\n      return 'S';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Determines the runtime object that owns a list.\r\n   * If the list does not exist, it will be created.\r\n   * @param id The Scratch 3 list ID\r\n   */\r\n  function listScope(id: string) {\r\n    if (id in currentTarget.stage.lists) {\r\n      return 'self';\r\n    } else if (id in currentTarget.lists) {\r\n      return 'S';\r\n    } else {\r\n      // We make sure all lists exist at compile time.\r\n      // Unknown lists become empty lists. This is probably what Scratch 3 does.\r\n      currentTarget.lists[id] = new Scratch3List();\r\n      return 'S';\r\n    }\r\n  }\r\n\r\n  // Returns a reference to a variable with an ID\r\n  function variableReference(id: string) {\r\n    const scope = variableScope(id);\r\n    return scope + '.vars[' + compileExpression(id) + ']';\r\n  }\r\n\r\n  // Returns a reference to a list with a ID\r\n  function listReference(id: string) {\r\n    const scope = listScope(id);\r\n    return scope + '.lists[' + compileExpression(id) + ']';\r\n  }\r\n\r\n  ///\r\n  /// Compilers\r\n  ///\r\n\r\n  // Compiles a '#ABCDEF' color\r\n  function compileColor(hexCode: string): CompiledExpression {\r\n    // Remove the leading # and use it to create a hexadecimal number\r\n    const hex = hexCode.substr(1);\r\n    // Ensure that it is actually a hex number.\r\n    if (/^[0-9a-f]{6}$/.test(hex)) {\r\n      return numberExpr('0x' + hex);\r\n    } else {\r\n      console.warn('expected hex color code but got', hex);\r\n      return numberExpr('0x0');\r\n    }\r\n  }\r\n\r\n  // Compiles a native expression (number, string, data) to a JavaScript string\r\n  function compileNative(constant): CompiledExpression | string {\r\n    // Natives are arrays, where the first value is the type ID. (see PrimitiveTypes)\r\n    const type = constant[0];\r\n\r\n    switch (type) {\r\n      // These all function as numbers. I believe they are only differentiated so the editor can be more helpful.\r\n      case PrimitiveTypes.MATH_NUM:\r\n      case PrimitiveTypes.POSITIVE_NUM:\r\n      case PrimitiveTypes.WHOLE_NUM:\r\n      case PrimitiveTypes.INTEGER_NUM:\r\n      case PrimitiveTypes.ANGLE_NUM:\r\n        // The value might not actually be a number.\r\n        if (!isNaN(parseFloat(constant[1]))) {\r\n          return numberExpr(constant[1]);\r\n        } else {\r\n          // Non-numbers will be sanitized\r\n          return sanitizedExpression(constant[1]);\r\n        }\r\n\r\n      case PrimitiveTypes.TEXT:\r\n        return sanitizedExpression(constant[1]);\r\n\r\n      case PrimitiveTypes.VAR:\r\n        // For variable natives the second item is the name of the variable\r\n        // and the third is the ID of the variable. We only care about the ID.\r\n        return variableReference(constant[2]);\r\n\r\n      case PrimitiveTypes.LIST:\r\n        // Similar to variable references\r\n        return listReference(constant[2]);\r\n\r\n      case PrimitiveTypes.BROADCAST:\r\n        // [type, name, id]\r\n        return compileExpression(constant[1]);\r\n\r\n      case PrimitiveTypes.COLOR_PICKER:\r\n        // Colors are stored as strings like \"#123ABC\", so we must do some conversions to use them as numbers.\r\n        return compileColor(constant[1]);\r\n\r\n      default:\r\n        console.warn('unknown constant', type, constant);\r\n        return stringExpr('\"\"');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Compiles a block\r\n   * The source code is in the source variable (does not return)\r\n   */\r\n  function compile(block: Block | string) {\r\n    if (typeof block === 'string') {\r\n      block = blocks[block];\r\n    }\r\n    if (!block) {\r\n      return;\r\n    }\r\n\r\n    while (true) {\r\n      const opcode = block.opcode;\r\n      const compiler = statementLibrary[opcode];\r\n      if (!compiler) {\r\n        console.warn('unknown statement', opcode, block);\r\n      } else {\r\n        if (P.config.debug) {\r\n          source += '/*' + opcode + '*/';\r\n        }\r\n        compiler(block);\r\n      }\r\n\r\n      if (!block.next) {\r\n        break;\r\n      }\r\n      block = blocks[block.next];\r\n    }\r\n  }\r\n\r\n  // Compiles a substack (script inside of another block)\r\n  function compileSubstack(substack) {\r\n    // Substacks are statements inside of statements.\r\n    // Substacks are a type of input. The first item is type ID, the second is the ID of the child.\r\n\r\n    // Substacks are not guaranteed to exist, so silently fail.\r\n    if (!substack) {\r\n      return;\r\n    }\r\n\r\n    // TODO: check type?\r\n    // const type = substack[0];\r\n\r\n    const id: string = substack[1];\r\n    compile(id);\r\n  }\r\n\r\n  function asType(script: string | CompiledExpression, type?: ExpressionType): string {\r\n    if (script instanceof CompiledExpression) {\r\n      // If a compiled expression is already of the desired type, then simply return it.\r\n      if (script.type === type) {\r\n        return script.source;\r\n      }\r\n      script = script.source;\r\n    }\r\n    switch (type) {\r\n      case 'string': return '(\"\" + ' + script + ')';\r\n      case 'number': return '+' + script;\r\n      case 'boolean': return 'bool(' + script + ')';\r\n    }\r\n    return script;\r\n  }\r\n\r\n  function fallbackValue(type?: ExpressionType): string {\r\n    switch (type) {\r\n      case 'string': return '\"\"';\r\n      case 'number': return '0';\r\n      case 'boolean': return 'false';\r\n    }\r\n    return '\"\"';\r\n  }\r\n\r\n  /**\r\n   * Compiles a Scratch 3 expression or input.\r\n   *\r\n   * @param The expression to compile\r\n   * @param The requested type of the expression\r\n   * @return The source of the compiled expression with any required type conversions\r\n   */\r\n  function compileExpression(expression, type?: ExpressionType): string {\r\n    if (!expression) {\r\n      return fallbackValue(type);\r\n    }\r\n\r\n    // TODO: use asType?\r\n    if (typeof expression === 'string') {\r\n      return sanitizedString(expression);\r\n    }\r\n    if (typeof expression === 'number') {\r\n      // I have a slight feeling this block never runs.\r\n      // TODO: remove?\r\n      return '' + expression;\r\n    }\r\n\r\n    if (Array.isArray(expression[1])) {\r\n      const native = expression[1];\r\n      return asType(compileNative(native), type);\r\n    }\r\n\r\n    const id = expression[1];\r\n    const block = blocks[id];\r\n    if (!block) {\r\n      return fallbackValue(type);\r\n    }\r\n    const opcode = block.opcode;\r\n\r\n    const compiler = expressionLibrary[opcode];\r\n    if (!compiler) {\r\n      console.warn('unknown expression', opcode, block);\r\n      return fallbackValue(type);\r\n    }\r\n    let result = compiler(block);\r\n\r\n    if (result instanceof CompiledExpression) {\r\n      if (P.config.debug) {\r\n        result.source = '/*' + opcode + '*/' + result.source;\r\n      }\r\n      return asType(result, type);\r\n    }\r\n\r\n    if (P.config.debug) {\r\n      result = '/*' + opcode + '*/' + result;\r\n    }\r\n\r\n    return asType(result, type);\r\n  }\r\n\r\n  /**\r\n   * Compiles a top block listener from the top down.\r\n   * The resulting source code is in the `source` variable of P.sb3.compiler\r\n   * @returns {boolean} Successful compiling\r\n   */\r\n  function compileListener(topBlock: Block): boolean {\r\n    // Ignore blocks where we don't recognize the opcode\r\n    const topLevelOpCode = topBlock.opcode;\r\n    if (!(topLevelOpCode in topLevelLibrary)) {\r\n      // Only log warnings if we wouldn't otherwise recognize the block.\r\n      // Some dangling non-top-level blocks is very common.\r\n      if (!(topLevelOpCode in expressionLibrary) && !(topLevelOpCode in statementLibrary)) {\r\n        console.warn('unknown top level block', topLevelOpCode, topBlock);\r\n      }\r\n      return false;\r\n    }\r\n\r\n    // We can completely ignore empty listeners (those without any children)\r\n    if (!topBlock.next) {\r\n      return false;\r\n    }\r\n\r\n    source = '';\r\n    const block = blocks[topBlock.next];\r\n\r\n    compile(block);\r\n\r\n    // Procedure definitions need special care to properly end calls.\r\n    // In the future this should be refactored so that things like this are part of the top level library\r\n    if (topLevelOpCode === 'procedures_definition') {\r\n      source += 'endCall(); return;\\n';\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Compiles a Scratch 3 Target (Sprite/Stage)\r\n   *\r\n   * @param target The constructed instance of P.sb3.Target\r\n   * @param data The raw sb3 data of the target\r\n   */\r\n  export function compileTarget(target: P.sb3.Target, data: P.sb3.SB3Target) {\r\n    currentTarget = target;\r\n    blocks = data.blocks;\r\n\r\n    // We compile blocks from the top level down to their children, so extract top level blocks\r\n    const topLevelBlocks = Object.keys(data.blocks)\r\n      .map((id) => data.blocks[id])\r\n      .filter((block) => block.topLevel);\r\n\r\n    for (const block of topLevelBlocks) {\r\n      // The first function points to the very start at index 0\r\n      fns = [0];\r\n\r\n      const compilingSuccess = compileListener(block);\r\n      if (!compilingSuccess) {\r\n        continue;\r\n      }\r\n\r\n      const startFn = target.fns.length;\r\n      for (var i = 0; i < fns.length; i++) {\r\n        target.fns.push(P.runtime.createContinuation(source.slice(fns[i])));\r\n      }\r\n\r\n      const topLevelHandler = topLevelLibrary[block.opcode];\r\n      topLevelHandler(block, target.fns[startFn]);\r\n\r\n      if (P.config.debug) {\r\n        console.log('compiled sb3 script', block.opcode, source, target);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * External hooks\r\n   */\r\n  export const hooks = {\r\n    getSource() {\r\n      return source;\r\n    },\r\n    setSource(src: string) {\r\n      source = src;\r\n    },\r\n    appendSource(src: string) {\r\n      source += src;\r\n    },\r\n    expression(expression) {\r\n      return compileExpression(expression);\r\n    },\r\n  };\r\n}\r\n"]}